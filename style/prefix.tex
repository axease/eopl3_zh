\documentclass{book}
\usepackage[defaultlines=4,all]{nowidow}
\usepackage[asymmetric, reversemarginpar]{geometry}
\usepackage{xeCJK}
\setCJKmainfont[BoldFont={WenQuanYi Micro Hei}, ItalicFont={AR PL UKai CN}]{Adobe Song Std}
\setCJKsansfont{Adobe Song Std}
\setCJKmonofont{Adobe Song Std}
\xeCJKsetup{CJKmath=true, PlainEquation=true}
\usepackage[T1]{fontenc}
\usepackage{emptypage}

% use package proof
\usepackage{proof}

% no indent at first paragraph
\usepackage{indentfirst}
\setlength{\parindent}{2em}

% customize header format
\usepackage{fancyhdr}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\renewcommand{\chaptername}{}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,RO]{\thepage}
\fancyhead[RE]{\leftmark}
\fancyhead[LO]{\rightmark}

% use exercise package for exercise
\usepackage{exercise}
\renewcommand\DifficultyMarker{$\star$}
\renewcommand{\ExerciseHeaderDifficulty}{\theExerciseDifficulty}
\renewcommand{\ExerciseName}{练习}
\renewcommand{\ExerciseHeader}{\noindent\textit{\ExerciseName}\thechapter.\ExerciseHeaderNB~[\ExerciseHeaderDifficulty\ignorespaces]}
\newcounter{ChapterCounter}
\renewcounter{ChapterCounter}[chapter]

% customize title format
\usepackage{titlesec}
\titleformat
{\chapter} % command
[hang]
{\bfseries\Large} % format
{\Larger{\Larger{\Larger\thechapter}}} % label
{0.5em} % sep
{
} % before-code
[
] % after-code

\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  urlcolor=blue,
  linkcolor=black,
  citecolor=red
}

\usepackage{xpatch}
\makeatletter
\AtBeginDocument{\xpatchcmd{\@thm}{\thm@headpunct{.}}{\thm@headpunct{}}{}{}}
\makeatother

\usepackage{caption}
\captionsetup[figure]{labelfont=bf, labelsep=quad, name=图}

\usepackage[perpage]{footmisc}

