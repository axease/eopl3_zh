<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>5&nbsp;传递续文的解释器</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="tip.css" title="default"/><link rel="stylesheet" type="text/css" href="footnote.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript">
(function() {
  document.write('<link rel="stylesheet" href="katex/katex.min.css" />');
})();(function() {document.write('<scr' + 'ipt type="text/javascript" src="katex/katex.min.js"></scr' + 'ipt>');})();(function(f) {
  // A "simple" onLoad function
  if (window.document.readyState == "complete") {
    f();
  } else if (window.document.addEventListener) {
    window.document.addEventListener("DOMContentLoaded", f, false);
  } else if (window.attachEvent) {
    window.attachEvent("onreadystatechange", function() {
      if (window.document.readyState == "complete") {
        f();
      }
    });
  } else {
    var oldLoad = window.onload;
    if (typeof(oldLoad) == "function") {
      window.onload = function() {
        try {
          oldLoad();
        } finally {
          f();
        }
      };
    } else {
      window.onload = f;
    }
  }
})(function() {
  // This is an ugly way to change the doctype, in case the scribble document
  // did not use (with-html5).
  if (!(document.doctype && document.doctype.publicId == '')) {
    if (console && console.log) {
      console.log("Re-wrote the document to use the HTML5 doctype.\n"
                  + "  Consider using the following declaration:\n"
                  + "      @title[#:style (with-html5 manual-doc-style)]{…}");
    }
    var wholeDoc = '<!doctype HTML>\n' + document.documentElement.outerHTML;
    document.open();
    document.clear();
    document.write(wholeDoc);
  }
  var inlineElements = document.getElementsByClassName("texMathInline");
  for (var i = 0; i < inlineElements.length; i++) {
    var e = inlineElements[i];
    katex.render(e.textContent, e, { displayMode:false, throwOnError:false });
  }
  var displayElements = document.getElementsByClassName("texMathDisplay");
  for (var i = 0; i < displayElements.length; i++) {
    var e = displayElements[i];
    katex.render(e.textContent, e, { displayMode:true, throwOnError:false });
  }
});
</script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">&#32534;&#31243;&#35821;&#35328;&#35201;&#32032;</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="fw-trans.html" class="tocviewlink" data-pltdoc="x">&#35793;&#32773;&#30340;&#35805;</a></td></tr><tr><td align="right"></td><td><a href="glo.html" class="tocviewlink" data-pltdoc="x">&#35793;&#21517;&#34920;</a></td></tr><tr><td align="right"></td><td><a href="fw.html" class="tocviewlink" data-pltdoc="x">&#24207;</a></td></tr><tr><td align="right"></td><td><a href="pf.html" class="tocviewlink" data-pltdoc="x">&#21069;&#35328;</a></td></tr><tr><td align="right"></td><td><a href="awk.html" class="tocviewlink" data-pltdoc="x">&#33268;&#35874;</a></td></tr><tr><td align="right">1&nbsp;</td><td><a href="isd.html" class="tocviewlink" data-pltdoc="x">&#24402;&#32435;&#24335;&#25968;&#25454;&#38598;</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="da.html" class="tocviewlink" data-pltdoc="x">&#25968;&#25454;&#25277;&#35937;</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="expr.html" class="tocviewlink" data-pltdoc="x">&#34920;&#36798;&#24335;</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="state.html" class="tocviewlink" data-pltdoc="x">&#29366;&#24577;</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="cps.html" class="tocviewlink" data-pltdoc="x">&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="types.html" class="tocviewlink" data-pltdoc="x">&#31867;&#22411;</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="modules.html" class="tocviewlink" data-pltdoc="x">&#27169;&#22359;</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="oac.html" class="tocviewlink" data-pltdoc="x">&#23545;&#35937;&#21644;&#31867;</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="further-reading.html" class="tocviewlink" data-pltdoc="x">&#25193;&#23637;&#38405;&#35835;</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="sllgen-parsing-system.html" class="tocviewlink" data-pltdoc="x">SLLGEN&#35299;&#26512;&#31995;&#32479;</a></td></tr><tr><td align="right"></td><td><a href="bib.html" class="tocviewlink" data-pltdoc="x">&#21442;&#32771;&#20070;&#30446;</a></td></tr><tr><td align="right"></td><td><a href="indices.html" class="tocviewlink" data-pltdoc="x">&#32034;&#24341;</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>5&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">5.1&nbsp;</td><td><a href="#%28part._s5..1%29" class="tocviewlink" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a></td></tr><tr><td align="right">5.2&nbsp;</td><td><a href="#%28part._s5..2%29" class="tocviewlink" data-pltdoc="x">&#36339;&#36291;&#24335;&#35299;&#37322;&#22120;</a></td></tr><tr><td align="right">5.3&nbsp;</td><td><a href="#%28part._s5..3%29" class="tocviewlink" data-pltdoc="x">&#25351;&#20196;&#24335;&#35299;&#37322;&#22120;</a></td></tr><tr><td align="right">5.4&nbsp;</td><td><a href="#%28part._s5..4%29" class="tocviewlink" data-pltdoc="x">&#24322;&#24120;</a></td></tr><tr><td align="right">5.5&nbsp;</td><td><a href="#%28part._s5..5%29" class="tocviewlink" data-pltdoc="x">&#32447;&#31243;</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._s5..1%29" class="tocsubseclink" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._s5..2%29" class="tocsubseclink" data-pltdoc="x">&#36339;&#36291;&#24335;&#35299;&#37322;&#22120;</a></td></tr><tr><td><span class="tocsublinknumber">5.3<tt>&nbsp;</tt></span><a href="#%28part._s5..3%29" class="tocsubseclink" data-pltdoc="x">&#25351;&#20196;&#24335;&#35299;&#37322;&#22120;</a></td></tr><tr><td><span class="tocsublinknumber">5.4<tt>&nbsp;</tt></span><a href="#%28part._s5..4%29" class="tocsubseclink" data-pltdoc="x">&#24322;&#24120;</a></td></tr><tr><td><span class="tocsublinknumber">5.5<tt>&nbsp;</tt></span><a href="#%28part._s5..5%29" class="tocsubseclink" data-pltdoc="x">&#32447;&#31243;</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="state.html" title="backward to &quot;4 状态&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;编程语言要素&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="cps.html" title="forward to &quot;6 续文传递风格&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>5<tt>&nbsp;</tt><a name="(part._cpi)"></a>&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</h3><p><a name="(idx._(gentag._726))"></a>
<a name="(idx._(gentag._727))"></a>
&#22312;<a href="expr.html" data-pltdoc="x">&#34920;&#36798;&#24335;</a>&#65292;&#25105;&#20204;&#29992;&#29615;&#22659;&#30340;&#27010;&#24565;&#25506;&#35752;&#32465;&#23450;&#34892;&#20026;&#65292;&#24314;&#31435;&#27599;&#37096;&#20998;&#31243;&#24207;&#25191;&#34892;&#30340;&#25968;&#25454;&#19978;&#19979;&#25991;&#12290;
&#36825;&#37324;&#65292;&#25105;&#20204;&#23558;&#29992;&#31867;&#20284;&#26041;&#24335;&#25506;&#35752;&#27599;&#37096;&#20998;&#31243;&#24207;&#25191;&#34892;&#30340;<span class="emph">&#25511;&#21046;&#19978;&#19979;&#25991;</span> (<span class="emph">control context</span>)&#12290;
&#25105;&#20204;&#23558;&#20171;&#32461;<span class="emph">&#32493;&#25991;</span> (<span class="emph">continuation</span>) &#30340;&#27010;&#24565;&#65292;&#29992;&#26469;&#25277;&#35937;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;&#25105;&#20204;&#23558;&#35201;&#32534;&#20889;&#30340;
&#35299;&#37322;&#22120;&#20250;&#21462;&#19968;&#32493;&#25991;&#21442;&#25968;&#65292;&#20174;&#32780;&#24432;&#26174;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;</p><p>&#32771;&#34385;&#19979;&#38754;&#30340;Scheme&#38454;&#20056;&#20989;&#25968;&#23450;&#20041;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#25105;&#20204;&#21487;&#20197;&#29992;&#25512;&#23548;&#24314;&#27169; <span class="stt">fact</span> &#30340;&#35745;&#31639;&#36807;&#31243;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(fact 4)</span></p></td></tr><tr><td><p><span class="stt">= (* 4 (fact 3))</span></p></td></tr><tr><td><p><span class="stt">= (* 4 (* 3 (fact 2)))</span></p></td></tr><tr><td><p><span class="stt">= (* 4 (* 3 (* 2 (fact 1))))</span></p></td></tr><tr><td><p><span class="stt">= (* 4 (* 3 (* 2 (* 1 (fact 0)))))</span></p></td></tr><tr><td><p><span class="stt">= (* 4 (* 3 (* 2 (* 1 1))))</span></p></td></tr><tr><td><p><span class="stt">= (* 4 (* 3 (* 2 1)))</span></p></td></tr><tr><td><p><span class="stt">= (* 4 (* 3 2))</span></p></td></tr><tr><td><p><span class="stt">= (* 4 6)</span></p></td></tr><tr><td><p><span class="stt">= 24</span></p></td></tr></table></blockquote><p>&#36825;&#26159;&#38454;&#20056;&#30340;&#33258;&#28982;&#36882;&#24402;&#23450;&#20041;&#12290;&#27599;&#27425;&#35843;&#29992; <span class="stt">fact</span> &#37117;&#20445;&#35777;&#36820;&#22238;&#20540;&#19982;&#35843;&#29992;&#22788;&#30340; <span class="stt">n</span> &#30456;&#20056;&#12290;
&#36825;&#26679;&#65292;&#38543;&#30528;&#35745;&#31639;&#36827;&#34892;&#65292;<span class="stt">fact</span> &#22312;&#36234;&#26469;&#36234;&#22823;&#30340;<span class="emph">&#25511;&#21046;&#19978;&#19979;&#25991;</span> &#20013;&#35843;&#29992;&#12290;&#27604;&#36739;&#36825;&#19968;&#34892;&#20026;
&#19982;&#19979;&#21015;&#36807;&#31243;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact-iter</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact-iter-acc</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact-iter-acc</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact-iter-acc</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#29992;&#36825;&#20010;&#23450;&#20041;&#65292;&#25105;&#20204;&#35745;&#31639;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(</span><a name="(elem._fact-iter)"></a><span class="stt">fact-iter 4)</span></p></td></tr><tr><td><p><span class="stt">= (fact-iter-acc 4 1)</span></p></td></tr><tr><td><p><span class="stt">= (fact-iter-acc 3 4)</span></p></td></tr><tr><td><p><span class="stt">= (fact-iter-acc 2 12)</span></p></td></tr><tr><td><p><span class="stt">= (fact-iter-acc 1 24)</span></p></td></tr><tr><td><p><span class="stt">= (fact-iter-acc 0 24)</span></p></td></tr><tr><td><p><span class="stt">= 24</span></p></td></tr></table></blockquote></blockquote><p>&#36825;&#37324;&#65292;<span class="stt">fact-iter-acc</span> &#24635;&#26159;&#22312;&#21516;&#26679;&#30340;&#25511;&#21046;&#19978;&#19979;&#25991;&#20869;&#35843;&#29992;&#65306;&#22312;&#26412;&#20363;&#20013;&#65292;&#26159;&#27809;&#26377;&#20219;&#20309;&#19978;&#19979;
&#25991;&#12290;&#24403; <span class="stt">fact-iter-acc</span> &#35843;&#29992;&#33258;&#36523;&#26102;&#65292;&#23427;&#22312; <span class="stt">fact-iter-acc</span> &#25191;&#34892;&#30340;
&#8220;&#23614;&#31471;&#8221;&#65292;&#38500;&#20102;&#25226;&#36820;&#22238;&#20540;&#20316;&#20026; <span class="stt">fact-iter-acc</span> &#35843;&#29992;&#30340;&#32467;
&#26524;&#65292;&#19981;&#38656;&#20877;&#20570;&#20219;&#20309;&#20445;&#35777;&#12290;&#25105;&#20204;&#31216;&#20043;&#20026;<span class="emph">&#23614;&#35843;&#29992;</span> (<span class="emph">tail call</span>)&#12290;&#36825;&#26679;&#65292;&#19978;&#36848;&#25512;&#23548;&#20013;&#30340;&#27599;
&#19968;&#27493;&#37117;&#24418;&#22914; <span class="stt">(fact-iter-acc </span><span class="texMathInline">n</span><span class="stt"> </span><span class="texMathInline">a</span><span class="stt">)</span>&#12290;<a name="(idx._(gentag._728))"></a></p><p>&#24403; <span class="stt">fact</span> &#36825;&#26679;&#30340;&#36807;&#31243;&#25191;&#34892;&#26102;&#65292;&#27599;&#27425;&#36882;&#24402;&#35843;&#29992;&#37117;&#35201;&#35760;&#24405;&#39069;&#22806;&#30340;&#25511;&#21046;&#20449;&#24687;&#65292;&#27492;&#20449;&#24687;&#20445;&#30041;&#21040;
&#35843;&#29992;&#36820;&#22238;&#20026;&#27490;&#12290;&#22312;&#19978;&#38754;&#30340;&#31532;&#19968;&#20010;&#25512;&#23548;&#20013;&#65292;&#36825;&#21453;&#26144;&#20102;&#25511;&#21046;&#19978;&#19979;&#25991;&#30340;&#22686;&#38271;&#12290;&#36825;&#26679;&#30340;&#36807;&#31243;&#21576;&#29616;
&#20986;<span class="emph">&#36882;&#24402;&#24615;&#25511;&#21046;&#34892;&#20026;</span> (<span class="emph">recursive control behavior</span>)&#12290;
<a name="(idx._(gentag._729))"></a></p><p>&#19982;&#20043;&#30456;&#23545;&#65292;<span class="stt">fact-iter-acc</span> &#35843;&#29992;&#33258;&#36523;&#26102;&#65292;&#19981;&#38656;&#35760;&#24405;&#39069;&#22806;&#30340;&#25511;&#21046;&#20449;&#24687;&#12290;&#36882;&#24402;&#35843;&#29992;&#21457;&#29983;&#22312;
&#34920;&#36798;&#24335;&#30340;&#21516;&#19968;&#23618;&#65288;&#19978;&#36848;&#25512;&#23548;&#30340;&#26368;&#22806;&#23618;&#65289;&#21453;&#26144;&#20102;&#36825;&#19968;&#28857;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#24403;&#36882;&#24402;&#28145;&#24230;&#65288;&#27809;&#26377;&#23545;
&#24212;&#36820;&#22238;&#30340;&#36882;&#24402;&#35843;&#29992;&#25968;&#30446;&#65289;&#22686;&#21152;&#26102;&#65292;&#31995;&#32479;&#19981;&#38656;&#35201;&#19981;&#26029;&#22686;&#38271;&#30340;&#20869;&#23384;&#23384;&#25918;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;&#21482;&#38656;&#20351;&#29992;&#26377;
&#38480;&#20869;&#23384;&#23384;&#25918;&#25511;&#21046;&#20449;&#24687;&#30340;&#36807;&#31243;&#21576;&#29616;&#20986;<span class="emph">&#36845;&#20195;&#24615;&#25511;&#21046;&#34892;&#20026;</span> (<span class="emph">iterative control behavior</span>)&#12290;
<a name="(idx._(gentag._730))"></a>
<a name="(idx._(gentag._731))"></a></p><p><a name="(idx._(gentag._732))"></a>
&#20026;&#20160;&#20040;&#36825;&#20123;&#31243;&#24207;&#21576;&#29616;&#20986;&#19981;&#21516;&#30340;&#25511;&#21046;&#34892;&#20026;&#21602;&#65311;&#22312;&#38454;&#20056;&#30340;&#36882;&#24402;&#23450;&#20041;&#20013;&#65292;&#36807;&#31243; <span class="stt">fact</span>
&#22312;<span class="emph">&#25805;&#20316;&#25968;&#20301;&#32622;</span> (<span class="emph">operand position</span>) &#35843;&#29992;&#12290;&#25105;&#20204;&#38656;&#35201;&#20445;&#23384;&#36825;&#20010;&#35843;&#29992;&#30340;&#19978;&#19979;&#25991;&#65292;
&#22240;&#20026;&#25105;&#20204;&#38656;&#35201;&#35760;&#20303;&#65292;&#36807;&#31243;&#35843;&#29992;&#25191;&#34892;&#23436;&#27605;&#20043;&#21518;&#65292;&#20173;&#38656;&#27714;&#20986;&#25805;&#20316;&#25968;&#30340;&#20540;&#65292;&#24182;&#25191;&#34892;&#22806;&#23618;&#35843;&#29992;&#65292;&#22312;&#26412;
&#20363;&#20013;&#65292;&#26159;&#23436;&#25104;&#24453;&#20570;&#30340;&#20056;&#27861;&#12290;&#36825;&#32473;&#20986;&#19968;&#26465;&#37325;&#35201;&#21407;&#21017;&#65306;</p><blockquote class="Tip"><blockquote class="SCentered"><p><span style="font-weight: bold">&#19981;&#26159;&#36807;&#31243;&#35843;&#29992;&#65292;&#32780;&#26159;&#25805;&#20316;&#25968;&#30340;&#27714;&#20540;&#23548;&#33268;&#25511;&#21046;&#19978;&#19979;&#25991;&#25193;&#22823;&#12290;</span>
<a name="(idx._(gentag._733))"></a></p></blockquote></blockquote><p>&#26412;&#31456;&#65292;&#25105;&#20204;&#23398;&#20064;&#22914;&#20309;&#36319;&#36394;&#21644;&#25805;&#20316;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;&#25105;&#20204;&#30340;&#26680;&#24515;&#24037;&#20855;&#26159;
&#21517;&#20026;<span class="emph">&#32493;&#25991;</span> (<span class="emph">continuation</span>) &#30340;&#25968;&#25454;&#31867;&#22411;&#12290;&#23601;&#20687;&#29615;&#22659;&#26159;&#25968;&#25454;&#19978;&#19979;&#25991;&#30340;&#25277;&#35937;&#34920;&#31034;&#65292;&#32493;&#25991;
&#26159;&#25511;&#21046;&#19978;&#19979;&#25991;&#30340;&#25277;&#35937;&#34920;&#31034;&#12290;&#25105;&#20204;&#23558;&#25506;&#32034;&#32493;&#25991;&#65292;&#32534;&#20889;&#30452;&#25509;&#20256;&#36882;&#32493;&#25991;&#21442;&#25968;&#30340;&#35299;&#37322;&#22120;&#65292;&#23601;&#20687;&#20043;&#21069;&#30452;
&#25509;&#20256;&#36882;&#29615;&#22659;&#21442;&#25968;&#30340;&#35299;&#37322;&#22120;&#12290;&#19968;&#26086;&#22788;&#29702;&#20102;&#31616;&#21333;&#24773;&#20917;&#65292;&#25105;&#20204;&#23601;&#33021;&#26126;&#30333;&#22914;&#20309;&#32473;&#35821;&#35328;&#28155;&#21152;&#32452;&#20214;&#65292;&#20197;&#26356;
&#21152;&#22797;&#26434;&#30340;&#26041;&#24335;&#22788;&#29702;&#25511;&#21046;&#19978;&#19979;&#25991;&#65292;&#35692;&#22914;&#24322;&#24120;&#21644;&#32447;&#31243;&#12290;</p><p>&#22312;<a href="cps.html" data-pltdoc="x">&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</a>&#65292;&#25105;&#20204;&#23637;&#31034;&#22914;&#20309;&#29992;&#36716;&#25442;&#35299;&#37322;&#22120;&#30340;&#25216;&#26415;&#36716;&#25442;&#25152;&#26377;&#31243;&#24207;&#12290;&#25105;&#20204;&#35828;&#20197;&#36825;&#31181;&#26041;&#24335;&#36716;&#25442;
&#32780;&#24471;&#30340;&#31243;&#24207;&#20855;&#26377;<span class="emph">&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</span> (<span class="emph">continuation-passing style</span>)&#12290;<a href="cps.html" data-pltdoc="x">&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</a>&#36824;
&#23637;&#31034;&#20102;&#32493;&#25991;&#30340;&#20854;&#20182;&#19968;&#20123;&#37325;&#35201;&#24212;&#29992;&#12290;
<a name="(idx._(gentag._734))"></a>
<a name="(idx._(gentag._735))"></a></p><h4>5.1<tt>&nbsp;</tt><a name="(part._s5..1)"></a>&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</h4><p><a name="(idx._(gentag._736))"></a>
<a name="(idx._(gentag._737))"></a>
<a name="(idx._(gentag._738))"></a>
<a name="(idx._(gentag._739))"></a>
&#22312;&#25105;&#20204;&#30340;&#26032;&#35299;&#37322;&#22120;&#20013;&#65292;<span class="stt">value-of</span> &#31561;&#20027;&#35201;&#36807;&#31243;&#23558;&#21462;&#31532;&#19977;&#20010;&#21442;&#25968;&#12290;&#36825;&#19968;&#21442;&#25968;&#8212;&#8212;<span class="emph">&#32493;
&#25991;</span>&#8212;&#8212;&#29992;&#26469;&#25277;&#35937;&#27599;&#20010;&#34920;&#36798;&#24335;&#27714;&#20540;&#26102;&#30340;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;</p><p>&#25105;&#20204;&#20174;<span class="EoplFigureRef"></span>&#65292;&#21363;<a href="expr.html#%28part._s3..4%29" data-pltdoc="x">LETREC&#65306;&#25903;&#25345;&#36882;&#24402;&#36807;&#31243;&#30340;&#35821;&#35328;</a>&#20013;&#30340; LETREC &#35821;&#35328;&#35299;&#37322;&#22120;&#20837;&#25163;&#12290;&#25105;&#20204;&#25226;
<span class="stt">value-of-program</span> &#30340;&#32467;&#26524;&#21483;&#20570; <span class="texMathInline">\mathit{FinalAnswer}</span>&#65292;&#20197;&#24378;&#35843;&#36825;&#20010;&#34920;&#36798;&#20540;&#26159;&#31243;
&#24207;&#30340;&#26368;&#32456;&#20540;&#12290;</p><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="texMathInline">\mathit{FinalAnswer}</span> = <span class="texMathInline">\mathit{ExpVal}</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">value-of-program</span></span> : <span class="texMathInline">\mathit{Program} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pgm</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">program</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">value-of</span></span> : <span class="texMathInline">\mathit{Exp} \times \mathit{Env} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">num1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">num1</span><span class="hspace">&nbsp;</span><span class="RktSym">num2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">num1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">num1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bool-val</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bool-val</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;bool</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">call-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">rand</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-procedure</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">arg</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letrec-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p-name</span><span class="hspace">&nbsp;</span><span class="RktSym">b-var</span><span class="hspace">&nbsp;</span><span class="RktSym">p-body</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env-rec</span><span class="hspace">&nbsp;</span><span class="RktSym">p-name</span><span class="hspace">&nbsp;</span><span class="RktSym">b-var</span><span class="hspace">&nbsp;</span><span class="RktSym">p-body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">apply-procedure</span></span> : <span class="texMathInline">\mathit{Proc} \times \mathit{ExpVal} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="caption"><p>&#20256;&#36882;&#29615;&#22659;&#30340;&#35299;&#37322;&#22120;<a name="(elem._fig-5..1)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._740))"></a></div></p></blockquote><p>&#25105;&#20204;&#30340;&#30446;&#26631;&#26159;&#37325;&#20889;&#35299;&#37322;&#22120;&#65292;&#36991;&#20813;&#22312;&#35843;&#29992; <span class="stt">value-of</span> &#26102;&#20135;&#29983;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;&#24403;&#25511;&#21046;&#19978;&#19979;&#25991;
&#38656;&#35201;&#22686;&#21152;&#26102;&#65292;&#25105;&#20204;&#25193;&#23637;&#32493;&#25991;&#21442;&#25968;&#65292;&#23601;&#20687;&#22312;<a href="expr.html" data-pltdoc="x">&#34920;&#36798;&#24335;</a>&#20013;&#65292;&#31243;&#24207;&#20135;&#29983;&#25968;&#25454;&#19978;&#19979;&#25991;&#26102;&#65292;&#25193;&#23637;
&#35299;&#37322;&#22120;&#30340;&#29615;&#22659;&#19968;&#26679;&#12290;&#24432;&#26174;&#25511;&#21046;&#19978;&#19979;&#25991;&#65292;&#25105;&#20204;&#23601;&#33021;&#30475;&#21040;&#23427;&#22914;&#20309;&#28040;&#38271;&#12290;&#20043;&#21518;&#65292;
&#20174;<a href="#%28part._s5..4%29" data-pltdoc="x">&#24322;&#24120;</a>&#21040;<a href="#%28part._s5..5%29" data-pltdoc="x">&#32447;&#31243;</a>&#65292;&#25105;&#20204;&#23558;&#29992;&#23427;&#32473;&#25105;&#20204;&#30340;&#35821;&#35328;&#28155;&#21152;&#26032;&#30340;&#25511;&#21046;&#34892;&#20026;&#12290;</p><p>&#29616;&#22312;&#65292;&#25105;&#20204;&#30693;&#36947;&#29615;&#22659;&#34920;&#31034;&#19968;&#20010;&#20174;&#31526;&#21495;&#21040;&#25351;&#20195;&#20540;&#30340;&#20989;&#25968;&#12290;&#32493;&#25991;&#34920;&#31034;&#20160;&#20040;&#21602;&#65311;&#34920;&#36798;&#24335;&#30340;&#32493;&#25991;&#34920;&#31034;
&#19968;&#20010;&#36807;&#31243;&#65292;&#23427;&#21462;&#34920;&#36798;&#24335;&#30340;&#32467;&#26524;&#65292;&#23436;&#25104;&#35745;&#31639;&#12290;&#25152;&#20197;&#25105;&#20204;&#30340;&#25509;&#21475;&#24517;&#39035;&#21253;&#21547;&#19968;&#20010;&#36807;&#31243;
<span class="stt">apply-cont</span>&#65292;&#23427;&#21462;&#19968;&#32493;&#25991; <span class="stt">cont</span>&#65292;&#19968;&#20010;&#34920;&#36798;&#20540; <span class="stt">val</span>&#65292;&#23436;&#25104;&#30001; <span class="stt">cont</span> &#25351;
&#23450;&#30340;&#35745;&#31639;&#12290;<span class="stt">apply-cont</span> &#30340;&#21512;&#32422;&#20026;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="texMathInline">\mathit{FinalAnswer}</span> = <span class="texMathInline">\mathit{ExpVal}</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">apply-cont</span></span> : <span class="texMathInline">\mathit{Cont} \times \mathit{ExpVal} \to \mathit{FinalAnswer}</span></td></tr></table></blockquote></blockquote><p>&#25105;&#20204;&#25226; <span class="stt">apply-cont</span> &#30340;&#32467;&#26524;&#21483;&#20570; <span class="texMathInline">\mathit{FinalAnswer}</span> &#26159;&#20026;&#20102;&#25552;&#37266;&#33258;&#24049;&#65292;&#23427;&#26159;
&#35745;&#31639;&#26368;&#32456;&#30340;&#20540;&#65306;&#31243;&#24207;&#30340;&#20854;&#20182;&#37096;&#20998;&#37117;&#19981;&#29992;&#23427;&#12290;</p></blockquote><p>&#25509;&#21475;&#24212;&#35813;&#21253;&#21547;&#20160;&#20040;&#26679;&#30340;&#32493;&#25991;&#26500;&#36896;&#22120;&#65311;&#38543;&#30528;&#25105;&#20204;&#20998;&#26512;&#35299;&#37322;&#22120;&#65292;&#36825;&#20123;&#32493;&#25991;&#26500;&#36896;&#22120;&#33258;&#20250;&#26174;&#29616;&#12290;&#39318;&#20808;&#65292;
&#25105;&#20204;&#38656;&#35201;&#19968;&#20010;&#32493;&#25991;&#26500;&#36896;&#22120;&#65292;&#22312;&#19981;&#38656;&#20877;&#23545;&#35745;&#31639;&#20540;&#36827;&#34892;&#25805;&#20316;&#26102;&#29983;&#25104;&#19978;&#19979;&#25991;&#12290;&#25105;&#20204;&#25226;&#36825;&#20010;&#32493;&#25991;&#21483;&#20570;
<span class="stt">(end-cont)</span>&#65292;&#20854;&#23450;&#20041;&#20026;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (end-cont) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(eopl:printf "&#35745;&#31639;&#32467;&#26463;.~%")</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#35843;&#29992; <span class="stt">(end-cont)</span> &#25171;&#21360;&#20986;&#19968;&#26465;&#35745;&#31639;&#32467;&#26463;&#28040;&#24687;&#65292;&#24182;&#36820;&#22238;&#31243;&#24207;&#30340;&#20540;&#12290;&#22240;&#20026;
<span class="stt">(end-cont)</span> &#25171;&#21360;&#20986;&#19968;&#26465;&#28040;&#24687;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#20986;&#23427;&#35843;&#29992;&#20102;&#22810;&#23569;&#27425;&#12290;&#22312;&#27491;&#30830;&#30340;&#35745;&#31639;&#20013;&#65292;&#23427;&#21482;
&#24212;&#35843;&#29992;&#19968;&#27425;&#12290;</p></blockquote><p>&#25105;&#20204;&#25226; <span class="stt">value-of-program</span> &#37325;&#20889;&#20026;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of-program</span></span> : <span class="texMathInline">\mathit{Program} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pgm</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">program</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#29616;&#22312;&#25105;&#20204;&#21487;&#20197;&#20889;&#20986; <span class="stt">value-of/k</span>&#12290;&#25105;&#20204;&#20381;&#27425;&#32771;&#34385; <span class="stt">value-of</span> &#30340;&#21508;&#20010;&#20998;&#25903;&#12290;
<span class="stt">value-of</span> &#30340;&#21069;&#20960;&#34892;&#21482;&#26159;&#31639;&#20986;&#19968;&#20010;&#20540;&#65292;&#28982;&#21518;&#36820;&#22238;&#65292;&#19981;&#20250;&#20877;&#27425;&#35843;&#29992; <span class="stt">value-of</span>&#12290;&#22312;&#20256;
&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#20013;&#65292;&#36825;&#20123;&#34892;&#35843;&#29992; <span class="stt">apply-cont</span>&#65292;&#25226;&#23545;&#24212;&#30340;&#20540;&#20256;&#32473;&#32493;&#25991;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of/k</span></span> : <span class="texMathInline">\mathit{Exp} \times \mathit{Env} \times \mathit{Cont} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#30446;&#21069;&#65292;<span class="stt">cont</span> &#21807;&#19968;&#21487;&#33021;&#30340;&#20540;&#26159;&#32456;&#27490;&#32493;&#25991;&#65292;&#20294;&#36825;&#39532;&#19978;&#23601;&#20250;&#25913;&#21464;&#12290;&#24456;&#23481;&#26131;&#30475;&#20986;&#65292;&#22914;&#26524;&#31243;&#24207;&#20026;
&#19978;&#36848;&#34920;&#36798;&#24335;&#20043;&#19968;&#65292;&#34920;&#36798;&#24335;&#30340;&#20540;&#23558;&#20256;&#32473; <span class="stt">end-cont</span>&#65288;&#36890;&#36807; <span class="stt">apply-cont</span>&#65289;&#12290;</p><p><span class="stt">letrec</span> &#30340;&#34892;&#20026;&#20063;&#19981;&#22797;&#26434;&#65306;&#23427;&#19981;&#35843;&#29992; <span class="stt">value-of</span>&#65292;&#32780;&#26159;&#21019;&#24314;&#19968;&#20010;&#26032;&#29615;&#22659;&#65292;&#28982;&#21518;&#22312;&#26032;
&#29615;&#22659;&#20013;&#27714;&#20027;&#20307;&#30340;&#20540;&#65292;&#20027;&#20307;&#30340;&#20540;&#23601;&#26159;&#25972;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;&#36825;&#34920;&#26126;&#20027;&#20307;&#21644;&#25972;&#20010;&#34920;&#36798;&#24335;&#22312;&#21516;&#26679;&#30340;&#25511;&#21046;
&#19978;&#19979;&#25991;&#20013;&#25191;&#34892;&#12290;&#22240;&#27492;&#65292;&#20027;&#20307;&#30340;&#20540;&#24212;&#36820;&#22238;&#32473;&#25972;&#20010;&#34920;&#36798;&#24335;&#30340;&#32493;&#25991;&#12290;&#25152;&#20197;&#25105;&#20204;&#20889;&#65306;
<a name="(idx._(gentag._741))"></a></p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letrec-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">p-name</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-body</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">letrec-body</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">letrec-body</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">extend-env-rec</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-name</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-body</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#36825;&#35299;&#37322;&#20102;&#19968;&#26465;&#36890;&#29992;&#21407;&#21017;&#65306;</p><blockquote class="Tip"><blockquote class="SCentered"><p><span style="font-weight: bold">&#23614;&#35843;&#29992;&#19981;&#25193;&#22823;&#32493;&#25991;
<a name="(idx._(gentag._742))"></a>
<a name="(idx._(gentag._743))"></a></span></p></blockquote><p class="TipContent">&#33509; <span class="texMathInline">exp_1</span> &#30340;&#20540;&#20316;&#20026; <span class="texMathInline">exp_2</span> &#30340;&#20540;&#36820;&#22238;&#65292;&#21017;
<span class="texMathInline">exp_1</span> &#21644;<span class="texMathInline">exp_2</span> &#24212;&#22312;&#21516;&#26679;&#30340;&#32493;&#25991;&#20013;&#25191;&#34892;&#12290;</p></blockquote><p>&#20889;&#25104;&#36825;&#26679;&#26159;&#19981;&#23545;&#30340;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letrec-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">p-name</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-body</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">letrec-body</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">letrec-body</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">extend-env-rec</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-name</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-body</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#22240;&#20026;&#35843;&#29992; <span class="stt">value-of/k</span> &#26159;&#22312;&#25805;&#20316;&#25968;&#20301;&#32622;&#65306;&#23427;&#35201;&#20316;&#20026; <span class="stt">apply-cont</span> &#30340;&#25805;&#20316;&#25968;&#12290;&#21478;&#22806;&#65292;
&#30001;&#20110;&#20351;&#29992;&#32493;&#25991; <span class="stt">(end-cont)</span> &#20250;&#22312;&#35745;&#31639;&#23436;&#25104;&#20043;&#21069;&#25171;&#21360;&#20986;&#35745;&#31639;&#32467;&#26463;&#28040;&#24687;&#65292;&#36825;&#31181;&#38169;&#35823;&#24456;&#23481;&#26131;
&#25490;&#26597;&#12290;</p></blockquote><p>&#25509;&#19979;&#26469;&#25105;&#20204;&#32771;&#34385; <span class="stt">zero?</span> &#34920;&#36798;&#24335;&#12290;&#22312; <span class="stt">zero?</span> &#34920;&#36798;&#24335;&#20013;&#65292;&#25105;&#20204;&#24471;&#27714;&#20986;&#23454;&#21442;&#30340;&#20540;&#65292;&#28982;
&#21518;&#36820;&#22238;&#32473;&#20381;&#36182;&#35813;&#20540;&#30340;&#32493;&#25991;&#12290;&#25152;&#20197;&#25105;&#20204;&#35201;&#22312;&#26032;&#30340;&#32493;&#25991;&#20013;&#27714;&#23454;&#21442;&#30340;&#20540;&#65292;&#36825;&#20010;&#32493;&#25991;&#20250;&#21462;&#24471;&#36820;&#22238;&#20540;&#65292;
&#28982;&#21518;&#20570;&#36866;&#24403;&#22788;&#29702;&#12290;</p><p>&#37027;&#20040;&#65292;&#22312; <span class="stt">value-of/k</span> &#20013;&#65292;&#25105;&#20204;&#20889;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">zero1-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#20854;&#20013;&#65292;<span class="stt">(zero1-cont cont)</span> &#26159;&#19968;&#32493;&#25991;&#65292;&#20855;&#26377;&#22914;&#19979;&#24615;&#36136;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (zero1-cont </span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (apply-cont </span><span class="texMathInline">cont</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(bool-val</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(zero? (expval-&gt;num </span><span class="texMathInline">val</span><span class="stt">))))</span></p></td></tr></table></blockquote></blockquote><p>&#23601;&#20687; <span class="stt">letrec</span>&#65292;&#25105;&#20204;&#19981;&#33021;&#25226; <span class="stt">value-of/k</span> &#20889;&#25104;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">bool-val</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#22240;&#20026;&#35843;&#29992; <span class="stt">value-of/k</span> &#26159;&#22312;&#25805;&#20316;&#25968;&#20301;&#32622;&#12290;<span class="stt">let</span> &#22768;&#26126;&#30340;&#21491;&#36793;&#26159;&#22312;&#25805;&#20316;&#25968;&#20301;&#32622;&#65292;&#22240;&#20026;
<span class="stt">(let ((</span><span class="texMathInline">var</span><span class="stt"> </span><span class="texMathInline">exp_1</span><span class="stt">)) </span><span class="texMathInline">exp_2</span><span class="stt">)</span> &#31561;&#25928;&#20110; <span class="stt">((lambda (</span><span class="texMathInline">var</span><span class="stt">)</span><span class="stt">
</span><span class="texMathInline">exp_2</span><span class="stt">) </span><span class="texMathInline">exp_1</span><span class="stt">)</span>&#12290;<span class="stt">value-of/k</span> &#35843;&#29992;&#30340;&#20540;&#26368;&#32456;&#25104;&#20026; <span class="stt">expval-&gt;num</span> &#30340;&#25805;&#20316;
&#25968;&#12290;&#20687;&#20043;&#21069;&#37027;&#26679;&#65292;&#22914;&#26524;&#25105;&#20204;&#36816;&#34892;&#36825;&#27573;&#20195;&#30721;&#65292;&#35745;&#31639;&#32467;&#26463;&#28040;&#24687;&#20250;&#20986;&#29616;&#20004;&#27425;&#65306;&#19968;&#27425;&#22312;&#35745;&#31639;&#20013;&#38388;&#65292;&#19968;
&#27425;&#22312;&#30495;&#27491;&#32467;&#26463;&#26102;&#12290;</p></blockquote><p><span class="stt">let</span> &#34920;&#36798;&#24335;&#21482;&#27604; <span class="stt">zero?</span> &#34920;&#36798;&#24335;&#31245;&#24494;&#22797;&#26434;&#19968;&#28857;&#65306;&#27714;&#20986;&#22768;&#26126;&#21491;&#20391;&#30340;&#20540;&#20043;&#21518;&#65292;&#25105;&#20204;&#22312;
&#36866;&#24403;&#30340;&#25193;&#23637;&#29615;&#22659;&#20869;&#27714;&#20027;&#20307;&#30340;&#20540;&#12290;&#21407;&#26469;&#30340; <span class="stt">let</span> &#20195;&#30721;&#20026;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">body</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#22312;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#20013;&#65292;&#25105;&#20204;&#22312;&#23436;&#25104;&#21097;&#20313;&#35745;&#31639;&#30340;&#19978;&#19979;&#25991;&#20013;&#27714; <span class="texMathInline">exp_1</span> &#30340;&#20540;&#12290;&#25152;&#20197;&#65292;&#22312;
<span class="stt">value-of/k</span> &#20013;&#25105;&#20204;&#20889;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let-exp-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">body</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#28982;&#21518;&#25105;&#20204;&#32473;&#32493;&#25991;&#30340;&#25509;&#21475;&#28155;&#21152;&#35268;&#33539;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (let-exp-cont </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">body</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (value-of/k </span><span class="texMathInline">body</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(extend-env </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">val</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt">) </span><span class="texMathInline">cont</span><span class="stt">)</span></p></td></tr></table></blockquote></blockquote><p><span class="stt">let</span> &#34920;&#36798;&#24335;&#20027;&#20307;&#30340;&#20540;&#25104;&#20026; <span class="stt">let</span> &#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#25152;&#20197;&#27714; <span class="stt">let</span> &#34920;&#36798;&#24335;&#20027;&#20307;&#26102;&#30340;
&#32493;&#25991;&#19982;&#27714;&#25972;&#20010; <span class="stt">let</span> &#34920;&#36798;&#24335;&#30340;&#30456;&#21516;&#12290;&#36825;&#26159;<span style="font-weight: bold">&#23614;&#35843;&#29992;&#19981;&#25193;&#22823;&#32493;&#25991;</span>&#30340;&#21448;&#19968;&#20363;&#23376;&#12290;
<a name="(idx._(gentag._744))"></a></p><p><a name="(idx._(gentag._745))"></a>
&#19979;&#38754;&#25105;&#20204;&#22788;&#29702; <span class="stt">if</span> &#34920;&#36798;&#24335;&#12290;&#22312; <span class="stt">if</span> &#34920;&#36798;&#24335;&#20013;&#65292;&#25105;&#20204;&#39318;&#20808;&#27714;&#26465;&#20214;&#30340;&#20540;&#65292;&#20294;&#26465;&#20214;&#30340;&#32467;
&#26524;&#19981;&#26159;&#25972;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;&#25105;&#20204;&#35201;&#26032;&#29983;&#25104;&#19968;&#20010;&#32493;&#25991;&#65292;&#26597;&#30475;&#26465;&#20214;&#34920;&#36798;&#24335;&#30340;&#32467;&#26524;&#26159;&#21542;&#20026;&#30495;&#65292;&#28982;&#21518;&#27714;
&#30495;&#20540;&#34920;&#36798;&#24335;&#25110;&#20551;&#20540;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;&#25152;&#20197;&#22312; <span class="stt">value-of/k</span> &#20013;&#25105;&#20204;&#20889;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp3</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">if-test-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp3</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">body</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#20854;&#20013;&#65292;<span class="stt">if-test-cont</span> &#26159;&#21478;&#19968;&#20010;&#32493;&#25991;&#26500;&#36896;&#22120;&#65292;&#28385;&#36275;&#22914;&#19979;&#35268;&#33539;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (if-test-cont </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_3</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (if (expval-&gt;bool </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(value-of/k </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(value-of/k </span><span class="texMathInline">exp_3</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr></table></blockquote></blockquote><p><a name="(idx._(gentag._746))"></a>
&#29616;&#22312;&#65292;&#25105;&#20204;&#26377;&#20102;&#22235;&#20010;&#32493;&#25991;&#26500;&#36896;&#22120;&#12290;&#25105;&#20204;&#21487;&#20197;&#29992;&#36807;&#31243;&#34920;&#31034;&#27861;&#25110;&#32773;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#27861;&#23454;&#29616;&#23427;&#20204;&#12290;&#36807;
&#31243;&#34920;&#31034;&#27861;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#65292;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#27861;&#20351;&#29992; <span class="stt">define-datatype</span>&#65292;
&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;
<a name="(idx._(gentag._747))"></a>
<a name="(idx._(gentag._748))"></a>
<a name="(idx._(gentag._749))"></a></p><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="texMathInline">\mathit{Cont}</span> = <span class="texMathInline">\mathit{ExpVal}</span> -&gt; <span class="texMathInline">\mathit{FinalAnswer}</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">end-cont</span></span> : <span class="texMathInline">\mathit{()} \to \mathit{Cont}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">end-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eopl:printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"&#35745;&#31639;&#32467;&#26463;.~%"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">zero1-cont</span></span> : <span class="texMathInline">\mathit{Cont} \to \mathit{Cont}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">zero1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bool-val</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">let-exp-cont</span></span> : <span class="texMathInline">\mathit{Var} \times \mathit{Exp} \times \mathit{Env} \times \mathit{Cont} \to \mathit{Cont}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">let-exp-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">if-test-cont</span></span> : <span class="texMathInline">\mathit{Exp} \times \mathit{Exp} \times \mathit{Env} \times \mathit{Cont} \to \mathit{Cont}</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Exp</span><span class="hspace">&nbsp;</span><span class="RktSym">&#215;</span><span class="hspace">&nbsp;</span><span class="RktSym">Exp</span><span class="hspace">&nbsp;</span><span class="RktSym">&#215;</span><span class="hspace">&nbsp;</span><span class="RktSym">Env</span><span class="hspace">&nbsp;</span><span class="RktSym">&#215;</span><span class="hspace">&nbsp;</span><span class="RktSym">Cont</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8594;</span><span class="hspace">&nbsp;</span><span class="RktSym">Cont</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">if-test-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;bool</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">apply-cont</span></span> : <span class="texMathInline">\mathit{Cont} \times \mathit{ExpVal} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p>&#29992;&#36807;&#31243;&#34920;&#31034;&#32493;&#25991;
<a name="(idx._(gentag._750))"></a>
<a name="(idx._(gentag._751))"></a><a name="(elem._fig-5..2)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-datatype</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">identifier?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">environment?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-test-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">environment?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">apply-cont</span></span> : <span class="texMathInline">\mathit{Cont} \times \mathit{ExpVal} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eopl:printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"&#35745;&#31639;&#32467;&#26463;.~%"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero1-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bool-val</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-test-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;bool</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p>&#29992;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#32493;&#25991;
<a name="(idx._(gentag._752))"></a>
<a name="(idx._(gentag._753))"></a><a name="(elem._fig-5..3)"></a></p></blockquote></blockquote><p>&#19979;&#38754;&#36825;&#20010;&#31616;&#21333;&#31639;&#20363;&#23637;&#31034;&#20102;&#21508;&#37096;&#20998;&#22914;&#20309;&#37197;&#21512;&#12290;&#20687; <a href="expr.html#%28part._s3..3%29" data-pltdoc="x">PROC&#65306;&#26377;&#36807;&#31243;&#30340;&#35821;&#35328;</a>&#37027;&#26679;&#65292;&#25105;&#20204;&#29992;
<span class="texMathInline">\textnormal{\guillemotleft} exp \textnormal{\guillemotright}</span> &#25351;&#20195;&#34920;&#36798;&#24335;
<span class="texMathInline">exp</span> &#30340;&#25277;&#35937;&#35821;&#27861;&#26641;&#12290;&#35774; <span class="texMathInline">\rho_0</span> &#26159;&#19968;&#29615;&#22659;&#65292;<span class="stt">b</span> &#22312;&#20854;&#20013;&#32465;&#23450;&#21040; <span class="stt">(bool-val
#t)</span>&#65307;<span class="texMathInline">cont_0</span> &#26159;&#21021;&#22987;&#32493;&#25991;&#65292;&#21363; <span class="stt">(end-cont)</span> &#30340;&#20540;&#12290;&#27880;&#37322;&#35828;&#26126;&#19981;&#26159;&#27491;&#24335;&#30340;&#65292;&#24212;&#19982;
<span class="stt">value-of/k</span> &#30340;&#23450;&#20041;&#21644; <span class="stt">apply-cont</span> &#30340;&#35268;&#33539;&#23545;&#29031;&#38405;&#35835;&#12290;&#36825;&#20010;&#20363;&#23376;&#26159;&#39044;&#27979;&#24615;&#30340;&#65292;&#22240;
&#20026;&#25105;&#20204;&#35753; <span class="stt">letrec</span> &#24341;&#20837;&#20102;&#36807;&#31243;&#65292;&#20294;&#36824;&#19981;&#30693;&#36947;&#22914;&#20309;&#35843;&#29992;&#23427;&#12290;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(value-of/k &lt;&lt;letrec p(x) = x in if b then 3 else 4&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_0</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#20196;<span class="texMathInline">\rho_0</span>&#20026;</span><span class="stt">(extend-env-rec ... </span><span class="texMathInline">\rho_0</span><span class="stt">)</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k &lt;&lt;if b then 3 else 4&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_0</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#28982;&#21518;&#65292;&#27714;&#26465;&#20214;&#34920;&#36798;&#24335;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k &lt;&lt;b&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(test-cont &lt;&lt;3&gt;&gt; &lt;&lt;4&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_0</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25226;</span><span class="stt">b</span><span class="emph">&#30340;&#20540;&#20256;&#32473;&#32493;&#25991;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont (test-cont &lt;&lt;3&gt;&gt; &lt;&lt;4&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_0</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(bool-val #f))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#27714;&#30495;&#20540;&#34920;&#36798;&#24335;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k &lt;&lt;3&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_0</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25226;&#34920;&#36798;&#24335;&#30340;&#20540;&#20256;&#32473;&#32493;&#25991;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont </span><span class="texMathInline">cont_0</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(num-val 3))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#22312;&#26368;&#21518;&#30340;&#32493;&#25991;&#20013;&#22788;&#29702;&#26368;&#32456;&#31572;&#26696;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(begin (eopl:printf ...) (num-val 3))</span></p></td></tr></table></blockquote><p><a name="(idx._(gentag._754))"></a>
&#24046;&#20540;&#34920;&#36798;&#24335;&#32473;&#25105;&#20204;&#30340;&#35299;&#37322;&#22120;&#24102;&#26469;&#20102;&#26032;&#22256;&#38590;&#65292;&#22240;&#20026;&#23427;&#24471;&#27714;&#20004;&#20010;&#25805;&#20316;&#25968;&#30340;&#20540;&#12290;&#25105;&#20204;&#36824;&#20687; <span class="stt">if</span>
&#37027;&#26679;&#24320;&#22987;&#65292;&#20808;&#27714;&#31532;&#19968;&#20010;&#23454;&#21442;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">diff1-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#24403; <span class="stt">(diff1-cont exp2 env cont)</span> &#25910;&#21040;&#19968;&#20010;&#20540;&#65292;&#23427;&#24212;&#27714; <span class="stt">exp2</span> &#30340;&#20540;&#65292;&#27714;&#20540;&#26102;&#30340;&#19978;
&#19979;&#25991;&#24212;&#20445;&#23384; <span class="stt">exp1</span> &#30340;&#20540;&#12290;&#25105;&#20204;&#23558;&#20854;&#23450;&#20041;&#20026;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (diff1-cont </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (value-of/k </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(diff2-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr></table></blockquote><p>&#24403; <span class="stt">(diff2-cont val1 cont)</span> &#25910;&#21040;&#19968;&#20010;&#20540;&#65292;&#25105;&#20204;&#24471;&#21040;&#20102;&#20004;&#20010;&#25805;&#20316;&#25968;&#30340;&#20540;&#65292;&#25152;&#20197;&#65292;&#25105;&#20204;
&#21487;&#20197;&#25226;&#20108;&#32773;&#30340;&#24046;&#32487;&#32493;&#20256;&#32473;&#31561;&#24453;&#20013;&#30340; <span class="stt">cont</span>&#12290;&#23450;&#20041;&#20026;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (diff2-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (let ((num1 (expval-&gt;num </span><span class="texMathInline">val1</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(num2 (expval-&gt;num </span><span class="texMathInline">val2</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(apply-cont </span><span class="texMathInline">cont</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(num-val (- num1 num2))))</span></p></td></tr></table></blockquote><p>&#35753;&#25105;&#20204;&#30475;&#30475;&#35813;&#31995;&#32479;&#30340;&#20363;&#23376;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplComputationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><a name="(elem._cps-computation)"></a><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;-(-(44,11),3)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#24320;&#22987;&#22788;&#29702;&#31532;&#19968;&#20010;&#25805;&#20316;&#25968;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;-(44,11)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;3&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#24320;&#22987;&#22788;&#29702;&#31532;&#19968;&#20010;&#25805;&#20316;&#25968;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;44&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;11&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;3&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25226;</span><span class="stt">&lt;&lt;44&gt;&gt;</span>&#30340;&#20540;&#20256;&#32473;&#32493;&#25991;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;11&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;3&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(num-val 44))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#29616;&#22312;&#65292;&#24320;&#22987;&#22788;&#29702;&#31532;&#20108;&#20010;&#25805;&#20316;&#25968;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;11&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff2-cont (num-val 44)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;3&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25226;&#20540;&#20256;&#32473;&#32493;&#25991;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff2-cont (num-val 44)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;3&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(num-val 11))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph"><span class="texMathInline">44-11</span>&#31561;&#20110;<span class="texMathInline">33</span>&#65292;&#20256;&#32473;&#32493;&#25991;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;3&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(num-val 33))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#24320;&#22987;&#22788;&#29702;&#31532;&#20108;&#20010;&#25805;&#20316;&#25968;</span><span class="stt">&lt;&lt;3&gt;&gt;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;3&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff2-cont (num-val 33)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25226;&#20540;&#20256;&#32473;&#32493;&#25991;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff2-cont (num-val 33)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(num-val 3))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph"><span class="texMathInline">33-3</span>&#31561;&#20110;<span class="texMathInline">30</span>&#65292;&#20256;&#32473;&#32493;&#25991;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(num-val 30))</span></p></td></tr></table></blockquote><p><span class="stt">apply-cont</span> &#25171;&#21360;&#20986;&#28040;&#24687;&#8220;&#35745;&#31639;&#32467;&#26463;&#8221;&#65292;&#36820;&#22238;&#35745;&#31639;&#30340;&#26368;&#32456;
&#32467;&#26524; <span class="stt">(num-val 30)</span>&#12290;</p></blockquote><p><a name="(idx._(gentag._755))"></a>
&#25105;&#20204;&#30340;&#35821;&#35328;&#20013;&#26368;&#21518;&#35201;&#22788;&#29702;&#30340;&#26159;&#36807;&#31243;&#35843;&#29992;&#12290;&#22312;&#20256;&#36882;&#29615;&#22659;&#30340;&#35299;&#37322;&#22120;&#20013;&#65292;&#25105;&#20204;&#20889;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">call-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rand</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rator</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rand</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-procedure</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">proc1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">arg</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#23601;&#20687;&#22312; <span class="stt">diff-exp</span> &#20013;&#19968;&#26679;&#65292;&#36825;&#37324;&#35201;&#22788;&#29702;&#20004;&#20010;&#35843;&#29992;&#12290;&#25152;&#20197;&#25105;&#20204;&#24517;&#39035;&#20808;&#25321;&#20854;&#19968;&#65292;&#28982;&#21518;&#36716;&#25442;
&#20313;&#19979;&#37096;&#20998;&#26469;&#22788;&#29702;&#31532;&#20108;&#20010;&#12290;&#27492;&#22806;&#65292;&#25105;&#20204;&#24517;&#39035;&#25226;&#32493;&#25991;&#20256;&#32473; <span class="stt">apply-procedure</span>&#65292;&#22240;&#20026;
<span class="stt">apply-procedure</span> &#35201;&#35843;&#29992; <span class="stt">value-of/k</span>&#12290;</p><p>&#25105;&#20204;&#36873;&#25321;&#20808;&#27714;&#25805;&#20316;&#31526;&#30340;&#20540;&#65292;&#25152;&#20197;&#22312; <span class="stt">value-of/k</span> &#20013;&#25105;&#20204;&#20889;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">call-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rand</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rator</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">rator-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rand</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#23601;&#20687; <span class="stt">diff-exp</span>&#65292;<span class="stt">rator-cont</span> &#22312;&#36866;&#24403;&#30340;&#29615;&#22659;&#20013;&#27714;&#25805;&#20316;&#25968;&#30340;&#20540;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (rator-cont </span><span class="texMathInline">rand</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (value-of/k </span><span class="texMathInline">rand</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(rand-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr></table></blockquote><p><a name="(idx._(gentag._756))"></a>
&#24403; <span class="stt">rand-cont</span> &#25910;&#21040;&#19968;&#20010;&#20540;&#65292;&#23427;&#23601;&#21487;&#20197;&#35843;&#29992;&#36807;&#31243;&#20102;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (rand-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (let ((proc1 (expval-&gt;proc </span><span class="texMathInline">val1</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(apply-procedure/k proc1 </span><span class="texMathInline">val2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr></table></blockquote><p>&#26368;&#21518;&#65292;&#25105;&#20204;&#36824;&#35201;&#20462;&#25913; <span class="stt">apply-procedure</span>&#65292;&#20197;&#31526;&#21512;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#65306;</p><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">apply-procedure/k</span></span> : <span class="texMathInline">\mathit{Proc} \times \mathit{ExpVal} \times \mathit{Cont} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._757))"></a></div></p></blockquote></blockquote><p>&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#23637;&#31034;&#23436;&#27605;&#12290;&#23436;&#25972;&#30340;&#35299;&#37322;&#22120;&#22914;<span class="EoplFigureRef"></span> &#21644;
<span class="stt">fig-5.5</span> &#25152;&#31034;&#12290;&#32493;&#25991;&#30340;&#23436;&#25972;&#35268;&#33539;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;</p><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of-program</span></span> : <span class="texMathInline">\mathit{Program} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pgm</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">program</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">value-of/k</span></span> : <span class="texMathInline">\mathit{Exp} \times \mathit{Env} \times \mathit{Cont} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-val</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letrec-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p-name</span><span class="hspace">&nbsp;</span><span class="RktSym">b-var</span><span class="hspace">&nbsp;</span><span class="RktSym">p-body</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env-rec</span><span class="hspace">&nbsp;</span><span class="RktSym">p-name</span><span class="hspace">&nbsp;</span><span class="RktSym">b-var</span><span class="hspace">&nbsp;</span><span class="RktSym">p-body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-test-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">call-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">rand</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="caption"><p>&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#65288;&#31532;1&#37096;&#20998;&#65289;
<a name="(idx._(gentag._758))"></a>
<a name="(idx._(gentag._759))"></a><a name="(elem._fig-5..4)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._760))"></a></div></p></blockquote><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">apply-procedure</span></span> : <span class="texMathInline">\mathit{Proc} \times \mathit{ExpVal} \times \mathit{FinalAnswer} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="caption"><p>&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#65288;&#31532;2&#37096;&#20998;&#65289;
<a name="(idx._(gentag._761))"></a>
<a name="(idx._(gentag._762))"></a><a name="(elem._fig-5..5)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._763))"></a></div></p></blockquote><p><a name="(elem._tail-call-explain)"></a>&#29616;&#22312;&#25105;&#20204;&#21487;&#20197;&#39564;&#35777;&#26029;&#35328;&#65306;&#19981;&#26159;&#36807;&#31243;&#35843;&#29992;&#65292;&#32780;&#26159;&#23454;&#21442;&#30340;&#27714;
&#20540;&#25193;&#22823;&#20102;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;&#20855;&#20307;&#26469;&#35828;&#65292;&#22914;&#26524;&#25105;&#20204;&#22312;&#26576;&#20010;&#32493;&#25991; <span class="texMathInline">cont_1</span> &#20013;&#27714;&#36807;&#31243;&#35843;&#29992;
<span class="stt">(</span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">exp_2</span><span class="stt">)</span> &#30340;&#20540;&#65292;&#27714; <span class="texMathInline">exp_1</span> &#24471;&#21040;&#30340;&#36807;&#31243;&#20027;&#20307;&#20063;&#23558;&#22312; <span class="texMathInline">cont_1</span> &#20013;
&#27714;&#20540;&#12290;</p><p>&#20294;&#36807;&#31243;&#35843;&#29992;&#26412;&#36523;&#19981;&#20250;&#22686;&#22823;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;&#32771;&#34385; <span class="stt">(</span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">exp_2</span><span class="stt">)</span> &#30340;&#27714;&#20540;&#65292;&#20854;&#20013;
<span class="texMathInline">exp_1</span> &#30340;&#20540;&#26159;&#19968;&#20010;&#36807;&#31243; <span class="texMathInline">proc_1</span>&#65292;<span class="texMathInline">exp_2</span> &#30340;&#20540;&#26159;&#26576;&#20010;&#34920;&#36798;&#20540; <span class="texMathInline">val_2</span>&#12290;</p><blockquote class="EoplComputationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(value-of/k &lt;&lt;(</span><span class="texMathInline">exp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_2</span><span class="stt">)&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#27714;&#25805;&#20316;&#31526;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k &lt;&lt;</span><span class="texMathInline">exp_1</span><span class="stt">&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(rator-cont &lt;&lt;</span><span class="texMathInline">exp_2</span><span class="stt">&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_1</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25226;&#36807;&#31243;&#20540;&#20256;&#32473;&#32493;&#25991;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(rator-cont &lt;&lt;</span><span class="texMathInline">exp_2</span><span class="stt">&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">proc_1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#27714;&#25805;&#20316;&#31526;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k &lt;&lt;</span><span class="texMathInline">exp_2</span><span class="stt">&gt;&gt; </span><span class="texMathInline">\rho_1</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(rand-cont &lt;&lt;</span><span class="texMathInline">proc_1</span><span class="stt">&gt;&gt; </span><span class="texMathInline">cont_1</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25226;&#21442;&#25968;&#20540;&#20256;&#32473;&#32493;&#25991;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(rand-cont &lt;&lt;</span><span class="texMathInline">proc_1</span><span class="stt">&gt;&gt; </span><span class="texMathInline">cont_1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">val_2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#35843;&#29992;&#36807;&#31243;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-procedure/k </span><span class="texMathInline">proc_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">val_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_1</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#25152;&#20197;&#65292;&#36807;&#31243;&#35843;&#29992;&#26102;&#65292;&#36807;&#31243;&#20027;&#20307;&#22312;&#36807;&#31243;&#35843;&#29992;&#25152;&#22312;&#30340;&#32493;&#25991;&#20013;&#27714;&#20540;&#12290;&#25805;&#20316;&#25968;&#30340;&#27714;&#20540;&#38656;&#35201;&#25511;&#21046;&#19978;&#19979;&#25991;&#65292;
&#36827;&#20837;&#36807;&#31243;&#20027;&#20307;&#21017;&#19981;&#38656;&#35201;&#12290;
<a name="(idx._(gentag._764))"></a>
<a name="(idx._(gentag._765))"></a>
<a name="(idx._(gentag._766))"></a>
<a name="(idx._(gentag._767))"></a>
<a name="(idx._(gentag._768))"></a></p><blockquote class="EoplFigure"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (end-cont) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(eopl:printf</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"&#35745;&#31639;&#32467;&#26463;.~%")</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (diff1-cont </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (value-of/k </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(diff2-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (diff2-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (let ((num1 (expval-&gt;num </span><span class="texMathInline">val1</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(num2 (expval-&gt;num </span><span class="texMathInline">val2</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(apply-cont </span><span class="texMathInline">cont</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(num-val (- num1 num2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (rator-cont </span><span class="texMathInline">rand</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (value-of/k </span><span class="texMathInline">rand</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(rand-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (rand-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (let ((proc1 (expval-&gt;proc </span><span class="texMathInline">val1</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(apply-procedure/k proc1 </span><span class="texMathInline">val2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (zero1-cont </span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (apply-cont </span><span class="texMathInline">cont</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(bool-val (zero? (expval-&gt;num </span><span class="texMathInline">val</span><span class="stt">))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (if-test-cont </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_3</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (if (expval-&gt;bool </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(value-of/k </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(value-of/k </span><span class="texMathInline">exp_3</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (let-exp-cont </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">body</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (value-of/k </span><span class="texMathInline">body</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(extend-env </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt">) </span><span class="texMathInline">cont</span><span class="stt">)</span></p></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="caption"><p><span class="EoplFigureRef"></span> &#20013;&#32493;&#25991;&#30340;&#35268;&#33539;
<a name="(idx._(gentag._769))"></a>
<a name="(idx._(gentag._770))"></a><a name="(elem._fig-5..6)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._771))"></a></div></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..1)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._772))"></a>
<a name="(idx._(gentag._773))"></a>
&#29992;&#36807;&#31243;&#34920;&#31034;&#27861;&#23454;&#29616;&#32493;&#25991;&#25968;&#25454;&#31867;&#22411;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..2)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._774))"></a>
<a name="(idx._(gentag._775))"></a>
&#29992;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#27861;&#23454;&#29616;&#32493;&#25991;&#25968;&#25454;&#31867;&#22411;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..3)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;&#35299;&#37322;&#22120;&#28155;&#21152; <span class="stt">let2</span>&#12290;<span class="stt">let2</span> &#34920;&#36798;&#24335;&#23601;&#20687; <span class="stt">let</span> &#34920;&#36798;&#24335;&#65292;&#20294;&#35201;&#25351;&#23450;&#20004;&#20010;&#21464;&#37327;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..4)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;&#35299;&#37322;&#22120;&#28155;&#21152; <span class="stt">let3</span>&#12290;<span class="stt">let3</span> &#34920;&#36798;&#24335;&#23601;&#20687; <span class="stt">let</span> &#34920;&#36798;&#24335;&#65292;&#20294;&#35201;&#25351;&#23450;&#19977;&#20010;&#21464;&#37327;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..5)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._776))"></a>
&#32473;&#35821;&#35328;&#28155;&#21152;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#21015;&#34920;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..6)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._777))"></a>
&#32473;&#35821;&#35328;&#28155;&#21152;<span class="EoplExerciseRef"></span> &#20013;&#30340; <span class="stt">list</span> &#34920;&#36798;&#24335;&#12290;&#25552;&#31034;&#65306;&#28155;&#21152;&#20004;&#20010;&#32493;&#25991;&#26500;&#36896;&#22120;&#65292;
&#19968;&#20010;&#29992;&#26469;&#27714;&#21015;&#34920;&#39318;&#20803;&#32032;&#30340;&#20540;&#65292;&#19968;&#20010;&#29992;&#26469;&#27714;&#21015;&#34920;&#21097;&#20313;&#20803;&#32032;&#30340;&#20540;&#12290;
<a name="(idx._(gentag._778))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..7)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._779))"></a>
&#32473;&#35299;&#37322;&#22120;&#28155;&#21152;&#22810;&#22768;&#26126;&#30340; <span class="stt">let</span>&#65288;<span class="EoplExerciseRef"></span>&#65289;&#12290;
<a name="(idx._(gentag._780))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..8)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._781))"></a>
&#32473;&#35299;&#37322;&#22120;&#28155;&#21152;&#22810;&#21442;&#25968;&#36807;&#31243;&#65288;<span class="EoplExerciseRef"></span>&#65289;&#12290;
<a name="(idx._(gentag._782))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..9)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._783))"></a>
&#20462;&#25913;&#36825;&#20010;&#35299;&#37322;&#22120;&#65292;&#23454;&#29616; IMPLICIT-REFS &#35821;&#35328;&#12290;&#25552;&#31034;&#65306;&#28155;&#21152;&#26032;&#30340;&#32493;&#25991;&#26500;&#36896;&#22120;
<span class="stt">(set-rhs-cont env var cont)</span>&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..10)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;&#21069;&#19968;&#39064;&#30340;&#35299;&#31572;&#65292;&#19981;&#35201;&#22312;&#32493;&#25991;&#20013;&#20445;&#23384;&#29615;&#22659;&#12290;
<a name="(idx._(gentag._784))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..11)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._785))"></a>
&#32473;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#28155;&#21152;<span class="EoplExerciseRef"></span> &#20013;&#30340; <span class="stt">begin</span> &#34920;&#36798;&#24335;&#12290;&#30830;&#20445;&#35843;&#29992;
<span class="stt">value-of</span> &#21644; <span class="stt">value-of-rands</span> &#26102;&#19981;&#38656;&#35201;&#29983;&#25104;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;
<a name="(idx._(gentag._786))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..12)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;<span class="EoplFigureRef"></span>&ndash;<span class="stt">fig-5.6</span> &#30340;&#35299;&#37322;&#22120;&#28155;&#21152;&#36741;&#21161;&#36807;&#31243;&#65292;&#29983;&#25104;&#31867;&#20284;
<span class="stt">cps-computation</span> &#35745;&#31639;&#30340;&#36755;&#20986;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..13)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._787))"></a>
&#25226; <span class="stt">fact</span> &#21644; <span class="stt">fact-iter</span> &#32763;&#35793;&#20026; LETREC &#35821;&#35328;&#12290;&#20320;&#21487;&#20197;&#32473;&#35821;&#35328;&#28155;&#21152;&#20056;&#27861;&#25805;&#20316;&#31526;&#12290;
&#28982;&#21518;&#65292;&#29992;&#21069;&#19968;&#36947;&#32451;&#20064;&#20013;&#24102;&#26377;&#36741;&#21161;&#32452;&#20214;&#30340;&#35299;&#37322;&#22120;&#35745;&#31639; <span class="stt">(fact 4)</span> &#21644; <span class="stt">(fact-iter 4)</span>&#12290;
&#23558;&#23427;&#20204;&#21644;&#26412;&#31456;&#24320;&#22836;&#30340;&#35745;&#31639;&#27604;&#36739;&#12290;&#22312; <span class="stt">(fact 4)</span> &#30340;&#36319;&#36394;&#26085;&#24535;&#20013;&#25214;&#20986; <span class="stt">(* 4 (* 3 (* 2
(fact 1))))</span>&#12290;&#35843;&#29992; <span class="stt">(fact 1)</span> &#26102;&#65292;<span class="stt">apply-procedure/k</span> &#30340;&#32493;&#25991;&#26159;&#20160;&#20040;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..14)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._788))"></a>
<a name="(idx._(gentag._789))"></a>
&#21069;&#38754;&#32451;&#20064;&#20013;&#30340;&#36741;&#21161;&#32452;&#20214;&#20135;&#29983;&#22823;&#37327;&#36755;&#20986;&#12290;&#20462;&#25913;&#36741;&#21161;&#32452;&#20214;&#65292;&#21482;&#36319;&#36394;&#35745;&#31639;&#36807;&#31243;&#20013;&#26368;&#22823;&#32493;&#25991;
&#30340;<span class="emph">&#23610;&#23544;</span>&#12290;&#25105;&#20204;&#29992;&#32493;&#25991;&#26500;&#36896;&#22120;&#30340;&#20351;&#29992;&#27425;&#25968;&#34913;&#37327;&#32493;&#25991;&#30340;&#22823;&#23567;&#65292;&#25152;
&#20197;<span class="stt">cps-computation</span>&#30340;&#35745;&#31639;&#20013;&#65292;&#32493;&#25991;&#26368;&#22823;&#23610;&#23544;&#26159; 3&#12290;&#28982;&#21518;&#65292;&#29992; <span class="stt">fact</span> &#21644;
<span class="stt">fact-iter</span> &#35745;&#31639;&#20960;&#20010;&#25805;&#20316;&#25968;&#30340;&#20540;&#12290;&#39564;&#35777; <span class="stt">fact</span> &#20351;&#29992;&#30340;&#32493;&#25991;&#26368;&#22823;&#23610;&#23544;&#38543;&#20854;&#21442;&#25968;&#36882;&#22686;&#65292;
&#20294; <span class="stt">fact-iter</span> &#20351;&#29992;&#30340;&#32493;&#25991;&#26368;&#22823;&#23610;&#23544;&#26159;&#24120;&#25968;&#12290;
<a name="(idx._(gentag._790))"></a>
<a name="(idx._(gentag._791))"></a>
<a name="(idx._(gentag._792))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..15)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._793))"></a>
<a name="(idx._(gentag._794))"></a>
&#25105;&#20204;&#30340;&#32493;&#25991;&#25968;&#25454;&#31867;&#22411;&#21482;&#26377;&#19968;&#20010;&#24120;&#37327; <span class="stt">end-cont</span>&#65292;&#25152;&#26377;&#20854;&#20182;&#32493;&#25991;&#26500;&#36896;&#22120;&#37117;&#26377;&#19968;&#20010;&#32493;&#25991;&#21442;&#25968;&#12290;
&#29992;&#21015;&#34920;&#34920;&#31034;&#21644;&#23454;&#29616;&#32493;&#25991;&#12290;&#29992;&#31354;&#21015;&#34920;&#34920;&#31034; <span class="stt">end-cont</span>&#65292;&#29992;&#39318;&#39033;&#20026;&#20854;&#20182;&#25968;&#25454;&#32467;&#26500;
&#65288;&#21517;&#20026;<span class="emph">&#24103;</span> (<span class="emph">frame</span>) &#25110;<span class="emph">&#27963;&#36291;&#35760;&#24405;&#34920;</span> (<span class="emph">activation record</span>)&#65289;&#65292;&#20313;&#39033;&#20026;&#24050;&#20445;
&#23384;&#32493;&#25991;&#30340;&#38750;&#31354;&#21015;&#34920;&#34920;&#31034;&#20854;&#20182;&#32493;&#25991;&#12290;&#35266;&#23519;&#21487;&#30693;&#65292;&#35299;&#37322;&#22120;&#25226;&#36825;&#20123;&#21015;&#34920;&#24403;&#25104;&#65288;&#24103;&#30340;&#65289;&#22534;&#26632;&#12290;
<a name="(idx._(gentag._795))"></a>
<a name="(idx._(gentag._796))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..16)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._797))"></a>
<a name="(idx._(gentag._798))"></a>
<a name="(idx._(gentag._799))"></a>
&#25193;&#23637;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#65292;&#22788;&#29702;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#35821;&#35328;&#12290;&#32473; <span class="stt">result-of</span> &#20256;&#36882;
&#19968;&#20010;&#32493;&#25991;&#21442;&#25968;&#65292;&#30830;&#20445; <span class="stt">result-of</span> &#19981;&#22312;&#25193;&#22823;&#25511;&#21046;&#19978;&#19979;&#25991;&#30340;&#20301;&#32622;&#35843;&#29992;&#12290;&#22240;&#20026;&#35821;&#21477;&#19981;&#36820;&#22238;&#20540;&#65292;
&#38656;&#35201;&#21306;&#20998;&#26222;&#36890;&#32493;&#25991;&#21644;&#35821;&#21477;&#32493;&#25991;&#65307;&#21518;&#32773;&#36890;&#24120;&#21483;<span class="emph">&#21629;&#20196;&#32493;&#25991;</span> (<span class="emph">command continuation</span>)&#12290;
&#32493;&#25991;&#25509;&#21475;&#24212;&#21253;&#21547;&#36807;&#31243; <span class="stt">apply-command-cont</span>&#65292;&#23427;&#21462;&#19968;&#21629;&#20196;&#32493;&#25991;&#24182;&#20351;&#29992;&#23427;&#12290;&#29992;&#25968;&#25454;&#32467;&#26500;&#21644;
&#26080;&#21442;&#25968;&#36807;&#31243;&#20004;&#31181;&#26041;&#24335;&#23454;&#29616;&#21629;&#20196;&#32493;&#25991;&#12290;
<a name="(idx._(gentag._800))"></a>
<a name="(idx._(gentag._801))"></a>
<a name="(idx._(gentag._802))"></a></p></blockquote><h4>5.2<tt>&nbsp;</tt><a name="(part._s5..2)"></a>&#36339;&#36291;&#24335;&#35299;&#37322;&#22120;</h4><p><a name="(idx._(gentag._803))"></a>
<a name="(idx._(gentag._804))"></a>
&#26377;&#20154;&#21487;&#33021;&#24819;&#29992;&#26222;&#36890;&#30340;&#36807;&#31243;&#24335;&#35821;&#35328;&#36716;&#35793;&#35299;&#37322;&#22120;&#65292;&#20351;&#29992;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#32493;&#25991;&#65292;&#20174;&#32780;&#36991;&#20813;&#39640;&#38454;&#20989;&#25968;&#12290;
&#20294;&#26159;&#65292;&#29992;&#22823;&#22810;&#25968;&#36807;&#31243;&#24335;&#35821;&#35328;&#20570;&#36825;&#31181;&#32763;&#35793;&#37117;&#24456;&#22256;&#38590;&#65306;<a name="(elem._imper-reason)"></a>&#23427;&#20204;&#19981;&#21482;&#22312;
&#24517;&#35201;&#26102;&#25165;&#25193;&#22823;&#25511;&#21046;&#19978;&#19979;&#25991;&#65292;&#32780;&#19988;&#22312;&#27599;&#20010;&#20989;&#25968;&#35843;&#29992;&#22788;&#25193;&#22823;&#25511;&#21046;&#19978;&#19979;&#25991;&#65288;&#21363;&#22534;&#26632;&#65281;&#65289;&#12290;&#22312;&#25105;&#20204;&#30340;
&#31995;&#32479;&#20013;&#65292;&#30001;&#20110;&#36807;&#31243;&#35843;&#29992;&#22312;&#35745;&#31639;&#32467;&#26463;&#20043;&#21069;&#19981;&#36820;&#22238;&#65292;&#22312;&#37027;&#20043;&#21069;&#65292;&#31995;&#32479;&#30340;&#22534;&#26632;&#23558;&#19968;&#30452;&#22686;&#39640;&#12290;</p><p><a name="(idx._(gentag._805))"></a>
<a name="(elem._imperative-lang)"></a>&#36825;&#31181;&#34892;&#20026;&#19981;&#26080;&#36947;&#29702;&#65306;&#22312;&#36825;&#31181;&#35821;&#35328;&#20013;&#65292;&#20960;&#20046;&#25152;&#26377;&#30340;&#36807;&#31243;&#35843;&#29992;
&#37117;&#20986;&#29616;&#22312;&#36171;&#20540;&#35821;&#21477;&#30340;&#21491;&#36793;&#65292;&#25152;&#20197;&#20960;&#20046;&#25152;&#26377;&#36807;&#31243;&#35843;&#29992;&#37117;&#35201;&#25193;&#22823;&#25511;&#21046;&#19978;&#19979;&#25991;&#65292;&#20197;&#20415;&#35760;&#24405;&#24453;&#23436;&#25104;&#30340;
&#36171;&#20540;&#12290;&#22240;&#27492;&#65292;&#20307;&#31995;&#32467;&#26500;&#20026;&#36825;&#31181;&#26368;&#24120;&#35265;&#30340;&#24773;&#24418;&#20570;&#20102;&#20248;&#21270;&#12290;&#32780;&#19988;&#65292;&#30001;&#20110;&#22823;&#22810;&#25968;&#35821;&#35328;&#22312;&#22534;&#26632;&#20013;&#23384;&#20648;
&#29615;&#22659;&#20449;&#24687;&#65292;&#25152;&#26377;&#36807;&#31243;&#35843;&#29992;&#29983;&#25104;&#30340;&#25511;&#21046;&#19978;&#19979;&#25991;&#37117;&#19981;&#33021;&#24536;&#20102;&#31227;&#38500;&#36825;&#19968;&#20449;&#24687;&#12290;</p><p><a name="(idx._(gentag._806))"></a>
&#22312;&#36825;&#31181;&#35821;&#35328;&#20013;&#65292;&#19968;&#31181;&#35299;&#20915;&#26041;&#26696;&#26159;&#20351;&#29992;<span class="emph">&#36339;&#36291;</span> (<span class="emph">trampolining</span>) &#25216;&#26415;&#12290;&#20026;&#20102;&#36991;&#20813;&#20135;&#29983;&#26080;
&#38480;&#38271;&#30340;&#35843;&#29992;&#38142;&#65292;&#25105;&#20204;&#25226;&#35843;&#29992;&#38142;&#25171;&#26029;&#65292;&#35753;&#35299;&#37322;&#22120;&#20013;&#30340;&#26576;&#20010;&#36807;&#31243;&#36820;&#22238;&#19968;&#20010;&#26080;&#21442;&#25968;&#36807;&#31243;&#12290;&#36825;&#20010;&#36807;&#31243;
&#22312;&#35843;&#29992;&#26102;&#32487;&#32493;&#35745;&#31639;&#12290;&#25972;&#20010;&#35745;&#31639;&#30001;&#19968;&#20010;&#21517;&#21483;<span class="emph">&#36339;&#24202;</span> (<span class="emph">trampoline</span>) &#30340;&#36807;&#31243;&#39537;&#21160;&#65292;&#23427;&#20174;&#19968;
&#20010;&#36807;&#31243;&#35843;&#29992;&#24377;&#23556;&#21040;&#21478;&#19968;&#20010;&#12290;&#20363;&#22914;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312; <span class="stt">apply-procedure/k</span>&#30340;&#20027;&#20307;&#21608;&#22260;&#25554;&#20837;&#19968;
&#20010; <span class="stt">(lambda () ...)</span>&#65292;&#22240;&#20026;&#22312;&#25105;&#20204;&#30340;&#35821;&#35328;&#20013;&#65292;&#21482;&#35201;&#19981;&#25191;&#34892;&#36807;&#31243;&#35843;&#29992;&#65292;&#34920;&#36798;&#24335;&#30340;&#36816;&#34892;&#26102;
&#38388;&#23601;&#26159;&#26377;&#38480;&#30340;&#12290;</p><p>&#24471;&#20986;&#30340;&#20195;&#30721;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#65292;&#23427;&#20063;&#23637;&#31034;&#20102;&#35299;&#37322;&#22120;&#20013;&#25152;&#26377;&#30340;&#23614;&#35843;&#29992;&#12290;&#22240;&#20026;&#25105;&#20204;
&#20462;&#25913;&#20102; <span class="stt">apply-procedure/k</span>&#65292;&#19981;&#20877;&#35753;&#23427;&#36820;&#22238;&#19968;&#20010; <span class="texMathInline">\mathit{ExpVal}</span>&#65292;&#32780;&#26159;&#36820;&#22238;&#19968;
&#20010;&#36807;&#31243;&#65292;&#25105;&#20204;&#24471;&#37325;&#20889;&#23427;&#21644;&#23427;&#25152;&#35843;&#29992;&#25152;&#26377;&#36807;&#31243;&#30340;&#21512;&#32422;&#12290;&#25152;&#20197;&#65292;&#25105;&#20204;&#24517;&#39035;&#26816;&#26597;&#35299;&#37322;&#22120;&#20013;&#25152;&#26377;&#36807;&#31243;
&#30340;&#21512;&#32422;&#12290;</p><p><a name="(idx._(gentag._807))"></a>
&#25105;&#20204;&#20174; <span class="stt">value-of-program</span> &#24320;&#22987;&#12290;&#30001;&#20110;&#36825;&#26159;&#35843;&#29992;&#35299;&#37322;&#22120;&#30340;&#36807;&#31243;&#65292;&#23427;&#30340;&#21512;&#32422;&#20445;&#25345;&#19981;&#21464;&#12290;
&#23427;&#35843;&#29992; <span class="stt">value-of/k</span>&#65292;&#25226;&#32467;&#26524;&#20256;&#32473; <span class="stt">trampoline</span>&#12290;&#22240;&#20026;&#25105;&#20204;&#35201;&#25805;&#20316;
<span class="stt">value-of/k</span> &#30340;&#32467;&#26524;&#65292;&#25152;&#20197;&#23427;&#19981;&#26159; <span class="texMathInline">\mathit{FinalAnswer}</span>&#12290;&#25105;&#20204;&#26126;&#26126;&#27809;&#26377;&#20462;&#25913;
<span class="stt">value-of/k</span> &#30340;&#20195;&#30721;&#65292;&#24590;&#20040;&#20250;&#36825;&#26679;&#21602;&#65311;&#36807;&#31243; <span class="stt">value-of/k</span> &#22312;&#23614;&#37096;&#36882;&#24402;&#35843;&#29992;
<span class="stt">apply-cont</span>&#65292;<span class="stt">apply-cont</span> &#22312;&#23614;&#37096;&#36882;&#24402;&#35843;&#29992; <span class="stt">apply-procedure/k</span>&#65292;&#25152;&#20197;
<span class="stt">apply-procedure/k</span> &#30340;&#20219;&#20309;&#32467;&#26524;&#37117;&#21487;&#33021;&#25104;&#20026; <span class="stt">value-of/k</span> &#30340;&#32467;&#26524;&#12290;&#32780;&#25105;&#20204;&#20462;&#25913;&#20102;
<span class="stt">apply-procedure/k</span>&#65292;&#23427;&#30340;&#36820;&#22238;&#20540;&#19982;&#20043;&#21069;&#19981;&#21516;&#12290;</p><p>&#25105;&#20204;&#24341;&#20837;<span class="emph">&#24377;&#29699;</span> (<span class="emph"><span class="texMathInline">\mathit{Bounce}</span></span>)&#65292;&#20316;&#20026; <span class="stt">value-of/k</span> &#30340;&#21487;&#33021;&#32467;&#26524;&#65288;&#25105;&#20204;
&#21483;&#23427;&#24377;&#29699;&#65292;&#22240;&#20026;&#23427;&#26159;&#36339;&#24202;&#30340;&#36755;&#20837;&#65289;&#12290;&#36825;&#19968;&#38598;&#21512;&#30340;&#20540;&#26159;&#20160;&#20040;&#21602;&#65311;<span class="stt">value-of/k</span> &#22312;&#23614;&#37096;&#36882;&#24402;
&#35843;&#29992;&#33258;&#36523;&#21644; <span class="stt">apply-cont</span>&#65292;&#36825;&#20123;&#26159;&#23427;&#37324;&#38754;&#25152;&#26377;&#30340;&#23614;&#36882;&#24402;&#12290;&#25152;&#20197;&#33021;&#25104;&#20026; <span class="stt">value-of/k</span>
&#32467;&#26524;&#30340;&#20540;&#21482;&#33021;&#26159; <span class="stt">apply-cont</span> &#30340;&#32467;&#26524;&#12290;&#32780;&#19988;&#65292;<span class="stt">apply-procedure/k</span> &#22312;&#23614;&#37096;&#36882;&#24402;&#35843;
&#29992; <span class="stt">value-of/k</span>&#65292;&#25152;&#20197;&#19981;&#35770; <span class="texMathInline">\mathit{Bounce}</span> &#26159;&#20160;&#20040;&#65292;&#23427;&#26159; <span class="stt">value-of/k</span>&#12289;
<span class="stt">apply-cont</span> &#21644; <span class="stt">apply-procedure/k</span> &#32467;&#26524;&#30340;&#38598;&#21512;&#12290;</p><p>&#36807;&#31243; <span class="stt">value-of/k</span> &#21644; <span class="stt">apply-cont</span> &#21482;&#26159;&#22312;&#23614;&#37096;&#35843;&#29992;&#20854;&#20182;&#36807;&#31243;&#12290;&#30495;&#27491;&#25226;&#20540;&#25918;&#20837;
<span class="texMathInline">\mathit{Bounce}</span> &#20013;&#30340;&#26159; <span class="stt">apply-procedure/k</span>&#12290;&#36825;&#20123;&#26159;&#20160;&#20040;&#26679;&#30340;&#20540;&#21602;&#65311;&#25105;&#20204;&#26469;&#30475;
&#20195;&#30721;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p><div class="SIntrapara">&#24050;&#30693; <span class="stt">apply-procedure/k</span> &#36820;&#22238;&#26080;&#21442;&#25968;&#30340;&#36807;&#31243;&#65292;&#35813;&#36807;&#31243;&#22312;&#35843;&#29992;&#26102;&#36820;&#22238;&#19968;&#20010;
<span class="texMathInline">\mathit{ExpVal}</span>&#65292;&#25110;&#35843;&#29992; <span class="stt">value-of/k</span>&#12289;<span class="stt">apply-cont</span> &#25110;
<span class="stt">apply-procedure/k</span> &#20043;&#19968;&#30340;&#32467;&#26524;&#65292;&#20063;&#23601;&#26159; <span class="texMathInline">\mathit{Bounce}</span>&#12290;&#25152;&#20197;&#65292;
<span class="stt">apply-procedure/k</span> &#21487;&#33021;&#30340;&#21462;&#20540;&#30001;&#22914;&#19979;&#38598;&#21512;&#25551;&#36848;&#65306;
<span class="texMathDisplay">\mathit{ExpVal} \cup (() \to \mathit{Bounce})</span>
</div><div class="SIntrapara"><blockquote class="SubFlow"><p>&#36825;&#21644; <span class="stt">value-of/k</span> &#30340;&#21487;&#33021;&#32467;&#26524;&#30456;&#21516;&#65292;&#25152;&#20197;&#25105;&#20204;&#24471;&#20986;&#32467;&#35770;&#65306;
<span class="texMathDisplay">\mathit{Bounce} = \mathit{ExpVal} \cup (() \to \mathit{Bounce})</span>
&#21512;&#32422;&#20026;&#65306;
<span class="texMathDisplay">\begin{alignedat}{-1}
&amp;<span style="font-weight: bold">value-of-program</span> : \mathit{Program} \to \mathit{FinalAnswer} \\
&amp;<span style="font-weight: bold">trampoline</span> : \mathit{Bounce} \to \mathit{FinalAnswer} \\
&amp;<span style="font-weight: bold">value-of/k</span> : \mathit{Exp} \times \mathit{Env} \times \mathit{Cont} \to \mathit{Bounce} \\
&amp;<span style="font-weight: bold">apply-cont</span> : \mathit{Cont} \times \mathit{ExpVal} \to \mathit{Bounce} \\
&amp;<span style="font-weight: bold">apply-procedure/k</span> : \mathit{Proc} \times \mathit{ExpVal} \times \mathit{FinalAnswer} \to \mathit{Bounce}
\end{alignedat}</span>
<a name="(idx._(gentag._808))"></a></p></blockquote></div></p><p>&#36807;&#31243; <span class="stt">trampoline</span> &#28385;&#36275;&#20854;&#21512;&#32422;&#65306;&#39318;&#20808;&#32473;&#23427;&#20256;&#20837;&#19968;&#20010; <span class="texMathInline">\mathit{Bounce}</span>&#12290;&#22914;&#26524;&#20854;&#21442;
&#25968;&#26159;&#19968;&#20010;<span class="texMathInline">\mathit{ExpVal}</span>&#65288;&#20063;&#26159; <span class="texMathInline">\mathit{FinalAnswer}</span>&#65289;&#65292;&#37027;&#20040;&#36820;&#22238;&#65307;&#21542;&#21017;&#65292;&#21442;
&#25968;&#19968;&#23450;&#26159;&#19968;&#20010;&#36820;&#22238;&#20540;&#20026; <span class="texMathInline">\mathit{Bounce}</span> &#30340;&#36807;&#31243;&#12290;&#25152;&#20197;&#65292;&#23427;&#35843;&#29992;&#36825;&#20010;&#26080;&#21442;&#25968;&#36807;&#31243;&#65292;&#28982;
&#21518;&#35843;&#29992;&#33258;&#36523;&#22788;&#29702;&#20854;&#32467;&#26524;&#65292;&#36820;&#22238;&#20540;&#24635;&#26159;&#19968;&#20010; <span class="texMathInline">\mathit{Bounce}</span>&#65288;&#22312; <a href="types.html#%28part._s7..4%29" data-pltdoc="x">INFERRED&#65306;&#24102;&#26377;&#31867;&#22411;&#25512;&#23548;&#30340;&#35821;&#35328;</a>&#25105;&#20204;&#23558;
&#30475;&#21040;&#22914;&#20309;&#33258;&#21160;&#23436;&#25104;&#36825;&#20010;&#25512;&#29702;&#36807;&#31243;&#65289;&#12290;</p><p><span class="stt">apply-procedure/k</span> &#36820;&#22238;&#30340;&#27599;&#20010;&#26080;&#21442;&#25968;&#36807;&#31243;&#37117;&#34920;&#31034;&#35745;&#31639;&#27969;&#31243;&#20013;&#30340;&#19968;&#20010;&#24555;&#29031;&#12290;&#25105;&#20204;&#21487;&#20197;
&#22312;&#35745;&#31639;&#20013;&#30340;&#19981;&#21516;&#20301;&#32622;&#36820;&#22238;&#36825;&#26679;&#30340;&#24555;&#29031;&#12290;&#22312; <a href="#%28part._s5..5%29" data-pltdoc="x">&#32447;&#31243;</a>&#65292;&#25105;&#20204;&#23558;&#30475;&#21040;&#22914;&#20309;&#29992;&#36825;&#19968;&#24605;&#24819;&#27169;&#25311;
&#22810;&#32447;&#31243;&#31243;&#24207;&#20013;&#30340;&#21407;&#23376;&#25805;&#20316;&#12290;</p><p><div class="SIntrapara"><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="texMathInline">\mathit{Bounce}</span> = <span class="texMathInline">\mathit{ExpVal} \cup (() \to \mathit{Bounce})</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">value-of-program</span></span> : <span class="texMathInline">\mathit{Program} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pgm</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">program</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">trampoline</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">trampoline</span></span> : <span class="texMathInline">\mathit{Bounce} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">trampoline</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bounce</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval?</span><span class="hspace">&nbsp;</span><span class="RktSym">bounce</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">bounce</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">trampoline</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bounce</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">value-of/k</span></span> : <span class="texMathInline">\mathit{Exp} \times \mathit{Env} \times \mathit{Cont} \to \mathit{Bounce}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">apply-cont</span></span> : <span class="texMathInline">\mathit{Cont} \times \mathit{ExpVal} \to \mathit{Bounce}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-procedure/k</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">apply-procedure/k</span></span> : <span class="texMathInline">\mathit{Proc} \times \mathit{ExpVal} \times \mathit{Cont} \to \mathit{Bounce}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="caption"><p>&#29992;&#36807;&#31243;&#34920;&#31034;&#36339;&#24202;
<a name="(idx._(gentag._809))"></a>
<a name="(idx._(gentag._810))"></a><a name="(elem._fig-5..7)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._811))"></a></div></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._812))"></a>
<a name="(idx._(gentag._813))"></a>
<a name="(idx._(gentag._814))"></a></div></p><blockquote class="EoplExercise"><p><a name="(elem._ex5..17)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;&#36339;&#36291;&#24335;&#35299;&#37322;&#22120;&#65292;&#25226;&#25152;&#26377;&#35843;&#29992; <span class="stt">apply-procedure/k</span> &#30340;&#22320;&#26041;&#65288;&#21482;&#26377;&#19968;&#22788;&#65289;&#25918;&#20837;
<span class="stt">(lambda () ...)</span> &#20013;&#12290;&#36825;&#19968;&#20462;&#25913;&#38656;&#35201;&#26356;&#25913;&#21512;&#32422;&#21527;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..18)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._815))"></a>
<a name="(idx._(gentag._816))"></a>
<span class="EoplFigureRef"></span> &#20013;&#30340;&#36339;&#24202;&#31995;&#32479;&#20351;&#29992;&#36807;&#31243;&#34920;&#31034; <span class="texMathInline">\mathit{Bounce}</span>&#12290;&#25913;&#29992;&#25968;&#25454;&#32467;&#26500;
&#34920;&#31034;&#27861;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..19)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#19981;&#35201;&#22312; <span class="stt">apply-procedure/k</span> &#20027;&#20307;&#21608;&#22260;&#25554;&#20837; <span class="stt">(lambda () ...)</span>&#65292;&#25913;&#20026;&#22312;
<span class="stt">apply-cont</span> &#30340;&#20027;&#20307;&#21608;&#22260;&#25554;&#20837;&#12290;&#20462;&#25913;&#21512;&#32422;&#65292;&#20351;&#20043;&#31526;&#21512;&#36825;&#19968;&#26356;&#25913;&#12290;<span class="texMathInline">\mathit{Bounce}</span>
&#30340;&#23450;&#20041;&#38656;&#35201;&#20462;&#25913;&#21527;&#65311;&#28982;&#21518;&#65292;&#29992;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#27861;&#26367;&#25442;&#36807;&#31243;&#34920;&#31034;&#27861;&#34920;&#31034; <span class="texMathInline">\mathit{Bounce}</span>&#65292;
&#20687;<span class="EoplExerciseRef"></span> &#37027;&#26679;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..20)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22312;<span class="EoplExerciseRef"></span> &#20013;&#65292;<span class="stt">trampoline</span> &#36820;&#22238; <span class="texMathInline">\mathit{FinalAnswer}</span> &#20043;&#21069;&#30340;
&#26368;&#21518;&#19968;&#39063;&#24377;&#29699;&#24418;&#22914; <span class="stt">(apply-cont (end-cont) </span><span class="texMathInline">val</span><span class="stt">)</span>&#65292;&#20854;&#20013;&#65292;<span class="texMathInline">val</span> &#26159;
<span class="texMathInline">\mathit{ExpVal}</span>&#12290;&#21033;&#29992;&#36825;&#19968;&#28857;&#20248;&#21270;<span class="EoplExerciseRef"></span> &#20013;&#24377;&#29699;&#30340;&#34920;&#31034;&#12290;
<a name="(idx._(gentag._817))"></a>
<a name="(idx._(gentag._818))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..21)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#29992;&#26222;&#36890;&#30340;&#36807;&#31243;&#24335;&#35821;&#35328;&#23454;&#29616;&#36339;&#36291;&#24335;&#35299;&#37322;&#22120;&#12290;&#29992;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#24555;&#29031;&#65292;
&#25226; <span class="stt">trampoline</span> &#20013;&#23545;&#33258;&#36523;&#30340;&#36882;&#24402;&#35843;&#29992;&#26367;&#25442;&#20026;&#26222;&#36890;&#30340; <span class="stt">while</span> &#25110;&#20854;&#23427;&#24490;&#29615;&#32467;&#26500;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..22)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._819))"></a>
&#26377;&#20154;&#21487;&#33021;&#24819;&#29992;&#26222;&#36890;&#30340;&#36807;&#31243;&#24335;&#35821;&#35328;&#36716;&#35793;<a href="expr.html" data-pltdoc="x">&#34920;&#36798;&#24335;</a>&#20013;&#20256;&#36882;&#29615;&#22659;&#30340;&#35299;&#37322;&#22120;&#12290;&#21516;&#26679;&#26159;&#22240;
&#20026;<a href="#%28elem._imper-reason%29" data-pltdoc="x">&#19978;&#36848;</a>&#21407;&#22240;&#65292;&#38500;&#20102;&#26368;&#31616;&#21333;&#30340;&#24773;&#20917;&#65292;&#36825;&#31181;&#36716;&#25442;&#37117;&#20250;&#22833;&#36133;&#12290;&#36339;&#36291;&#25216;
&#26415;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#20063;&#26377;&#25928;&#21527;&#65311;</p></blockquote><h4>5.3<tt>&nbsp;</tt><a name="(part._s5..3)"></a>&#25351;&#20196;&#24335;&#35299;&#37322;&#22120;</h4><p><a name="(idx._(gentag._820))"></a>
<a name="(idx._(gentag._821))"></a>
&#22312;<a href="state.html" data-pltdoc="x">&#29366;&#24577;</a>&#20013;&#25105;&#20204;&#30475;&#21040;&#65292;&#32473;&#20849;&#20139;&#21464;&#37327;&#36171;&#20540;&#26377;&#26102;&#21487;&#20197;&#26367;&#20195;&#32465;&#23450;&#12290;
&#32771;&#34385;<span class="EoplFigureRef"></span> &#39030;&#37096;&#30340;&#32769;&#20363;&#23376; <span class="stt">even</span> &#21644; <span class="stt">odd</span>&#12290;
<a name="(idx._(gentag._822))"></a><a name="(idx._(gentag._823))"></a></p><p>&#21487;&#20197;&#29992;<span class="EoplFigureRef"></span> &#20013;&#38388;&#30340;&#31243;&#24207;&#26367;&#20195;&#23427;&#20204;&#12290;&#20854;&#20013;&#65292;&#20849;&#20139;&#21464;&#37327; <span class="stt">x</span> &#20379;&#20004;&#20010;&#36807;&#31243;
&#20132;&#25442;&#20449;&#24687;&#12290;&#22312;&#39030;&#37096;&#30340;&#20363;&#23376;&#20013;&#65292;&#36807;&#31243;&#20027;&#20307;&#22312;&#29615;&#22659;&#20013;&#26597;&#25214;&#30456;&#20851;&#25968;&#25454;&#65307;&#22312;&#21478;&#19968;&#20010;&#31243;&#24207;&#20013;&#65292;&#23427;&#20204;&#20174;&#23384;
&#20648;&#22120;&#20013;&#26597;&#25214;&#30456;&#20851;&#25968;&#25454;&#12290;</p><p>&#32771;&#34385;<span class="EoplFigureRef"></span> &#24213;&#37096;&#30340;&#35745;&#31639;&#36319;&#36394;&#26085;&#24535;&#12290;&#23427;&#21487;&#33021;&#26159;&#20108;&#32773;&#20013;&#20219;&#19968;&#35745;&#31639;&#36319;&#36394;&#26085;&#24535;&#12290;&#24403;
&#25105;&#20204;&#35760;&#24405;&#35843;&#29992;&#30340;&#36807;&#31243;&#21644;&#23454;&#21442;&#26102;&#65292;&#23427;&#26159;&#31532;&#19968;&#20010;&#35745;&#31639;&#30340;&#36319;&#36394;&#26085;&#24535;&#65307;&#24403;&#25105;&#20204;&#35760;&#24405;&#35843;&#29992;&#30340;&#36807;&#31243;&#21644;&#23492;&#23384;
&#22120; <span class="stt">x</span> &#30340;&#20540;&#26102;&#65292;&#23427;&#26159;&#31532;&#20108;&#20010;&#35745;&#31639;&#30340;&#36319;&#36394;&#26085;&#24535;&#12290;</p><p>&#32780;&#24403;&#25105;&#20204;&#35760;&#24405;&#31243;&#24207;&#35745;&#25968;&#22120;&#30340;&#20301;&#32622;&#21644;&#23492;&#23384;&#22120; <span class="stt">x</span> &#30340;&#20869;&#23481;&#26102;&#65292;&#36825;&#21448;&#21487;&#20197;&#35299;&#37322;&#20026;
<a name="(idx._(gentag._824))"></a>
<span class="emph">goto</span>&#65288;&#21517;&#20026;<span class="emph">&#27969;&#31243;&#22270;&#31243;&#24207;</span> (<span class="emph">flowchart program</span>)&#65289;&#30340;&#36319;&#36394;&#26085;&#24535;&#12290;</p><blockquote class="EoplFigure"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">even(x) = if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else (odd sub1(x))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">odd(x) = if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else (even sub1(x))</span></p></td></tr><tr><td><p><span class="stt">in (odd 13)</span></p></td></tr></table></blockquote><p><span class="texMathInline">\rule{\linewidth}{1pt}</span></p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let x = 0</span></p></td></tr><tr><td><p><span class="stt">in letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">even() = if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else let d = set x = sub1(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (odd)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">odd() = if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else let d = set x = sub1(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (even)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let d = set x = 13</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (odd)</span></p></td></tr></table></blockquote><p><span class="texMathInline">\rule{\linewidth}{0.5pt}</span></p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">x = 13;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">goto odd;</span></p></td></tr><tr><td><p><span class="stt">even: if (x=0) then return(1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else {x = x-1;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">goto odd;}</span></p></td></tr><tr><td><p><span class="stt">odd:</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">if (x=0) then return(0)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else {x = x-1;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">goto even;}</span></p></td></tr></table></blockquote><p><span class="texMathInline">\rule{\linewidth}{0.5pt}</span></p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(odd 13)</span></p></td></tr><tr><td><p><span class="stt">= (even 12)</span></p></td></tr><tr><td><p><span class="stt">= (odd 11)</span></p></td></tr><tr><td><p><span class="stt">...</span></p></td></tr><tr><td><p><span class="stt">= (odd 1)</span></p></td></tr><tr><td><p><span class="stt">= (even 0)</span></p></td></tr><tr><td><p><span class="stt">= 1</span></p></td></tr></table></blockquote><blockquote class="caption"><p>&#36319;&#36394;&#26085;&#24535;&#30456;&#21516;&#30340;&#19977;&#20010;&#31243;&#24207;<a name="(elem._fig-5..8)"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._825))"></a>
<a name="(idx._(gentag._826))"></a>
&#33021;&#22914;&#27492;&#65292;&#21482;&#26159;&#22240;&#20026;&#21407;&#20195;&#30721;&#20013; <span class="stt">even</span> &#21644; <span class="stt">odd</span> &#30340;&#35843;&#29992;&#19981;&#25193;&#22823;&#25511;&#21046;&#19978;&#19979;&#25991;&#65306;&#23427;&#20204;&#26159;&#23614;
&#35843;&#29992;&#12290;&#25105;&#20204;&#19981;&#33021;&#36825;&#26679;&#36716;&#25442; <span class="stt">fact</span>&#65292;&#22240;&#20026; <span class="stt">fact</span> &#30340;&#36319;&#36394;&#26085;&#24535;&#26080;&#38480;&#22686;&#38271;&#65306;
&#8220;&#31243;&#24207;&#35745;&#25968;&#22120;&#8221;&#19981;&#26159;&#20687;&#36825;&#37324;&#19968;&#26679;&#20986;&#29616;&#22312;&#36319;&#36394;&#26085;&#24535;&#30340;&#26368;&#22806;&#23618;&#65292;&#32780;
&#26159;&#20986;&#29616;&#22312;&#25511;&#21046;&#19978;&#19979;&#25991;&#20013;&#12290;</p><p>&#20219;&#20309;&#19981;&#38656;&#35201;&#25511;&#21046;&#19978;&#19979;&#25991;&#30340;&#31243;&#24207;&#37117;&#21487;&#20197;&#36825;&#26679;&#36716;&#25442;&#12290;&#36825;&#32473;&#20102;&#25105;&#20204;&#19968;&#26465;&#37325;&#35201;&#21407;&#29702;&#65306;</p><blockquote class="Tip"><blockquote class="SCentered"><p><span style="font-weight: bold">&#26080;&#21442;&#25968;&#30340;&#23614;&#35843;&#29992;&#31561;&#21516;&#20110;&#36339;&#36716;&#12290;
<a name="(idx._(gentag._827))"></a></span></p></blockquote></blockquote><p>&#22914;&#26524;&#19968;&#32452;&#36807;&#31243;&#21482;&#36890;&#36807;&#23614;&#35843;&#29992;&#20114;&#30456;&#35843;&#29992;&#65292;&#37027;&#20040;&#25105;&#20204;&#21487;&#20197;&#20687;&#20687;<span class="EoplFigureRef"></span> &#37027;&#26679;&#65292;&#32763;
&#35793;&#31243;&#24207;&#65292;&#29992;&#36171;&#20540;&#20195;&#26367;&#32465;&#23450;&#65292;&#28982;&#21518;&#25226;&#36171;&#20540;&#31243;&#24207;&#36716;&#35793;&#20026;&#27969;&#31243;&#22270;&#31243;&#24207;&#12290;</p><p>&#26412;&#33410;&#65292;&#25105;&#20204;&#29992;&#36825;&#19968;&#21407;&#29702;&#32763;&#35793;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#65292;&#23558;&#20854;&#36716;&#25442;&#20026;&#36866;&#21512;&#26080;&#39640;&#38454;&#36807;&#31243;&#35821;&#35328;&#30340;&#24418;&#24335;&#12290;</p><p>&#25105;&#20204;&#39318;&#20808;&#20174;<span class="EoplFigureRef"></span> &#21644; <span class="stt">fig-5.5</span> &#20013;&#30340;&#35299;&#37322;&#22120;&#24320;&#22987;&#65292;&#29992;&#25968;&#25454;&#32467;&#26500;
&#34920;&#31034;&#32493;&#25991;&#12290;&#32493;&#25991;&#30340;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#22914;<span class="EoplFigureRef"></span> &#21644; <span class="stt">fig-5.10</span> &#25152;&#31034;&#12290;</p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-datatype</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">identifier?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">environment?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-test-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">environment?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">environment?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff2-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">expval?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">environment?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">expval?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p>&#29992;&#25968;&#25454;&#32467;&#26500;&#23454;&#29616;&#30340;&#32493;&#25991;&#65288;&#31532;1&#37096;&#20998;&#65289;
<a name="(idx._(gentag._828))"></a>
<a name="(idx._(gentag._829))"></a><a name="(elem._fig-5..9)"></a></p></blockquote></blockquote><p>&#25105;&#20204;&#30340;&#31532;&#19968;&#20010;&#20219;&#21153;&#26159;&#21015;&#20986;&#38656;&#35201;&#36890;&#36807;&#20849;&#20139;&#23492;&#23384;&#22120;&#36890;&#20449;&#30340;&#36807;&#31243;&#12290;&#36825;&#20123;&#36807;&#31243;&#21450;&#20854;&#24418;&#21442;&#20026;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-procedure/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">proc1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote></blockquote><p>&#25152;&#20197;&#25105;&#20204;&#38656;&#35201;&#20116;&#20010;&#23492;&#23384;&#22120;&#65306;<span class="stt">exp</span>&#12289;<span class="stt">env</span>&#12289;<span class="stt">cont</span>&#12289;<span class="stt">val</span> &#21644; <span class="stt">proc1</span>&#12290;
&#19978;&#38754;&#30340;&#19977;&#20010;&#36807;&#31243;&#21508;&#25913;&#20026;&#19968;&#20010;&#26080;&#21442;&#25968;&#36807;&#31243;&#65292;&#27599;&#20010;&#23454;&#21442;&#30340;&#20540;&#23384;&#20837;&#23545;&#24212;&#30340;&#23492;&#23384;&#22120;&#65292;&#35843;&#29992;&#26080;&#21442;&#25968;&#36807;&#31243;&#65292;
&#25442;&#25481;&#19978;&#36848;&#36807;&#31243;&#30340;&#35843;&#29992;&#12290;&#25152;&#20197;&#65292;&#36825;&#27573;&#20195;&#30721;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#21487;&#20197;&#26367;&#25442;&#20026;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">apply-cont</span></span> : <span class="texMathInline">\mathit{Cont} \times \mathit{ExpVal} \to \mathit{Bounce}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eopl:printf</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"&#35745;&#31639;&#32467;&#26463;.~%"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero1-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bool-val</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-test-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;bool</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff1-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff2-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff2-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">num1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">num1</span><span class="hspace">&nbsp;</span><span class="RktSym">num2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-procedure/k</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p>&#29992;&#25968;&#25454;&#32467;&#26500;&#23454;&#29616;&#30340;&#32493;&#25991;&#65288;&#31532;2&#37096;&#20998;&#65289;
<a name="(idx._(gentag._830))"></a>
<a name="(idx._(gentag._831))"></a><a name="(elem._fig-5..10)"></a></p></blockquote></blockquote><p>&#29616;&#22312;&#65292;&#25105;&#20204;&#20381;&#27425;&#36716;&#25442;&#22235;&#20010;&#36807;&#31243;&#12290;&#25105;&#20204;&#36824;&#35201;&#20462;&#25913; <span class="stt">value-of-program</span> &#30340;&#20027;&#20307;&#65292;&#22240;&#20026;&#37027;&#26159;
&#26368;&#21021;&#35843;&#29992; <span class="stt">value-of/k</span>&#30340;&#22320;&#26041;&#12290;&#21482;&#26377;&#19977;&#28857;&#23567;&#40635;&#28902;&#65306;</p><ol><li><p>&#23384;&#20648;&#22120;&#22312;&#36807;&#31243;&#35843;&#29992;&#20043;&#38388;&#24448;&#24448;&#20445;&#25345;&#19981;&#21464;&#12290;&#36825;&#23545;&#24212;&#19978;&#20363;&#20013;&#30340;&#36171;&#20540; <span class="stt">(set! cont
cont)</span>&#12290;&#25105;&#20204;&#22823;&#21487;&#31227;&#38500;&#36825;&#26679;&#30340;&#36171;&#20540;&#12290;</p></li><li><p>&#25105;&#20204;&#24517;&#39035;&#30830;&#20445; <span class="stt">cases</span> &#34920;&#36798;&#24335;&#20013;&#30340;&#23383;&#27573;&#19981;&#19982;&#23492;&#23384;&#22120;&#37325;&#21517;&#12290;&#21542;&#21017;&#23383;&#27573;&#20250;&#36974;&#34109;&#23492;&#23384;
&#22120;&#65292;&#23492;&#23384;&#22120;&#23601;&#26080;&#27861;&#35775;&#38382;&#20102;&#12290;&#20363;&#22914;&#65292;&#22312; <span class="stt">value-of-program</span> &#20013;&#65292;&#22914;&#26524;&#25105;&#20204;&#20889;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">program</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">pgn</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#37027;&#20040; <span class="stt">exp</span> &#32465;&#23450;&#21040;&#23616;&#37096;&#21464;&#37327;&#65292;&#25105;&#20204;&#26080;&#27861;&#32473;&#20840;&#23616;&#23492;&#23384;&#22120; <span class="stt">exp</span> &#36171;&#20540;&#12290;&#35299;&#20915;&#26041;&#27861;&#26159;&#37325;
&#21629;&#21517;&#23616;&#37096;&#21464;&#37327;&#65292;&#36991;&#20813;&#20914;&#31361;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">program</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">pgn</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#28982;&#21518;&#65292;&#21487;&#20197;&#20889;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">program</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">pgn</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#25105;&#20204;&#24050;&#20180;&#32454;&#25361;&#36873;&#25968;&#25454;&#31867;&#22411;&#20013;&#30340;&#23383;&#27573;&#21517;&#65292;&#36991;&#20813;&#36825;&#31181;&#20914;&#31361;&#12290;</p></li><li><p>&#19968;&#27425;&#35843;&#29992;&#20013;&#22914;&#26524;&#20004;&#27425;&#20351;&#29992;&#21516;&#19968;&#23492;&#23384;&#22120;&#65292;&#21448;&#20250;&#36896;&#25104;&#19968;&#28857;&#40635;&#28902;&#12290;&#32771;&#34385;&#36716;&#25442; <span class="stt">(cons (f
(car x)) (f (cdr x)))</span> &#20013;&#30340;&#31532;&#19968;&#20010;&#35843;&#29992;&#65292;&#20854;&#20013;&#65292;<span class="stt">x</span> &#26159; <span class="stt">f</span> &#30340;&#24418;&#21442;&#12290;&#19981;&#20570;&#36807;&#22810;
&#32771;&#34385;&#30340;&#35805;&#65292;&#36825;&#20010;&#35843;&#29992;&#21487;&#20197;&#36716;&#25442;&#20026;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">arg1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#20294;&#36825;&#26159;&#19981;&#23545;&#30340;&#65292;&#22240;&#20026;&#23427;&#32473;&#23492;&#23384;&#22120; <span class="stt">x</span> &#36171;&#20102;&#26032;&#20540;&#65292;&#20294; <span class="stt">x</span> &#21407;&#20808;&#30340;&#20540;&#36824;&#26377;&#29992;&#12290;&#35299;&#20915;&#26041;
&#27861;&#26159;&#35843;&#25972;&#36171;&#20540;&#39034;&#24207;&#65292;&#25226;&#27491;&#30830;&#30340;&#20540;&#25918;&#20837;&#23492;&#23384;&#22120;&#20013;&#65292;&#25110;&#32773;&#20351;&#29992;&#20020;&#26102;&#21464;&#37327;&#12290;&#22823;&#22810;&#24773;&#20917;&#19979;&#65292;&#35201;&#36991;&#20813;
&#36825;&#31181;&#38382;&#39064;&#65292;&#21487;&#20197;&#20808;&#32473;&#32493;&#25991;&#21464;&#37327;&#36171;&#20540;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">arg1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#26377;&#26102;&#20020;&#26102;&#21464;&#37327;&#26080;&#27861;&#36991;&#20813;&#65307;&#32771;&#34385; <span class="stt">(f y x)</span>&#65292;&#20854;&#20013; <span class="stt">x</span> &#21644; <span class="stt">y</span> &#26159; <span class="stt">f</span> &#30340;&#24418;&#21442;&#12290;
&#25105;&#20204;&#30340;&#20363;&#23376;&#20013;&#36824;&#26410;&#36935;&#21040;&#36825;&#31181;&#40635;&#28902;&#12290;</p></li></ol><p>&#32763;&#35793;&#23436;&#30340;&#35299;&#37322;&#22120;&#22914;<span class="EoplFigureRef"></span>&ndash;<span class="stt">fig-5.14</span> &#25152;&#31034;&#12290;&#36825;&#20010;&#36807;&#31243;
&#21483;&#20570;<span class="emph">&#23492;&#23384;</span> (<span class="emph">registerization</span>)&#12290;&#24456;&#23481;&#26131;&#29992;&#25903;&#25345;&#36339;&#36716;&#30340;&#25351;&#20196;&#24335;&#35821;&#35328;&#32763;&#35793;&#23427;&#12290;
<a name="(idx._(gentag._832))"></a>
<a name="(idx._(gentag._833))"></a></p><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">value-of-program</span></span> : <span class="texMathInline">\mathit{Program} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pgm</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">program</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">value-of/k</span></span> : <span class="texMathInline">\mathit{()} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span style="font-weight: bold">&#29992;&#27861;</span> : &#20381;&#36182;&#23492;&#23384;&#22120;</td></tr><tr><td><span class="stt">exp</span> : <span class="texMathInline">\mathit{Exp}</span></td></tr><tr><td><span class="stt">env</span> : <span class="texMathInline">\mathit{Env}</span></td></tr><tr><td><span class="stt">cont</span> : <span class="texMathInline">\mathit{Cont}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letrec-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p-name</span><span class="hspace">&nbsp;</span><span class="RktSym">b-var</span><span class="hspace">&nbsp;</span><span class="RktSym">p-body</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env-rec</span><span class="hspace">&nbsp;</span><span class="RktSym">p-name</span><span class="hspace">&nbsp;</span><span class="RktSym">b-var</span><span class="hspace">&nbsp;</span><span class="RktSym">p-body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>\begin{comment}<span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td>\end{comment}
\smallskip</td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="caption"><p>&#25351;&#20196;&#24335;&#35299;&#37322;&#22120;&#65288;&#31532;1&#37096;&#20998;&#65289;
<a name="(idx._(gentag._834))"></a><a name="(elem._fig-5..11)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._835))"></a></div></p></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td>\smallskip
\begin{comment}</td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">(</span></td></tr><tr><td>\end{comment}</td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-test-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">call-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">rand</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">rator</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="caption"><p>&#25351;&#20196;&#24335;&#35299;&#37322;&#22120;&#65288;&#31532;2&#37096;&#20998;&#65289;
<a name="(idx._(gentag._836))"></a><a name="(elem._fig-5..12)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._837))"></a></div></p></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">apply-cont</span></span> : <span class="texMathInline">\mathit{()} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span style="font-weight: bold">&#29992;&#27861;</span> : &#35835;&#21462;&#23492;&#23384;&#22120;</td></tr><tr><td><span class="stt">cont</span> : <span class="texMathInline">\mathit{Cont}</span></td></tr><tr><td><span class="stt">val</span> : <span class="texMathInline">\mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eopl:printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"&#35745;&#31639;&#32467;&#26463;.~%"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero1-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bool-val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-test-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;bool</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>\begin{comment}<span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td>\end{comment}
\smallskip</td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="caption"><p>&#25351;&#20196;&#24335;&#35299;&#37322;&#22120;&#65288;&#31532;3&#37096;&#20998;&#65289;
<a name="(idx._(gentag._838))"></a><a name="(elem._fig-5..13)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._839))"></a></div></p></blockquote><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td>\smallskip
\begin{comment}</td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">(</span></td></tr><tr><td>\end{comment}</td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff1-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff2-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff2-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">num1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;num</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">num1</span><span class="hspace">&nbsp;</span><span class="RktSym">num2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">rand</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator-val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">rator-proc</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span><span class="hspace">&nbsp;</span><span class="RktSym">rator-val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">rator-proc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-procedure/k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">apply-procedure/k</span></span> : <span class="texMathInline">\mathit{()} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span style="font-weight: bold">&#29992;&#27861;</span> : &#20381;&#36182;&#23492;&#23384;&#22120;</td></tr><tr><td><span class="stt">proc1</span> : <span class="texMathInline">\mathit{Proc}</span></td></tr><tr><td><span class="stt">val</span> : <span class="texMathInline">\mathit{ExpVal}</span></td></tr><tr><td><span class="stt">cont</span> : <span class="texMathInline">\mathit{Cont}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="caption"><p>&#25351;&#20196;&#24335;&#35299;&#37322;&#22120;&#65288;&#31532;4&#37096;&#20998;&#65289;
<a name="(idx._(gentag._840))"></a><a name="(elem._fig-5..14)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._841))"></a></div></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..23)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22914;&#26524;&#21024;&#21435;&#35299;&#37322;&#22120;&#26576;&#19968;&#20998;&#25903;&#20013;&#30340;&#8220;goto&#8221;&#20250;&#24590;&#26679;&#65311;&#35299;&#37322;&#22120;&#20250;&#20986;&#20160;
&#20040;&#38169;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..24)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#35774;&#35745;&#19968;&#20123;&#20363;&#23376;&#65292;&#35299;&#37322;&#19978;&#25991;&#25552;&#21040;&#30340;&#27599;&#20010;&#40635;&#28902;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..25)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._842))"></a>
&#23492;&#23384;&#25903;&#25345;&#22810;&#21442;&#25968;&#36807;&#31243;&#30340;&#35299;&#37322;&#22120;&#65288;<span class="EoplExerciseRef"></span>&#65289;&#12290;
<a name="(idx._(gentag._843))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..26)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._844))"></a>
&#29992;&#36339;&#24202;&#36716;&#25442;&#36825;&#20010;&#35299;&#37322;&#22120;&#65292;&#29992; <span class="stt">(set! pc apply-procedure/k)</span> &#26367;&#25442;
<span class="stt">apply-procedure/k</span> &#30340;&#35843;&#29992;&#65292;&#24182;&#20351;&#29992;&#19979;&#38754;&#36825;&#26679;&#30340;&#39537;&#21160;&#22120;&#65306;</p><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">trampoline</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktSym">pc</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">trampoline</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pc</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._845))"></a></div></p></blockquote></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..27)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#35774;&#35745;&#19968;&#20010;&#35821;&#35328;&#29305;&#24615;&#65292;&#23548;&#33268;&#26368;&#21518;&#32473; <span class="stt">cont</span> &#36171;&#20540;&#26102;&#65292;&#24517;&#39035;&#29992;&#20020;&#26102;&#21464;&#37327;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..28)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;&#26412;&#33410;&#30340;&#35299;&#37322;&#22120;&#28155;&#21152;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#36741;&#21161;&#32452;&#20214;&#12290;&#30001;&#20110;&#32493;&#25991;&#34920;&#31034;&#26041;&#24335;&#30456;&#21516;&#65292;&#21487;&#20197;
&#22797;&#29992;&#37027;&#37324;&#30340;&#20195;&#30721;&#12290;&#39564;&#35777;&#26412;&#33410;&#30340;&#25351;&#20196;&#24335;&#35299;&#37322;&#22120;&#29983;&#25104;&#30340;&#36319;&#36394;&#26085;&#24535;&#19982;<span class="EoplExerciseRef"></span> &#20013;&#30340;
&#35299;&#37322;&#22120;<span class="emph">&#23436;&#20840;</span>&#30456;&#21516;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..29)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._846))"></a>
&#36716;&#25442;&#26412;&#33410;&#30340; <span class="stt">fact-iter</span>&#65288;<span class="stt">fact-iter</span>&#65289;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..30)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._847))"></a>
<a name="(idx._(gentag._848))"></a>
<a name="(idx._(gentag._849))"></a>
<a name="(idx._(gentag._850))"></a>
<a name="(idx._(gentag._851))"></a>
<a name="(idx._(gentag._852))"></a>
<a name="(idx._(gentag._853))"></a>
&#20462;&#25913;&#26412;&#33410;&#30340;&#35299;&#37322;&#22120;&#65292;&#35753;&#36807;&#31243;&#20351;&#29992;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#21160;&#24577;&#32465;&#23450;&#12290;&#25552;&#31034;&#65306;&#20687;&#26412;&#31456;&#36825;&#26679;
&#36716;&#25442;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#35299;&#37322;&#22120;&#65307;&#20108;&#32773;&#19981;&#21516;&#30340;&#37096;&#20998;&#36716;&#25442;&#21518;&#25165;&#20250;&#19981;&#21516;&#12290;
&#20687;<span class="EoplExerciseRef"></span> &#37027;&#26679;&#32473;&#35299;&#37322;&#22120;&#28155;&#21152;&#36741;&#21161;&#32452;&#20214;&#12290;&#35266;&#23519;&#21487;&#30693;&#65292;&#23601;&#20687;&#24403;&#21069;&#29366;&#24577;&#20013;&#21482;&#26377;&#19968;
&#20010;&#32493;&#25991;&#65292;&#24403;&#21069;&#29366;&#24577;&#21482;&#20250;&#21387;&#20837;&#25110;&#24377;&#20986;&#19968;&#20010;&#29615;&#22659;&#65292;&#32780;&#19988;&#29615;&#22659;&#19982;&#32493;&#25991;&#21516;&#26102;&#21387;&#20837;&#25110;&#24377;&#20986;&#12290;&#30001;&#27492;&#25105;&#20204;&#24471;
&#20986;&#32467;&#35770;&#65292;&#21160;&#24577;&#32465;&#23450;&#20855;&#26377;<span class="emph">&#21160;&#24577;&#26399;&#38480;</span> (<span class="emph">dynamic extent</span>)&#65306;&#21363;&#65292;&#24418;&#21442;&#30340;&#32465;&#23450;&#20445;&#30041;
&#21040;&#36807;&#31243;&#36820;&#22238;&#20026;&#27490;&#12290;&#35789;&#27861;&#32465;&#23450;&#21017;&#19982;&#20043;&#19981;&#21516;&#65292;&#32465;&#23450;&#21253;&#35065;&#22312;&#38381;&#21253;&#20869;&#26102;&#21487;&#20197;&#26080;&#38480;&#26399;&#22320;&#20445;&#30041;&#12290;
<a name="(idx._(gentag._854))"></a>
<a name="(idx._(gentag._855))"></a>
<a name="(idx._(gentag._856))"></a>
<a name="(idx._(gentag._857))"></a>
<a name="(idx._(gentag._858))"></a>
<a name="(idx._(gentag._859))"></a>
<a name="(idx._(gentag._860))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..31)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#28155;&#21152;&#20840;&#23616;&#23492;&#23384;&#22120;&#65292;&#25490;&#38500;&#26412;&#33410;&#20195;&#30721;&#20013;&#21097;&#20313;&#30340; <span class="stt">let</span> &#34920;&#36798;&#24335;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..32)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25913;&#36827;&#21069;&#19968;&#39064;&#30340;&#35299;&#31572;&#65292;&#23613;&#21487;&#33021;&#20943;&#23569;&#20840;&#23616;&#23492;&#23384;&#22120;&#30340;&#25968;&#37327;&#12290;&#19981;&#21040; 5 &#20010;&#23601;&#21487;&#20197;&#12290;&#38500;&#20102;&#26412;&#33410;&#35299;&#37322;&#22120;&#20013;
&#24050;&#32463;&#29992;&#21040;&#30340;&#65292;&#19981;&#35201;&#20351;&#29992;&#20854;&#20182;&#25968;&#25454;&#32467;&#26500;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..33)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._861))"></a>
&#25226;&#26412;&#33410;&#30340;&#35299;&#37322;&#22120;&#32763;&#35793;&#20026;&#25351;&#20196;&#24335;&#35821;&#35328;&#12290;&#20570;&#20004;&#27425;&#65292;&#19968;&#27425;&#20351;&#29992;&#23487;&#20027;&#35821;&#35328;&#20013;&#30340;&#26080;&#21442;&#25968;&#36807;&#31243;&#35843;&#29992;&#65292;&#19968;&#27425;
&#20351;&#29992; <span class="stt">goto</span>&#12290;&#35745;&#31639;&#37327;&#22686;&#21152;&#26102;&#65292;&#36825;&#20108;&#32773;&#24615;&#33021;&#22914;&#20309;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..34)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22914;<span class="stt">imperative-lang</span>&#25152;&#36848;&#65292;&#29992;&#22823;&#22810;&#25968;&#25351;&#20196;&#24335;&#35821;&#35328;&#37117;&#38590;&#20197;&#23436;&#25104;&#36825;&#31181;&#32763;&#35793;&#65292;&#22240;&#20026;&#23427;&#20204;
&#22312;&#25152;&#26377;&#36807;&#31243;&#35843;&#29992;&#20013;&#20351;&#29992;&#22534;&#26632;&#65292;&#21363;&#20351;&#26159;&#23614;&#35843;&#29992;&#12290;&#32780;&#19988;&#65292;&#23545;&#22823;&#22411;&#35299;&#37322;&#22120;&#65292;&#30001; <span class="stt">goto</span> &#38142;&#25509;&#30340;
&#20195;&#30721;&#21487;&#33021;&#22826;&#36807;&#24222;&#22823;&#65292;&#20197;&#33268;&#26576;&#20123;&#32534;&#35793;&#22120;&#26080;&#27861;&#22788;&#29702;&#12290;&#25226;&#26412;&#33410;&#30340;&#35299;&#37322;&#22120;&#32763;&#35793;&#20026;&#25351;&#20196;&#24335;&#35821;&#35328;&#65292;
&#29992;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#36339;&#36291;&#25216;&#26415;&#35268;&#36991;&#36825;&#19968;&#38590;&#39064;&#12290;</p></blockquote><h4>5.4<tt>&nbsp;</tt><a name="(part._s5..4)"></a>&#24322;&#24120;</h4><p><a name="(idx._(gentag._862))"></a>
<a name="(idx._(gentag._863))"></a>
&#36804;&#20170;&#20026;&#27490;&#65292;&#25105;&#20204;&#21482;&#29992;&#32493;&#25991;&#31649;&#29702;&#35821;&#35328;&#20013;&#30340;&#26222;&#36890;&#25511;&#21046;&#27969;&#12290;&#20294;&#26159;&#32493;&#25991;&#36824;&#33021;&#35753;&#25105;&#20204;&#20462;&#25913;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;&#35753;
&#25105;&#20204;&#26469;&#32473;&#25105;&#20204;&#30340;&#35821;&#35328;&#28155;&#21152;<span class="emph">&#24322;&#24120;&#22788;&#29702;</span> (<span class="emph">exception handling</span>)&#12290;&#25105;&#20204;&#32473;&#35821;&#35328;&#26032;
&#22686;&#20004;&#20010;&#29983;&#25104;&#24335;&#65306;</p><blockquote class="Small"><p><span class="Iidentity">\begin{align*}\mathit{Expression} &amp;::= <span class="stt">try </span><span class="Iidentity">\mathit{Expression}</span><span class="stt"> catch (</span><span class="Iidentity">\mathit{Identifier}</span><span class="stt">) </span><span class="Iidentity">\mathit{Expression}</span> \\[-3pt]
  &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">try-exp (exp1 var handler-exp)</span>} \\[5pt]
\mathit{Expression} &amp;::= <span class="stt">raise </span><span class="Iidentity">\mathit{Expression}</span> \\[-3pt]
  &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">raise-exp (exp)</span>}\end{align*}</span></p></blockquote><p><span class="stt">try</span> &#34920;&#36798;&#24335;&#22312; <span class="stt">catch</span> &#20174;&#21477;&#25551;&#36848;&#30340;&#24322;&#24120;&#22788;&#29702;&#19978;&#19979;&#25991;&#20013;&#27714;&#31532;&#19968;&#20010;&#21442;&#25968;&#30340;&#20540;&#12290;&#22914;&#26524;&#35813;
&#34920;&#36798;&#24335;&#27491;&#24120;&#36820;&#22238;&#65292;&#23427;&#30340;&#20540;&#23601;&#26159;&#25972;&#20010; <span class="stt">try</span> &#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#24322;&#24120;&#22788;&#29702;&#22120;&#65288;&#21363;
<span class="stt">handler-exp</span>&#65289;&#21017;&#34987;&#31227;&#38500;&#12290;</p><p><span class="stt">raise</span> &#34920;&#36798;&#24335;&#27714;&#20986;&#21442;&#25968;&#30340;&#20540;&#65292;&#20197;&#35813;&#20540;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290;&#36825;&#20010;&#20540;&#20250;&#20256;&#32473;&#26368;&#25509;&#36817;&#30340;&#24322;&#24120;&#22788;&#29702;
&#22120;&#65292;&#24182;&#32465;&#23450;&#21040;&#36825;&#20010;&#22788;&#29702;&#22120;&#30340;&#21464;&#37327;&#12290;&#28982;&#21518;&#65292;&#22788;&#29702;&#22120;&#20027;&#20307;&#23558;&#34987;&#27714;&#20540;&#12290;&#22788;&#29702;&#22120;&#20027;&#20307;&#21487;&#20197;&#36820;&#22238;&#19968;&#20010;&#20540;&#65292;
&#36825;&#20010;&#20540;&#31216;&#20026;&#23545;&#24212; <span class="stt">try</span> &#34920;&#36798;&#24335;&#30340;&#20540;&#65307;&#25110;&#32773;&#65292;&#23427;&#21487;&#20197;&#25243;&#20986;&#21478;&#19968;&#20010;&#24322;&#24120;&#65292;
&#23558;&#24322;&#24120;<span class="emph">&#20256;&#25773;</span> (<span class="emph">propagate</span>) &#20986;&#21435;&#65307;&#36825;&#26102;&#65292;&#35813;&#24322;&#24120;&#20250;&#20256;&#32473;&#31532;&#20108;&#25509;&#36817;&#30340;&#24322;&#24120;&#22788;&#29702;&#22120;&#12290;</p><p>&#36825;&#37324;&#26159;&#19968;&#20010;&#20363;&#23376;&#65288;&#26242;&#26102;&#20551;&#35774;&#25105;&#20204;&#32473;&#35821;&#35328;&#28155;&#21152;&#20102;&#23383;&#31526;&#20018;&#65289;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let list-index =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (str)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">letrec inner (lst)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= if null?(lst)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then raise("ListIndexFailed")</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else if string-equal?(car(lst), str)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else -((inner cdr(lst)), -1)</span></p></td></tr></table></blockquote><p>&#36807;&#31243; <span class="stt">list-index</span> &#26159;&#20010;&#21654;&#21937;&#24335;&#36807;&#31243;&#65292;&#23427;&#21462;&#19968;&#20010;&#23383;&#31526;&#20018;&#65292;&#19968;&#20010;&#23383;&#31526;&#20018;&#21015;&#34920;&#65292;&#36820;&#22238;&#23383;&#31526;&#20018;
&#22312;&#21015;&#34920;&#20013;&#30340;&#20301;&#32622;&#12290;&#22914;&#26524;&#25214;&#19981;&#21040;&#26399;&#26395;&#30340;&#21015;&#34920;&#20803;&#32032;&#65292;<span class="stt">inner</span> &#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#65292;&#36339;&#36807;&#25152;&#26377;&#24453;&#20570;
&#30340;&#20943;&#27861;&#65292;&#25226; <span class="stt">"ListIndexFailed"</span> &#20256;&#32473;&#26368;&#25509;&#36817;&#30340;&#24322;&#24120;&#22788;&#29702;&#22120;&#12290;</p></blockquote><p>&#36825;&#20010;&#24322;&#24120;&#22788;&#29702;&#22120;&#21487;&#20197;&#21033;&#29992;&#35843;&#29992;&#22788;&#30340;&#20449;&#24687;&#23545;&#24322;&#24120;&#20570;&#36866;&#24403;&#22788;&#29702;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let find-member-number =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (member-name)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">... try ((list-index member-name) member-list)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">catch (exn)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">raise("CantFindMemberNumber")</span></p></td></tr></table></blockquote><p>&#36807;&#31243; <span class="stt">find-member-number</span> &#21462;&#19968;&#23383;&#31526;&#20018;&#65292;&#29992; <span class="stt">list-index</span> &#25214;&#20986;&#23383;&#31526;&#20018;&#22312;&#21015;&#34920;
<span class="stt">member-name</span> &#20013;&#30340;&#20301;&#32622;&#12290;<span class="stt">find-member-number</span> &#30340;&#35843;&#29992;&#32773;&#27809;&#21150;&#27861;&#30693;&#36947;
<span class="stt">list-index</span>&#65292;&#25152;&#20197; <span class="stt">find-member-number</span> &#25226;&#38169;&#35823;&#28040;&#24687;&#32763;&#35793;&#25104;&#35843;&#29992;&#32773;&#33021;&#22815;&#29702;&#35299;&#30340;&#24322;
&#24120;&#12290;</p></blockquote><p>&#26681;&#25454;&#31243;&#24207;&#30340;&#29992;&#36884;&#65292;&#36824;&#26377;&#19968;&#31181;&#21487;&#33021;&#26159;&#65292;&#20803;&#32032;&#21517;&#19981;&#22312;&#21015;&#34920;&#20013;&#26102;&#65292;<span class="stt">find-member-number</span> &#36820;&#22238;
&#19968;&#20010;&#40664;&#35748;&#20540;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let find-member-number =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (member-name)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">... try ((list-index member-name) member-list)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">catch (exn)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">the-default-member-number</span></p></td></tr></table></blockquote><p>&#22312;&#36825;&#20123;&#31243;&#24207;&#20013;&#65292;&#25105;&#20204;&#24573;&#30053;&#20102;&#24322;&#24120;&#30340;&#20540;&#12290;&#22312;&#20854;&#20182;&#24773;&#20917;&#19979;&#65292;<span class="stt">raise</span> &#20256;&#20986;&#30340;&#20540;&#21487;&#33021;&#21253;&#21547;&#19968;&#37096;
&#20998;&#21487;&#20379;&#35843;&#29992;&#32773;&#21033;&#29992;&#30340;&#20449;&#24687;&#12290;</p></blockquote><p>&#29992;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#23454;&#29616;&#36825;&#31181;&#24322;&#24120;&#22788;&#29702;&#26426;&#21046;&#30452;&#25130;&#20102;&#24403;&#12290;&#25105;&#20204;&#20174; <span class="stt">try</span> &#34920;&#36798;&#24335;&#24320;&#22987;&#12290;&#22312;&#32493;
&#25991;&#30340;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#20013;&#65292;&#25105;&#20204;&#28155;&#21152;&#20004;&#20010;&#26500;&#36896;&#22120;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">try-cont</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">identifier?</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">handler-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">expression?</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">environment?</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">raise1-cont</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#22312; <span class="stt">value-of/k</span> &#20013;&#65292;&#25105;&#20204;&#32473; <span class="stt">try</span> &#28155;&#21152;&#19979;&#38754;&#30340;&#20174;&#21477;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">try-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">handler-exp</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">try-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">handler-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote></blockquote><p>&#27714; <span class="stt">try</span> &#34920;&#36798;&#24335;&#20027;&#20307;&#30340;&#20540;&#26102;&#20250;&#21457;&#29983;&#20160;&#20040;&#21602;&#65311;&#22914;&#26524;&#20027;&#20307;&#27491;&#24120;&#36820;&#22238;&#65292;&#37027;&#20040;&#36825;&#20010;&#20540;&#24212;&#35813;&#20256;&#32473;
<span class="stt">try</span> &#34920;&#36798;&#24335;&#30340;&#32493;&#25991;&#65292;&#20063;&#23601;&#26159;&#27492;&#22788;&#30340; <span class="stt">cont</span>&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (try-cont </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">handler\mbox{-}exp</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">env</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (apply-cont </span><span class="texMathInline">cont</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#22914;&#26524;&#19968;&#20010;&#24322;&#24120;&#25243;&#20986;&#20102;&#21602;&#65311;&#39318;&#20808;&#65292;&#25105;&#20204;&#24403;&#28982;&#24471;&#27714;&#20986; <span class="stt">raise</span> &#21442;&#25968;&#30340;&#20540;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">raise-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">raise1-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#24403; <span class="stt">exp1</span> &#30340;&#20540;&#36820;&#22238;&#32473; <span class="stt">raise1-cont</span> &#26102;&#65292;&#25105;&#20204;&#35201;&#26597;&#25214;&#32493;&#25991;&#20013;&#26368;&#25509;&#36817;&#30340;&#24322;&#24120;&#22788;&#29702;&#22120;&#65292;
&#21363;&#26368;&#19978;&#23618;&#30340; <span class="stt">try-cont</span> &#32493;&#25991;&#12290;&#25152;&#20197;&#65292;&#25105;&#20204;&#25226;&#32493;&#25991;&#35268;&#33539;&#20889;&#25104;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (raise1-cont </span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (apply-handler </span><span class="texMathInline">val</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#20854;&#20013;&#65292;<span class="stt">apply-handler</span> &#26159;&#19968;&#36807;&#31243;&#65292;&#23427;&#25214;&#20986;&#26368;&#25509;&#36817;&#30340;&#24322;&#24120;&#22788;&#29702;&#22120;&#65292;&#28982;&#21518;&#35843;&#29992;&#23427;
&#65288;<span class="EoplFigureRef"></span>&#65289;&#12290;</p></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!t]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">apply-handler</span></span> : <span class="texMathInline">\mathit{ExpVal} \times \mathit{Cont} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-handler</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">try-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">handler-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">handler-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">report-uncaught-exception</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff1-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-handler</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff2-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-handler</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p>&#36807;&#31243; <span class="stt">apply-handler</span><a name="(elem._fig-5..15)"></a></p></blockquote></blockquote><p>&#35201;&#26126;&#30333;&#24590;&#26679;&#23558;&#36825;&#20123;&#32467;&#21512;&#21040;&#19968;&#36215;&#65292;&#25105;&#20204;&#32771;&#34385;&#29992;&#34987;&#23450;&#35821;&#35328;&#23454;&#29616;&#30340; <span class="stt">index</span>&#12290;&#20196; <span class="texMathInline">exp_0</span> &#25351;
&#20195;&#34920;&#36798;&#24335;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let index</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= proc (n)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">letrec inner (lst)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= if null? (lst)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then raise 99</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else if zero?(-(car(lst), n))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else -((inner cdr(lst)), -1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in proc (lst)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">try (inner lst)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">catch (x) -1</span></p></td></tr><tr><td><p><span class="stt">in ((index 5) list(2, 3))</span></p></td></tr></table></blockquote><p>&#25105;&#20204;&#20174;&#20219;&#24847;&#29615;&#22659; <span class="texMathInline">\rho_0</span> &#21644;&#32493;&#25991; <span class="texMathInline">cont_0</span> &#24320;&#22987;&#27714; <span class="texMathInline">exp_0</span> &#30340;&#20540;&#65292;&#21482;&#23637;&#31034;&#35745;&#31639;&#30340;
&#20851;&#38190;&#37096;&#20998;&#65292;&#24182;&#25554;&#20837;&#27880;&#37322;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplComputationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;let index = ... in ((index 5) list(2, 3))&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">cont_0</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25191;&#34892;</span><span class="stt">let</span><span class="emph">&#20027;&#20307;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;((index 5) list(2, 3))&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">((index</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="Smaller"><span class="emph">&#31216;&#20043;&#20026;</span><span class="texMathInline">\rho_1</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:proc-val</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:procedure n &lt;&lt;letrec ...&gt;&gt; </span><span class="texMathInline">\rho_0</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(i #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(v #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(x #(struct:num-val 10)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#26368;&#21518;&#27714;</span><span class="stt">try</span><span class="emph">&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;try (inner lst) catch (x) -1&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">((lst</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="Smaller"><span class="emph">&#31216;&#20043;&#20026;</span><span class="texMathInline">\rho_{lst=(2 \  3)}</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:list-val</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(#(struct:num-val 2) #(struct:num-val 3))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(inner ...)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(n #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#22312;</span><span class="stt">try-cont</span><span class="emph">&#32493;&#25991;&#20013;&#27714;</span><span class="stt">try</span><span class="emph">&#20027;&#20307;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;(inner lst)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="stt">lst</span><span class="emph">&#32465;&#23450;&#21040;</span><span class="texMathInline">(2 \  3)</span>&#65292;<span class="emph">&#27714;</span><span class="stt">inner</span><span class="emph">&#20027;&#20307;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;if null?(lst) ...&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#27714;&#26465;&#20214;&#30340;&#20540;&#65292;&#36827;&#20837;&#36882;&#24402;&#25152;&#22312;&#30340;&#34892;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;-((inner cdr(lst)), -1)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#27714;</span><span class="stt">diff-exp</span><span class="emph">&#31532;&#19968;&#20010;&#21442;&#25968;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;(inner cdr(lst))&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="stt">lst</span><span class="emph">&#32465;&#23450;&#21040;</span><span class="texMathInline">(3)</span>&#65292;<span class="emph">&#27714;</span><span class="stt">inner</span><span class="emph">&#20027;&#20307;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;if null?(lst) ...&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">((lst #(struct:list-val (#(struct:num-val 3)))) </span><span class="Smaller"><span class="emph">&#31216;&#20043;&#20026;</span><span class="texMathInline">\rho_{lst=(3)}</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(inner ...)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_0</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#27714;&#26465;&#20214;&#30340;&#20540;&#65292;&#36827;&#20837;&#36882;&#24402;&#25152;&#22312;&#30340;&#34892;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;-((inner cdr(lst)), -1)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_{lst=(3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#27714;</span><span class="stt">diff-exp</span><span class="emph">&#31532;&#19968;&#20010;&#21442;&#25968;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;(inner cdr(lst))&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_{lst=(3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="stt">lst</span><span class="emph">&#32465;&#23450;&#21040;</span><span class="texMathInline">()</span>&#65292;<span class="emph">&#27714;</span><span class="stt">inner</span><span class="emph">&#20027;&#20307;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;if null?(lst) ... &gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">((lst #(struct:list-val ()))</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="Smaller"><span class="emph">&#31216;&#20043;&#20026;</span><span class="texMathInline">\rho_{lst=()}</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(inner ...)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(n #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">...)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#27714;</span><span class="stt">raise</span><span class="emph">&#34920;&#36798;&#24335;&#21442;&#25968;&#30340;&#20540;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&lt;&lt;99&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_{lst=()}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:raise1-cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#29992;</span><span class="stt">apply-handler</span><span class="emph">&#23637;&#24320;&#32493;&#25991;&#65292;&#30452;&#21040;&#25214;&#20986;&#19968;&#20010;&#24322;&#24120;&#22788;&#29702;&#22120;</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(apply-handler</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:num-val 99)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))))</span></p></td></tr><tr><td><p><span class="stt">=</span></p></td></tr><tr><td><p><span class="stt">(apply-handler</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:num-val 99)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:diff1-cont &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))))</span></p></td></tr><tr><td><p><span class="stt">=</span></p></td></tr><tr><td><p><span class="stt">(apply-handler</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:num-val 99)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:try-cont x &lt;&lt;-1&gt;&gt; </span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont)))</span></p></td></tr><tr><td><p><span class="stt">= </span><span class="Smaller"><span class="emph">&#25214;&#21040;&#24322;&#24120;&#22788;&#29702;&#22120;&#65307;&#25226;&#24322;&#24120;&#20540;&#32465;&#23450;&#21040;</span><span class="stt">x</span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(value-of/k</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:const-exp -1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">((x #(struct:num-val 99))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho_{lst=(2 \  3)}</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">...)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#(struct:end-cont))</span></p></td></tr><tr><td><p><span class="stt">=</span></p></td></tr><tr><td><p><span class="stt">(apply-cont #(struct:end-cont) #(struct:const-exp -1))</span></p></td></tr><tr><td><p><span class="stt">=</span></p></td></tr><tr><td><p><span class="stt">#(struct:const-exp -1)</span></p></td></tr></table></blockquote></blockquote><p>&#22914;&#26524;&#21015;&#34920;&#21253;&#21547;&#26399;&#26395;&#20540;&#65292;&#37027;&#20040;&#25105;&#20204;&#19981;&#38656;&#35843;&#29992; <span class="stt">apply-handler</span>&#65292;&#32780;&#26159;&#35843;&#29992;
<span class="stt">apply-cont</span>&#65292;&#24182;&#25191;&#34892;&#32493;&#25991;&#20013;&#25152;&#26377;&#24453;&#23436;&#25104;&#30340; <span class="stt">diff</span>&#12290;
<a name="(idx._(gentag._864))"></a>
<a name="(idx._(gentag._865))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex5..35)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#36825;&#31181;&#23454;&#29616;&#24456;&#20302;&#25928;&#65292;&#22240;&#20026;&#24322;&#24120;&#25243;&#20986;&#26102;&#65292;<span class="stt">apply-handler</span> &#24517;&#39035;&#22312;&#32493;&#25991;&#20013;&#32447;&#24615;&#26597;&#25214;&#22788;&#29702;&#22120;&#12290;
&#35753;&#25152;&#26377;&#32493;&#25991;&#37117;&#33021;&#30452;&#25509;&#20351;&#29992; <span class="stt">try-cont</span> &#32493;&#25991;&#65292;&#20174;&#32780;&#36991;&#20813;&#36825;&#31181;&#26597;&#25214;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..36)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#21478;&#19968;&#31181;&#36991;&#20813; <span class="stt">apply-handler</span> &#32447;&#24615;&#26597;&#25214;&#30340;&#35774;&#35745;&#26159;&#20351;&#29992;&#20004;&#20010;&#32493;&#25991;&#65292;&#19968;&#20010;&#27491;&#24120;&#32493;&#25991;&#65292;&#19968;&#20010;&#24322;
&#24120;&#32493;&#25991;&#12290;&#20462;&#25913;&#26412;&#33410;&#30340;&#35299;&#37322;&#22120;&#65292;&#25913;&#29992;&#20004;&#20010;&#32493;&#25991;&#65292;&#23454;&#29616;&#36825;&#19968;&#30446;&#26631;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..37)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;&#34987;&#23450;&#35821;&#35328;&#65292;&#22312;&#36807;&#31243;&#35843;&#29992;&#30340;&#23454;&#21442;&#25968;&#30446;&#38169;&#35823;&#26102;&#25243;&#20986;&#24322;&#24120;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..38)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;&#34987;&#23450;&#35821;&#35328;&#65292;&#28155;&#21152;&#38500;&#27861;&#34920;&#36798;&#24335;&#65292;&#24182;&#22312;&#34987;&#38646;&#38500;&#26102;&#25243;&#20986;&#24322;&#24120;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..39)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#30446;&#21069;&#65292;&#24322;&#24120;&#22788;&#29702;&#22120;&#21487;&#20197;&#37325;&#26032;&#25243;&#20986;&#24322;&#24120;&#65292;&#25226;&#23427;&#20256;&#25773;&#20986;&#21435;&#65307;&#25110;&#32773;&#36820;&#22238;&#19968;&#20010;&#20540;&#65292;&#20316;&#20026; <span class="stt">try</span> &#34920;
&#36798;&#24335;&#30340;&#20540;&#12290;&#36824;&#21487;&#20197;&#36825;&#26679;&#35774;&#35745;&#35821;&#35328;&#65306;&#20801;&#35768;&#35745;&#31639;&#20174;&#24322;&#24120;&#25243;&#20986;&#30340;&#20301;&#32622;&#32487;&#32493;&#12290;&#20462;&#25913;&#26412;&#33410;&#30340;&#35299;&#37322;&#22120;&#65292;&#22312;
<span class="stt">raise</span> &#35843;&#29992;&#22788;&#30340;&#32493;&#25991;&#20013;&#36816;&#34892;&#24322;&#24120;&#22788;&#29702;&#22120;&#30340;&#20027;&#20307;&#65292;&#23436;&#25104;&#36825;&#31181;&#35774;&#35745;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..40)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25226; <span class="stt">raise</span> &#24322;&#24120;&#22788;&#30340;&#32493;&#25991;&#20316;&#20026;&#31532;&#20108;&#20010;&#21442;&#25968;&#20256;&#36882;&#65292;&#20351;&#34987;&#23450;&#35821;&#35328;&#20013;&#30340;&#24322;&#24120;&#22788;&#29702;&#22120;&#26082;&#33021;&#36820;&#22238;&#20063;
&#33021;&#32487;&#32493;&#12290;&#36825;&#21487;&#33021;&#38656;&#35201;&#25226;&#32493;&#25991;&#20316;&#20026;&#19968;&#31181;&#26032;&#30340;&#34920;&#36798;&#20540;&#12290;&#20026;&#29992;&#20540;&#35843;&#29992;&#32493;&#25991;&#35774;&#35745;&#24688;&#24403;&#30340;&#35821;&#27861;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..41)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._866))"></a>
<a name="(idx._(gentag._867))"></a>
&#25105;&#20204;&#23637;&#31034;&#20102;&#22914;&#20309;&#29992;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#30340;&#32493;&#25991;&#23454;&#29616;&#24322;&#24120;&#12290;&#25105;&#20204;&#27809;&#21150;&#27861;&#39532;&#19978;&#29992;<a href="da.html#%28part._s2..2..3%29" data-pltdoc="x">&#36807;&#31243;&#34920;&#31034;&#27861;</a>&#20013;&#30340;
&#27493;&#39588;&#24471;&#21040;&#36807;&#31243;&#34920;&#31034;&#27861;&#65292;&#22240;&#20026;&#25105;&#20204;&#29616;&#22312;&#26377;&#20004;&#20010;&#35266;&#27979;&#22120;&#65306;<span class="stt">apply-handler</span> &#21644;
<span class="stt">apply-cont</span>&#12290;&#29992;&#19968;&#23545;&#36807;&#31243;&#23454;&#29616;&#26412;&#33410;&#30340;&#32493;&#25991;&#65306;&#19968;&#20010;&#21333;&#21442;&#25968;&#36807;&#31243;&#65292;&#34920;&#31034; <span class="stt">apply-cont</span>
&#20013;&#32493;&#25991;&#30340;&#21160;&#20316;&#65307;&#19968;&#20010;&#26080;&#21442;&#25968;&#36807;&#31243;&#65292;&#34920;&#31034; <span class="stt">apply-handler</span> &#20013;&#32493;&#25991;&#30340;&#21160;&#20316;&#12290;
<a name="(idx._(gentag._868))"></a>
<a name="(idx._(gentag._869))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..42)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._870))"></a>
<a name="(idx._(gentag._871))"></a>
<a name="(idx._(gentag._872))"></a>
&#21069;&#19968;&#36947;&#32451;&#20064;&#21482;&#22312;&#25243;&#20986;&#24322;&#24120;&#26102;&#25429;&#33719;&#32493;&#25991;&#12290;&#28155;&#21152;&#24418;&#24335; <span class="stt">letcc </span><span class="texMathInline">\mathit{Identifier}</span><span class="stt"> in</span><span class="stt">
</span><span class="texMathInline">\mathit{Expression}</span>&#65292;&#20801;&#35768;&#22312;&#35821;&#35328;&#20013;&#30340;&#20219;&#24847;&#20301;&#32622;&#25429;&#33719;&#32493;&#25991;&#65292;&#20854;&#35268;&#33539;&#20026;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(value-of/k (letcc </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">body</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (value-of/k </span><span class="texMathInline">body</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(extend-env </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho</span><span class="stt">) </span><span class="texMathInline">cont</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#36825;&#26679;&#25429;&#33719;&#30340;&#32493;&#25991;&#21487;&#29992; <span class="stt">throw</span> &#35843;&#29992;&#65306;&#34920;&#36798;&#24335; <span class="stt">throw </span><span class="texMathInline">\mathit{Expression}</span><span class="stt"> to</span><span class="stt">
</span><span class="texMathInline">\mathit{Expression}</span> &#27714;&#20986;&#20004;&#20010;&#23376;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;&#31532;&#20108;&#20010;&#34920;&#36798;&#24335;&#24212;&#36820;&#22238;&#19968;&#32493;&#25991;&#65292;&#24212;&#29992;&#20110;
&#31532;&#19968;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;<span class="stt">throw</span> &#34920;&#36798;&#24335;&#24403;&#21069;&#30340;&#32493;&#25991;&#21017;&#34987;&#24573;&#30053;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..43)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;&#21069;&#19968;&#36947;&#32451;&#20064;&#34987;&#23450;&#35821;&#35328;&#20013;&#30340; <span class="stt">letcc</span>&#65292;&#25226;&#25429;&#33719;&#30340;&#32493;&#25991;&#20316;&#20026;&#19968;&#31181;&#26032;&#30340;&#36807;&#31243;&#65292;&#36825;&#26679;&#23601;&#33021;&#20889;
<span class="stt">(</span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">exp_2</span><span class="stt">)</span>&#65292;&#32780;&#19981;&#24517;&#20889; <span class="stt">throw </span><span class="texMathInline">\mathit{Expression}</span><span class="stt"> to</span><span class="stt">
</span><span class="texMathInline">\mathit{Expression}</span>&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..44)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#21069;&#38754;&#32451;&#20064;&#37324;&#30340; <span class="stt">letcc</span> &#21644; <span class="stt">throw</span> &#36824;&#26377;&#19968;&#31181;&#35774;&#35745;&#26041;&#24335;&#65292;&#21482;&#38656;&#32473;&#35821;&#35328;&#28155;&#21152;&#19968;&#20010;&#36807;&#31243;&#12290;
&#36825;&#20010;&#36807;&#31243;&#22312; Scheme &#20013;&#21483;&#20570; <span class="stt">call-with-current-continuation</span>&#65292;&#23427;&#21462;&#19968;&#20010;&#21333;&#21442;&#25968;&#36807;&#31243;
<span class="stt">p</span>&#65292;&#24182;&#32473; <span class="stt">p</span> &#20256;&#36882;&#19968;&#20010;&#21333;&#21442;&#25968;&#36807;&#31243;&#65292;&#36825;&#20010;&#36807;&#31243;&#22312;&#35843;&#29992;&#26102;&#65292;&#23558;&#20854;&#21442;&#25968;&#20256;&#36882;&#32473;&#24403;&#21069;&#30340;&#32493;
&#25991;<span class="stt">cont</span>&#12290;<span class="stt">call-with-current-continuation</span> &#21487;&#29992; <span class="stt">letcc</span> &#21644; <span class="stt">throw</span>
&#23450;&#20041;&#22914;&#19979;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let call-with-current-continuation</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= proc (p)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">letcc cont</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (p proc (v) throw v to cont)</span></p></td></tr><tr><td><p><span class="stt">in ...</span></p></td></tr></table></blockquote><p>&#32473;&#35821;&#35328;&#28155;&#21152; <span class="stt">call-with-current-continuation</span>&#12290;&#28982;&#21518;&#20889;&#19968;&#20010;&#32763;&#35793;&#22120;&#65292;&#29992;&#21482;&#26377;
<span class="stt">call-with-current-continuation</span> &#30340;&#35821;&#35328;&#32763;&#35793;&#20855;&#26377; <span class="stt">letcc</span> &#21644; <span class="stt">throw</span> &#30340;&#35821;
&#35328;&#12290;
<a name="(idx._(gentag._873))"></a>
<a name="(idx._(gentag._874))"></a>
<a name="(idx._(gentag._875))"></a></p></blockquote><h4>5.5<tt>&nbsp;</tt><a name="(part._s5..5)"></a>&#32447;&#31243;</h4><p><a name="(idx._(gentag._876))"></a>
<a name="(idx._(gentag._877))"></a>
&#35768;&#22810;&#32534;&#31243;&#20219;&#21153;&#20013;&#65292;&#21487;&#33021;&#38656;&#35201;&#19968;&#27425;&#36827;&#34892;&#22810;&#39033;&#35745;&#31639;&#12290;&#24403;&#36825;&#20123;&#35745;&#31639;&#20316;&#20026;&#21516;&#19968;&#36827;&#31243;&#30340;&#19968;&#37096;&#20998;&#65292;&#36816;&#34892;&#22312;
&#21516;&#19968;&#22320;&#22336;&#31354;&#38388;&#65292;&#36890;&#24120;&#31216;&#23427;&#20204;&#20026;<span class="emph">&#32447;&#31243;</span> (<span class="emph">thread</span>)&#12290;&#26412;&#33410;&#65292;&#25105;&#20204;&#23558;&#30475;&#21040;&#22914;&#20309;&#20462;&#25913;&#35299;&#37322;&#22120;&#65292;
&#27169;&#25311;&#22810;&#32447;&#31243;&#31243;&#24207;&#30340;&#25191;&#34892;&#12290;</p><p>&#25105;&#20204;&#30340;&#22810;&#32447;&#31243;&#35299;&#37322;&#22120;&#19981;&#20570;&#21333;&#32447;&#31243;&#35745;&#31639;&#65292;&#32780;&#19988;&#32500;&#25252;&#22810;&#20010;&#32447;&#31243;&#12290;&#23601;&#20687;&#26412;&#31456;&#20043;&#21069;&#23637;&#31034;&#30340;&#37027;&#26679;&#65292;&#27599;
&#20010;&#32447;&#31243;&#21253;&#21547;&#19968;&#39033;&#27491;&#22312;&#36827;&#34892;&#30340;&#35745;&#31639;&#12290;&#32447;&#31243;&#20351;&#29992;<a href="state.html" data-pltdoc="x">&#29366;&#24577;</a>&#20013;&#30340;&#36171;&#20540;&#65292;&#36890;&#36807;&#20849;&#20139;&#20869;&#23384;&#36890;&#20449;&#12290;
<a name="(idx._(gentag._878))"></a><a name="(idx._(gentag._879))"></a></p><p>&#22312;&#25105;&#20204;&#30340;&#31995;&#32479;&#20013;&#65292;&#25972;&#20010;&#35745;&#31639;&#21253;&#21547;&#19968;&#20010;&#32447;&#31243;<span class="emph">&#27744;</span> (<span class="emph">pool</span>)&#12290;&#27599;&#20010;
&#32447;&#31243;<span class="emph">&#22312;&#36816;&#34892;</span> (<span class="emph">running</span>)&#12289;<span class="emph">&#21487;&#36816;&#34892;</span> (<span class="emph">runnable</span>) &#25110;&#32773;<span class="emph">&#21463;
&#38459;&#22622;</span> (<span class="emph">blocked</span>)&#12290;&#22312;&#25105;&#20204;&#30340;&#31995;&#32479;&#20013;&#65292;&#19968;&#27425;&#21482;&#33021;&#26377;&#19968;&#20010;&#32447;&#31243;&#22312;&#36816;&#34892;&#12290;&#22312;&#22810; CPU &#31995;&#32479;&#20013;&#65292;&#21487;&#20197;&#26377;&#33509;&#24178;&#32447;&#31243;
&#21516;&#26102;&#36816;&#34892;&#12290;&#21487;&#36816;&#34892;&#30340;&#32447;&#31243;&#35760;&#24405;&#22312;&#21517;&#20026;<span class="emph">&#23601;&#32490;&#38431;&#21015;</span> (<span class="emph">ready queue</span>)&#30340;&#38431;&#21015;&#20013;&#12290;&#36824;&#26377;&#20123;&#32447;
&#31243;&#22240;&#20026;&#31181;&#31181;&#21407;&#22240;&#26410;&#33021;&#23601;&#32490;&#65292;&#25105;&#20204;&#35828;&#36825;&#20123;&#32447;&#31243;<span class="emph">&#21463;&#38459;&#22622;</span>&#12290;&#26412;&#33410;&#31245;&#21518;&#20171;&#32461;&#21463;&#38459;&#22622;&#32447;&#31243;&#12290;</p><p>&#32447;&#31243;&#35843;&#24230;&#30001;<span class="emph">&#35843;&#24230;&#22120;</span> (<span class="emph">scheduler</span>) &#25191;&#34892;&#65292;&#23601;&#32490;&#38431;&#21015;&#20026;&#20854;&#29366;&#24577;&#30340;&#19968;&#37096;&#20998;&#12290;
<a name="(idx._(gentag._880))"></a>
&#27492;&#22806;&#65292;&#23427;&#20445;&#23384;&#19968;&#20010;&#35745;&#26102;&#22120;&#65292;&#24403;&#19968;&#20010;&#32447;&#31243;&#25191;&#34892;&#33509;&#24178;&#27493;&#39588;&#65288;&#21363;&#32447;&#31243;&#30340;<span class="emph">&#26102;&#38388;&#29255;</span> (<span class="emph">time slice</span>)
<a name="(idx._(gentag._881))"></a>
&#25110;<span class="emph">&#37327;&#23376;</span> (<span class="emph">quantum</span>)&#65289;&#26102;&#65292;&#23427;&#20013;&#26029;&#32447;&#31243;&#65292;&#23558;&#20854;&#25918;&#22238;&#23601;&#32490;&#38431;&#21015;&#65292;&#24182;&#20174;&#23601;&#32490;&#38431;&#21015;&#20013;&#36873;&#20986;&#19968;
&#20010;&#26032;&#30340;&#32447;&#31243;&#26469;&#36816;&#34892;&#12290;&#36825;&#21483;&#20570;<span class="emph">&#25250;&#21344;&#24335;&#35843;&#24230;</span> (<span class="emph">pre-emptive scheduling</span>)&#12290;</p><p><a name="(idx._(gentag._882))"></a>
<a name="(idx._(gentag._883))"></a></p><p>&#25105;&#20204;&#30340;&#26032;&#35821;&#35328;&#22522;&#20110; IMPLICIT-REFS&#65292;&#21517;&#21483; THREADS&#12290;&#22312; THREADS &#20013;&#65292;&#26032;&#32447;&#31243;&#30001;&#21517;&#20026;
<span class="stt">spawn</span> &#30340;&#32467;&#26500;&#21019;&#24314;&#12290;<span class="stt">spawn</span> &#21462;&#19968;&#21442;&#25968;&#65292;&#35813;&#21442;&#25968;&#30340;&#20540;&#24212;&#20026;&#19968;&#20010;&#36807;&#31243;&#12290;&#26032;&#21019;&#24314;&#30340;&#32447;&#31243;
&#36816;&#34892;&#26102;&#65292;&#32473;&#37027;&#20010;&#36807;&#31243;&#20256;&#36882;&#19968;&#20010;&#20219;&#24847;&#21442;&#25968;&#12290;&#35813;&#32447;&#31243;&#19981;&#26159;&#31435;&#21051;&#36816;&#34892;&#65292;&#32780;&#26159;&#25918;&#20837;&#23601;&#32490;&#38431;&#21015;&#20013;&#65292;&#36718;&#21040;
&#23427;&#26102;&#25165;&#36816;&#34892;&#12290;<span class="stt">spawn</span> &#30340;&#25191;&#34892;&#21482;&#27714;&#25928;&#26524;&#65307;&#22312;&#25105;&#20204;&#30340;&#31995;&#32479;&#20013;&#65292;&#25105;&#20204;&#20026;&#23427;&#20219;&#36873;&#19968;&#20010;&#36820;&#22238;&#20540; 73&#12290;</p><p>&#25105;&#20204;&#26469;&#30475;&#36825;&#31181;&#35821;&#35328;&#30340;&#20004;&#20010;&#31034;&#20363;&#31243;&#24207;&#12290;<span class="EoplFigureRef"></span> &#23450;&#20041;&#20102;&#19968;&#20010;&#36807;&#31243; <span class="stt">noisy</span>&#65292;
&#23427;&#21462;&#19968;&#20010;&#21015;&#34920;&#65292;&#25171;&#21360;&#20986;&#21015;&#34920;&#30340;&#31532;&#19968;&#20010;&#20803;&#32032;&#65292;&#28982;&#21518;&#36882;&#24402;&#22788;&#29702;&#21015;&#34920;&#30340;&#21097;&#20313;&#37096;&#20998;&#12290;&#36825;&#37324;&#65292;&#20027;&#20307;&#20013;&#30340;
&#34920;&#36798;&#24335;&#21019;&#24314;&#20004;&#20010;&#32447;&#31243;&#65292;&#20998;&#21035;&#25171;&#21360;&#21015;&#34920; <span class="stt">[1,2,3,4,5]</span> &#21644; <span class="stt">[6,7,8,9,10]</span>&#12290;&#20004;&#20010;&#21015;&#34920;
&#31350;&#31455;&#22914;&#20309;&#31359;&#25554;&#21462;&#20915;&#20110;&#35843;&#24230;&#22120;&#65307;&#22312;&#26412;&#20363;&#20013;&#65292;&#22312;&#34987;&#35843;&#24230;&#22120;&#25171;&#26029;&#20043;&#21069;&#65292;&#27599;&#20010;&#32447;&#31243;&#25171;&#21360;&#20986;&#21015;&#34920;&#20013;&#30340;&#20004;
&#20010;&#20803;&#32032;&#65292;</p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">test: two-non-cooperating-threads</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">noisy (l) = if null?(l)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else begin print(car(l)); (noisy cdr(l)) end</span></p></td></tr><tr><td><p><span class="stt">in</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn(proc (d) (noisy [1,2,3,4,5]));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn(proc (d) (noisy [6,7,8,9,10]));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">print(100);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">33</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">100</span></p></td></tr><tr><td><p><span class="stt">1</span></p></td></tr><tr><td><p><span class="stt">2</span></p></td></tr><tr><td><p><span class="stt">6</span></p></td></tr><tr><td><p><span class="stt">7</span></p></td></tr><tr><td><p><span class="stt">3</span></p></td></tr><tr><td><p><span class="stt">4</span></p></td></tr><tr><td><p><span class="stt">8</span></p></td></tr><tr><td><p><span class="stt">9</span></p></td></tr><tr><td><p><span class="stt">5</span></p></td></tr><tr><td><p><span class="stt">10</span></p></td></tr><tr><td><p><span class="stt">&#27491;&#30830;&#32467;&#26524;: 33</span></p></td></tr><tr><td><p><span class="stt">&#23454;&#38469;&#32467;&#26524;: #(struct:num-val 33)</span></p></td></tr><tr><td><p><span class="stt">&#27491;&#30830;</span></p></td></tr></table></blockquote></div></p><blockquote class="caption"><p>&#20004;&#20010;&#20132;&#38169;&#36816;&#34892;&#30340;&#32447;&#31243;<a name="(elem._fig-5..16)"></a></p></blockquote></blockquote><p><span class="EoplFigureRef"></span> &#23637;&#31034;&#20102;&#19968;&#20010;&#29983;&#20135;&#32773;&#21644;&#19968;&#20010;&#28040;&#36153;&#32773;&#65292;&#30001;&#21021;&#22987;&#20540;&#20026; 0 &#30340;&#32531;&#23384;&#30456;&#32852;&#31995;&#12290;
&#29983;&#20135;&#32773;&#21462;&#19968;&#21442;&#25968; <span class="stt">n</span>&#65292;&#36827;&#20837; <span class="stt">wait</span>&#65292;&#24490;&#29615; 5 &#27425;&#65292;&#28982;&#21518;&#25226; <span class="stt">n</span> &#25918;&#20837;&#32531;&#23384;&#12290;&#27599;&#27425;&#36827;
&#20837; <span class="stt">wait</span> &#24490;&#29615;&#65292;&#23427;&#25171;&#21360;&#19968;&#20010;&#20498;&#25968;&#35745;&#26102;&#22120;&#65288;&#20197; 200s &#20026;&#21333;&#20301;&#65289;&#30340;&#20540;&#12290;&#28040;&#36153;&#32773;&#21462;&#19968;&#21442;&#25968;
&#65288;&#20294;&#24573;&#30053;&#23427;&#65289;&#65292;&#36827;&#20837;&#19968;&#24490;&#29615;&#65292;&#31561;&#24453;&#32531;&#23384;&#21464;&#25104;&#38750;&#38646;&#20540;&#12290;&#27599;&#27425;&#36827;&#20837;&#24490;&#29615;&#26102;&#65292;&#23427;&#25171;&#21360;&#19968;&#20010;&#35745;&#25968;&#22120;
&#65288;&#20197; 100s &#20026;&#21333;&#20301;&#65289;&#30340;&#20540;&#65292;&#20197;&#23637;&#31034;&#23427;&#31561;&#32467;&#26524;&#31561;&#20102;&#22810;&#20037;&#12290;&#20027;&#32447;&#31243;&#23558;&#29983;&#20135;&#32773;&#25918;&#20837;&#23601;&#32490;&#38431;&#21015;&#65292;&#25171;&#21360;
&#20986; 300&#65292;&#24182;&#22312;&#33258;&#36523;&#20013;&#21551;&#21160;&#28040;&#36153;&#32773;&#12290;&#25152;&#20197;&#65292;&#21069;&#20004;&#39033;&#65292;300 &#21644; 205&#65292;&#20998;&#21035;&#30001;&#20027;&#32447;&#31243;&#21644;&#29983;&#20135;&#32773;&#32447;&#31243;
&#25171;&#21360;&#12290;<span class="NoteBox"><span class="NoteContent">&#21407;&#25991;&#20026;So the first two items, 300 and 205, are printed by the main
thread. &#23454;&#21017;205&#26159;&#29983;&#20135;&#32773;&#25152;&#22312;&#32447;&#31243;&#25171;&#21360;&#12290;</span></span>&#23601;&#20687;&#21069;&#19968;&#20010;&#20363;&#23376;&#37027;&#26679;&#65292;&#22312;&#34987;&#25171;&#26029;&#20043;&#21069;&#65292;&#28040;&#36153;&#32773;&#32447;
&#31243;&#21644;&#29983;&#20135;&#32773;&#32447;&#31243;&#21508;&#33258;&#24490;&#29615;&#22823;&#32422;&#20004;&#27425;&#12290;</p><blockquote class="EoplFigure"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let buffer = 0</span></p></td></tr><tr><td><p><span class="stt">in let producer = proc (n)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">wait(k) = if zero?(k)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then set buffer = n</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">print(-(k,-200));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(wait -(k,1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (wait 5)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let consumer = proc (d)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">letrec busywait (k) = if zero?(buffer)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">print(-(k,-100));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(busywait -(k,-1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else buffer</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (busywait 0)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn(proc (d) (producer 44));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">print(300);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(consumer 86)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">300</span></p></td></tr><tr><td><p><span class="stt">205</span></p></td></tr><tr><td><p><span class="stt">100</span></p></td></tr><tr><td><p><span class="stt">101</span></p></td></tr><tr><td><p><span class="stt">204</span></p></td></tr><tr><td><p><span class="stt">203</span></p></td></tr><tr><td><p><span class="stt">102</span></p></td></tr><tr><td><p><span class="stt">103</span></p></td></tr><tr><td><p><span class="stt">202</span></p></td></tr><tr><td><p><span class="stt">201</span></p></td></tr><tr><td><p><span class="stt">104</span></p></td></tr><tr><td><p><span class="stt">105</span></p></td></tr><tr><td><p><span class="stt">&#27491;&#30830;&#32467;&#26524;: 44</span></p></td></tr><tr><td><p><span class="stt">&#23454;&#38469;&#32467;&#26524;: #(struct:num-val 44)</span></p></td></tr><tr><td><p><span class="stt">&#27491;&#30830;</span></p></td></tr></table></blockquote><blockquote class="caption"><p>&#30001;&#32531;&#23384;&#36830;&#25509;&#30340;&#29983;&#20135;&#32773;&#21644;&#28040;&#36153;&#32773;<a name="(elem._fig-5..17)"></a></p></blockquote></blockquote><p>&#23454;&#29616;&#20174; IMPLICIT-REFS &#35821;&#35328;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#24320;&#22987;&#12290;&#36825;&#19982;<a href="#%28part._s5..1%29" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a>&#20013;&#30340;&#31867;&#20284;&#65292;&#21482;&#26159;&#22810;
&#20102; IMPLICIT-REFS &#20013;&#30340;&#23384;&#20648;&#22120;&#65288;&#24403;&#28982;&#65281;&#65289;&#65292;&#20197;&#21450;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#32493;&#25991;&#26500;&#36896;&#22120;
<span class="stt">set-rhs-cont</span>&#12290;</p><p>&#25105;&#20204;&#32473;&#36825;&#20010;&#35299;&#37322;&#22120;&#28155;&#21152;&#19968;&#20010;&#35843;&#24230;&#22120;&#12290;&#35843;&#24230;&#22120;&#29366;&#24577;&#30001;&#22235;&#20010;&#20540;&#32452;&#25104;&#65292;&#25509;&#21475;&#25552;&#20379;&#20845;&#20010;&#36807;&#31243;&#26469;&#25805;&#20316;&#36825;
&#20123;&#20540;&#65292;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;</p><p><span class="EoplFigureRef"></span> &#23637;&#31034;&#20102;&#26412;&#25509;&#21475;&#30340;&#23454;&#29616;&#12290;&#36825;&#37324; <span class="stt">(enqueue </span><span class="texMathInline">q</span><span class="stt"> </span><span class="texMathInline">val</span><span class="stt">)</span> &#36820;&#22238;
&#19968;&#38431;&#21015;&#65292;&#38500;&#20102;&#25226; <span class="texMathInline">val</span> &#25918;&#22312;&#26411;&#23614;&#20043;&#22806;&#65292;&#19982; <span class="texMathInline">q</span> &#30456;&#21516;&#12290;<span class="stt">(dequeue </span><span class="texMathInline">q</span><span class="stt"> </span><span class="texMathInline">f</span><span class="stt">)</span>
&#21462;&#20986;&#38431;&#22836;&#21450;&#21097;&#20313;&#37096;&#20998;&#65292;&#23558;&#23427;&#20204;&#20316;&#20026;&#21442;&#25968;&#20256;&#36882;&#32473; <span class="texMathInline">f</span>&#12290;</p><p>&#25105;&#20204;&#29992;&#26080;&#21442;&#25968;&#19988;&#36820;&#22238;&#34920;&#36798;&#20540;&#30340; Scheme &#36807;&#31243;&#34920;&#31034;&#32447;&#31243;&#65306;</p><blockquote class="Small"><blockquote><p><span class="texMathInline">\mathit{Thread} = () \to \mathit{ExpVal}</span></p></blockquote></blockquote><p>&#22914;&#26524;&#23601;&#32490;&#38431;&#21015;&#38750;&#31354;&#65292;&#37027;&#20040;&#36807;&#31243; <span class="stt">run-next-thread</span> &#20174;&#23601;&#32490;&#38431;&#21015;&#21462;&#20986;&#31532;&#19968;&#20010;&#32447;&#31243;&#24182;&#36816;&#34892;&#65292;
&#36171;&#20104;&#23427;&#19968;&#20010;&#22823;&#23567;&#20026; <span class="stt">the-max-time-slice</span> &#30340;&#26032;&#26102;&#38388;&#29255;&#12290;&#22914;&#26524;&#36824;&#26377;&#23601;&#32490;&#32447;&#31243;&#65292;&#23427;&#36824;&#25226;
<span class="stt">the-ready-queue</span> &#35774;&#32622;&#20026;&#21097;&#20313;&#32447;&#31243;&#38431;&#21015;&#12290;&#22914;&#26524;&#23601;&#32490;&#38431;&#21015;&#20026;&#31354;&#65292;<span class="stt">run-next-thread</span>
&#36820;&#22238; <span class="stt">the-final-answer</span>&#65292;&#35745;&#31639;&#33267;&#27492;&#20840;&#37096;&#32456;&#27490;&#12290;</p><p><a name="(idx._(gentag._884))"></a>
&#28982;&#21518;&#25105;&#20204;&#26469;&#30475;&#35299;&#37322;&#22120;&#12290;<span class="stt">spawn</span> &#34920;&#36798;&#24335;&#22312;&#26576;&#20010;&#32493;&#25991;&#20013;&#27714;&#21442;&#25968;&#30340;&#20540;&#65292;&#36825;&#20010;&#32493;&#25991;&#25191;&#34892;&#26102;&#65292;&#23558;
&#19968;&#20010;&#26032;&#32447;&#31243;&#25918;&#20837;&#23601;&#32490;&#38431;&#21015;&#65292;&#24182;&#23558; 73 &#36820;&#22238;&#32473; <span class="stt">spawn</span> &#30340;&#35843;&#29992;&#32773;&#12290;&#26032;&#30340;&#32447;&#31243;&#25191;&#34892;&#26102;&#65292;&#23558;&#19968;
&#20010;&#20219;&#24847;&#20540;&#65288;&#36825;&#37324;&#36873; 28&#65289;&#20256;&#32473; <span class="stt">spawn</span> &#21442;&#25968;&#27714;&#20540;&#24471;&#21040;&#30340;&#36807;&#31243;&#12290;&#35201;&#23436;&#25104;&#36825;&#20123;&#65292;&#25105;&#20204;&#32473;
<span class="stt">value-of/k</span> &#26032;&#22686;&#20174;&#21477;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">spawn-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">spawn-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#32473; <span class="stt">apply-cont</span> &#26032;&#22686;&#20174;&#21477;&#65306;</p><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">spawn-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">place-on-ready-queue!</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-procedure/k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">proc1</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">28</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">end-subthread-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">saved-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">73</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._885))"></a></div></p></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]
</div><div class="SIntrapara"><blockquote class="SubFlow"><p><div class="SIntrapara">\begin{cornerbox}[title=&#35843;&#24230;&#22120;&#30340;&#20869;&#37096;&#29366;&#24577;]
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">the-ready-queue</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#23601;&#32490;&#38431;&#21015;</p></td></tr><tr><td><p><span class="stt">the-final-answer</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#20027;&#32447;&#31243;&#32467;&#26463;&#26102;&#30340;&#20540;</p></td></tr><tr><td><p><span class="stt">the-max-time-slice</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#27599;&#20010;&#32447;&#31243;&#36816;&#34892;&#30340;&#27493;&#25968;</p></td></tr><tr><td><p><span class="stt">the-time-remaining</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#24403;&#21069;&#36816;&#34892;&#32447;&#31243;&#21097;&#20313;&#30340;&#27493;&#25968;</p></td></tr></table></div><div class="SIntrapara">
\end{cornerbox}</div></p></blockquote></div></p><blockquote class="SubFlow"><p><div class="SIntrapara">\begin{cornerbox}[title=&#35843;&#24230;&#22120;&#30340;&#25509;&#21475;]
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">initialize-scheduler!</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="texMathInline">: \mathit{Int} \to \mathit{Unspecified}</span></p></td></tr><tr><td><p></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#21021;&#22987;&#21270;&#35843;&#24230;&#22120;&#29366;&#24577;</p></td></tr><tr><td><p><span style="font-weight: bold">place-on-ready-queue!</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="texMathInline">: \mathit{Thread} \to \mathit{Unspecified}</span></p></td></tr><tr><td><p></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#25226;&#32447;&#31243;&#25918;&#20837;&#23601;&#32490;&#38431;&#21015;</p></td></tr><tr><td><p><span style="font-weight: bold">run-next-thread</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="texMathInline">: \mathit{()} \to \mathit{FinalAnswer}</span></p></td></tr><tr><td><p></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#36816;&#34892;&#19979;&#19968;&#20010;&#32447;&#31243;&#12290;&#22914;&#26524;&#27809;&#26377;&#23601;&#32490;&#32447;&#31243;&#65292;&#36820;&#22238;&#26368;&#32456;&#31572;&#26696;&#12290;</p></td></tr><tr><td><p><span style="font-weight: bold">set-final-answer!</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="texMathInline">: \mathit{ExpVal} \to \mathit{Unspecified}</span></p></td></tr><tr><td><p></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#35774;&#32622;&#26368;&#32456;&#31572;&#26696;</p></td></tr><tr><td><p><span style="font-weight: bold">time-expired?</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="texMathInline">: \mathit{()} \to \mathit{Bool}</span></p></td></tr><tr><td><p></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#21028;&#26029;&#35745;&#26102;&#22120;&#26159;&#21542;&#20026;0</p></td></tr><tr><td><p><span style="font-weight: bold">decrement-timer!</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="texMathInline">: \mathit{()} \to \mathit{Unspecified}</span></p></td></tr><tr><td><p></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&#36882;&#20943;<span class="stt">the-time-remaining</span></p></td></tr></table></div><div class="SIntrapara">
\end{cornerbox}</div></p></blockquote><blockquote class="caption"><p>&#35843;&#24230;&#22120;&#30340;&#29366;&#24577;&#21644;&#25509;&#21475;
<a name="(idx._(gentag._886))"></a><a name="(elem._fig-5..18)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">initialize-scheduler!</span></span> : <span class="texMathInline">\mathit{Int} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">initialize-scheduler!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ticks</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-ready-queue</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">empty-queue</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-final-answer</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-max-time-slice</span><span class="hspace">&nbsp;</span><span class="RktSym">ticks</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-time-remaining</span><span class="hspace">&nbsp;</span><span class="RktSym">the-max-time-slice</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">place-on-ready-queue!</span></span> : <span class="texMathInline">\mathit{Thread} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">place-on-ready-queue!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">th</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-ready-queue</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">enqueue</span><span class="hspace">&nbsp;</span><span class="RktSym">the-ready-queue</span><span class="hspace">&nbsp;</span><span class="RktSym">th</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">run-next-thread</span></span> : <span class="texMathInline">\mathit{()} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">run-next-thread</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">empty?</span><span class="hspace">&nbsp;</span><span class="RktSym">the-ready-queue</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">debug-mode?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eopl:printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"&#35745;&#31639;&#32467;&#26463;.~%"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">the-final-answer</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">debug-mode?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eopl:printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"&#20999;&#25442;&#21040;&#21478;&#19968;&#32447;&#31243;.~%"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dequeue</span><span class="hspace">&nbsp;</span><span class="RktSym">the-ready-queue</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first-ready-thread</span><span class="hspace">&nbsp;</span><span class="RktSym">other-ready-thread</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-ready-queue</span><span class="hspace">&nbsp;</span><span class="RktSym">other-ready-thread</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-time-remaining</span><span class="hspace">&nbsp;</span><span class="RktSym">the-max-time-slice</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first-ready-thread</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">set-final-answer!</span></span> : <span class="texMathInline">\mathit{ExpVal} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">set-final-answer!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-final-answer</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">time-expired?</span></span> : <span class="texMathInline">\mathit{ExpVal} \to \mathit{Bool}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">time-expired?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">the-time-remaining</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">decrease-timer!</span></span> : <span class="texMathInline">\mathit{()} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">decrease-timer!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-time-remaining</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">the-time-remaining</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p>&#35843;&#24230;&#22120;
<a name="(idx._(gentag._887))"></a><a name="(elem._fig-5..19)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let x = 0</span></p></td></tr><tr><td><p><span class="stt">in let mut = mutex()</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let incr_x = proc (id)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set x = -(x,-1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn((incr_x 100));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn((incr_x 200));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn((incr_x 300))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr></table></blockquote><blockquote class="caption"><p>&#19981;&#23433;&#20840;&#30340;&#35745;&#25968;&#22120;<a name="(elem._fig-5..20)"></a></p></blockquote></blockquote><p>&#36339;&#36291;&#24335;&#35299;&#37322;&#22120;&#29983;&#25104;&#24555;&#29031;&#26102;&#20063;&#35201;&#20570;&#36825;&#26679;&#65306;&#23427;&#23558;&#35745;&#31639;&#25171;&#21253;&#65288;&#36825;&#37324;&#30340; <span class="stt">(lambda ()
(apply-procedure/k ...))</span>&#65289;&#65292;&#28982;&#21518;&#25226;&#23427;&#20256;&#32473;&#21478;&#19968;&#20010;&#36807;&#31243;&#22788;&#29702;&#12290;&#22312;&#36339;&#24202;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#25226;
&#32447;&#31243;&#20256;&#32473;&#36339;&#24202;&#65292;&#21518;&#32773;&#30452;&#25509;&#25191;&#34892;&#21069;&#32773;&#12290;&#36825;&#37324;&#65292;&#25105;&#20204;&#25226;&#26032;&#32447;&#31243;&#25918;&#20837;&#23601;&#32490;&#38431;&#21015;&#65292;&#32487;&#32493;&#25105;&#20204;&#30340;&#29616;&#26377;&#35745;
&#31639;&#12290;</p></blockquote><p>&#36825;&#24102;&#26469;&#19968;&#20010;&#20851;&#38190;&#38382;&#39064;&#65306;&#27599;&#20010;&#32447;&#31243;&#24212;&#22312;&#20160;&#20040;&#32493;&#25991;&#20013;&#36816;&#34892;&#65311;</p><ul><li><p>&#36816;&#34892;&#20027;&#32447;&#31243;&#30340;&#32493;&#25991;&#24212;&#35760;&#24405;&#20027;&#32447;&#31243;&#30340;&#20540;&#65292;&#20316;&#20026;&#26368;&#32456;&#31572;&#26696;&#65292;&#28982;&#21518;&#36816;&#34892;&#21097;&#20313;&#32447;&#31243;&#12290;</p></li><li><p>&#23376;&#32447;&#31243;&#32467;&#26463;&#26102;&#26080;&#27861;&#25253;&#21578;&#23427;&#30340;&#20540;&#65292;&#25152;&#20197;&#36816;&#34892;&#23376;&#32447;&#31243;&#30340;&#32493;&#25991;&#24212;&#24573;&#30053;&#20854;&#20540;&#65292;&#28982;&#21518;&#30452;&#25509;&#36816;&#34892;
&#21097;&#20313;&#32447;&#31243;&#12290;</p></li></ul><p><a name="(idx._(gentag._888))"></a>
&#30001;&#27492;&#25105;&#20204;&#24471;&#20986;&#20004;&#31181;&#26032;&#32493;&#25991;&#65292;&#20854;&#34892;&#20026;&#30001; <span class="stt">apply-cont</span> &#20013;&#30340;&#20197;&#19979;&#20960;&#34892;&#23454;&#29616;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-main-thread-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">set-final-answer!</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">run-next-thread</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">end-subthread-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">run-next-thread</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#25105;&#20204;&#20174; <span class="stt">value-of-program</span> &#20837;&#25163;&#25972;&#20010;&#31995;&#32479;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of-program</span></span> : <span class="texMathInline">\mathit{Int} \times \mathit{Program} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">timeslice</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">initialize-store!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">initialize-scheduler!</span><span class="hspace">&nbsp;</span><span class="RktSym">timeslice</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">program</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">exp1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-main-thread-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#26368;&#21518;&#65292;&#25105;&#20204;&#20462;&#25913; <span class="stt">apply-cont</span>&#65292;&#35753;&#23427;&#22312;&#27599;&#27425;&#35843;&#29992;&#26102;&#36882;&#20943;&#35745;&#26102;&#22120;&#12290;&#22914;&#26524;&#35745;&#26102;&#22120;&#21040;&#26399;&#65292;&#37027;&#23601;
&#20013;&#27490;&#24403;&#21069;&#35745;&#31639;&#12290;&#22312;&#23454;&#29616;&#26102;&#65292;&#25105;&#20204;&#20808;&#25226;&#19968;&#20010;&#32447;&#31243;&#25918;&#20837;&#23601;&#32490;&#38431;&#21015;&#65292;&#23427;&#29992;&#35843;&#29992;
<span class="stt">run-next-thread</span> &#26102;&#24674;&#22797;&#30340;&#35745;&#26102;&#22120;&#20877;&#27425;&#35843;&#29992; <span class="stt">apply-cont</span>&#12290;</p><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">apply-cont</span></span> : <span class="texMathInline">\mathit{Cont} \times \mathit{ExpVal} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">time-expired?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">place-on-ready-queue!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-next-thread</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">decrement-timer!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._889))"></a></div></p></blockquote><p><a name="(idx._(gentag._890))"></a>
<a name="(idx._(gentag._891))"></a>
<a name="(idx._(gentag._892))"></a>
&#20849;&#20139;&#21464;&#37327;&#19981;&#26159;&#21487;&#38752;&#30340;&#36890;&#20449;&#26041;&#24335;&#65292;&#22240;&#20026;&#22810;&#20010;&#32447;&#31243;&#21487;&#33021;&#35797;&#22270;&#20889;&#21516;&#19968;&#21464;&#37327;&#12290;&#20363;&#22914;&#65292;
&#32771;&#34385;<span class="EoplFigureRef"></span> &#20013;&#30340;&#31243;&#24207;&#12290;&#36825;&#37324;&#65292;&#25105;&#20204;&#21019;&#24314;&#20102;&#19977;&#20010;&#32447;&#31243;&#65292;&#35797;&#22270;&#32047;&#21152;&#21516;&#19968;&#20010;&#35745;&#25968;
&#22120; <span class="stt">x</span>&#12290;&#22914;&#26524;&#19968;&#20010;&#32447;&#31243;&#35835;&#21462;&#20102;&#35745;&#25968;&#22120;&#65292;&#20294;&#22312;&#26356;&#26032;&#35745;&#25968;&#22120;&#20043;&#21069;&#34987;&#25171;&#26029;&#65292;&#37027;&#20040;&#20004;&#20010;&#32447;&#31243;&#23558;&#25226;
&#35745;&#25968;&#22120;&#35774;&#32622;&#25104;&#21516;&#26679;&#30340;&#20540;&#12290;&#22240;&#27492;&#65292;&#35745;&#25968;&#22120;&#21487;&#33021;&#21464;&#25104; 2&#65292;&#29978;&#33267;&#26159; 1&#65292;&#32780;&#19981;&#26159; 3&#12290;
<a name="(idx._(gentag._893))"></a></p><p>&#25105;&#20204;&#24819;&#35201;&#30830;&#20445;&#19981;&#20250;&#21457;&#29983;&#36825;&#31181;&#28151;&#20081;&#12290;&#21516;&#26679;&#22320;&#65292;&#25105;&#20204;&#24819;&#35201;&#32452;&#32455;&#25105;&#20204;&#30340;&#31243;&#24207;&#65292;
&#36991;&#20813;<span class="EoplFigureRef"></span> &#20013;&#30340;&#31243;&#24207;&#31354;&#36716;&#12290;&#24688;&#24688;&#30456;&#21453;&#65292;&#23427;&#24212;&#35813;&#33021;&#22815;&#36827;&#20837;&#20241;&#30496;&#29366;&#24577;&#65292;&#24182;&#22312;&#29983;
&#20135;&#32773;&#21521;&#20849;&#20139;&#32531;&#23384;&#25554;&#20837;&#20540;&#26102;&#21796;&#37266;&#12290;</p><p><a name="(idx._(gentag._894))"></a>
<a name="(idx._(gentag._895))"></a>
<a name="(idx._(gentag._896))"></a>
&#26377;&#35768;&#22810;&#26041;&#24335;&#35774;&#35745;&#36825;&#31867;&#21516;&#27493;&#32452;&#20214;&#12290;&#19968;&#31181;&#31616;&#21333;&#30340;&#26041;&#24335;&#26159;&#20351;&#29992;<span class="emph">&#20114;&#26021;&#38145;</span> (<span class="emph">mutex exclusion</span>, <span class="emph">mutex</span>) &#25110;<span class="emph">&#20108;&#20803;&#20449;&#21495;&#37327;</span> (<span class="emph">binary semaphore</span>)&#12290;</p><p>&#20114;&#26021;&#38145;&#21487;&#33021;<span class="emph">&#25171;&#24320;</span> (<span class="emph">open</span>) &#25110;<span class="emph">&#20851;&#38381;</span> (<span class="emph">closed</span>)&#12290;&#23427;&#36824;&#21253;&#21547;&#19968;&#20010;&#31561;&#24453;&#20114;&#26021;&#38145;&#25171;
&#24320;&#30340;&#32447;&#31243;&#38431;&#21015;&#12290;&#20114;&#26021;&#38145;&#26377;&#19977;&#31181;&#25805;&#20316;&#65306;</p><ul><li><p><span class="stt">mutex</span>&#65292;&#26080;&#21442;&#25968;&#25805;&#20316;&#65292;&#21019;&#24314;&#19968;&#20010;&#21021;&#22987;&#29366;&#24577;&#20026;&#25171;&#24320;&#30340;&#20114;&#26021;&#38145;&#12290;</p></li><li><p><span class="stt">wait</span>&#65292;&#21333;&#21442;&#25968;&#25805;&#20316;&#65292;&#32447;&#31243;&#29992;&#23427;&#34920;&#26126;&#24819;&#35201;&#35775;&#38382;&#26576;&#19968;&#20114;&#26021;&#38145;&#12290;&#23427;&#30340;&#21442;&#25968;&#24517;&#39035;&#26159;&#19968;&#25226;
&#20114;&#26021;&#38145;&#12290;&#23427;&#30340;&#34892;&#20026;&#21462;&#20915;&#20110;&#20114;&#26021;&#38145;&#30340;&#29366;&#24577;&#12290;</p><ul><li><p>&#33509;&#20114;&#26021;&#38145;&#20851;&#38381;&#65292;&#24403;&#21069;&#32447;&#31243;&#25918;&#20837;&#20114;&#26021;&#38145;&#30340;&#31561;&#24453;&#38431;&#21015;&#20013;&#65292;&#24182;&#20013;&#27490;&#12290;&#25105;&#20204;&#35828;&#24403;&#21069;&#32447;
&#31243;<span class="emph">&#21463;&#38459;&#22622;</span>&#65292;&#31561;&#24453;&#36825;&#25226;&#20114;&#26021;&#38145;&#12290;</p></li><li><p>&#33509;&#20114;&#26021;&#38145;&#25171;&#24320;&#65292;&#21017;&#23558;&#20854;&#20851;&#38381;&#65292;&#24182;&#35753;&#24403;&#21069;&#32447;&#31243;&#32487;&#32493;&#25191;&#34892;&#12290;</p></li></ul><p><span class="stt">wait</span>&#30340;&#25191;&#34892;&#21482;&#27714;&#25928;&#26524;&#65307;&#23427;&#30340;&#36820;&#22238;&#20540;&#26410;&#23450;&#20041;&#12290;</p></li><li><p><span class="stt">signal</span>&#65292;&#21333;&#21442;&#25968;&#25805;&#20316;&#65292;&#32447;&#31243;&#29992;&#23427;&#34920;&#26126;&#20934;&#22791;&#37322;&#25918;&#26576;&#19968;&#20114;&#26021;&#38145;&#12290;&#23427;&#30340;&#21442;&#25968;&#24517;&#39035;&#26159;&#19968;
&#25226;&#20114;&#26021;&#38145;&#12290;</p><ul><li><p>&#33509;&#20114;&#26021;&#38145;&#20851;&#38381;&#65292;&#19988;&#31561;&#24453;&#38431;&#21015;&#20013;&#27809;&#26377;&#32447;&#31243;&#65292;&#21017;&#23558;&#20854;&#25171;&#24320;&#65292;&#24182;&#35753;&#24403;&#21069;&#32447;&#31243;&#32487;&#32493;&#25191;&#34892;&#12290;</p></li><li><p>&#33509;&#20114;&#26021;&#38145;&#20851;&#38381;&#65292;&#19988;&#31561;&#24453;&#38431;&#21015;&#20013;&#20173;&#26377;&#32447;&#31243;&#65292;&#21017;&#20174;&#20013;&#36873;&#20986;&#19968;&#20010;&#32447;&#31243;&#65292;&#25918;&#20837;&#35843;&#24230;&#22120;&#30340;&#31561;&#24453;
&#38431;&#21015;&#65292;&#20114;&#26021;&#38145;&#21017;&#20445;&#25345;&#20851;&#38381;&#12290;&#25191;&#34892; <span class="stt">signal</span> &#30340;&#32447;&#31243;&#32487;&#32493;&#35745;&#31639;&#12290;</p></li><li><p>&#33509;&#20114;&#26021;&#38145;&#25171;&#24320;&#65292;&#21017;&#20445;&#25345;&#25171;&#24320;&#65292;&#32447;&#31243;&#32487;&#32493;&#25191;&#34892;&#12290;</p></li></ul><p><span class="stt">signal</span>&#30340;&#25191;&#34892;&#21482;&#27714;&#25928;&#26524;&#65307;&#23427;&#30340;&#36820;&#22238;&#20540;&#26410;&#23450;&#20041;&#12290;<span class="stt">signal</span> &#25805;&#20316;&#24635;&#26159;&#25104;&#21151;&#65306;&#25191;&#34892;&#23427;&#30340;
&#32447;&#31243;&#20173;&#28982;&#26159;&#36816;&#34892;&#32447;&#31243;&#12290;</p></li></ul><p><a name="(idx._(gentag._897))"></a>
&#36825;&#20123;&#23646;&#24615;&#20445;&#35777;&#22312;&#19968;&#23545;&#36830;&#32493;&#30340; <span class="stt">wait</span> &#21644; <span class="stt">signal</span> &#20043;&#38388;&#65292;&#21482;&#26377;&#19968;&#20010;&#32447;&#31243;&#21487;&#20197;&#25191;&#34892;&#12290;&#36825;
&#37096;&#20998;&#31243;&#24207;&#21483;&#20570;<span class="emph">&#20851;&#38190;&#21306;&#22495;</span> (<span class="emph">critical region</span>)&#12290;&#22312;&#20851;&#38190;&#21306;&#22495;&#20869;&#65292;&#20004;&#20010;&#32447;&#31243;&#19981;&#21487;&#33021;&#21516;&#26102;
&#25191;&#34892;&#12290;&#20363;&#22914;&#65292;<span class="EoplFigureRef"></span> &#23637;&#31034;&#20102;&#25105;&#20204;&#20043;&#21069;&#30340;&#20363;&#23376;&#65292;&#21482;&#26159;&#22312;&#20851;&#38190;&#34892;&#21608;&#22260;&#25554;&#20837;&#20102;&#19968;
&#25226;&#20114;&#26021;&#38145;&#12290;&#22312;&#36825;&#20010;&#31243;&#24207;&#20013;&#65292;&#19968;&#27425;&#21482;&#26377;&#19968;&#20010;&#32447;&#31243;&#21487;&#20197;&#25191;&#34892; <span class="stt">set x = -(x,-1)</span>&#65307;&#25152;&#20197;&#35745;&#25968;
&#22120;&#19968;&#23450;&#33021;&#22815;&#21040;&#36798;&#32456;&#20540; 3&#12290;
<a name="(idx._(gentag._898))"></a></p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!t]</div><div class="SIntrapara"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let x = 0</span></p></td></tr><tr><td><p><span class="stt">in let mut = mutex()</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let incr_x = proc (id)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">wait(mut);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set x = -(x,-1);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">signal(mut)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn((incr_x 100));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn((incr_x 200));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">spawn((incr_x 300))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr></table></blockquote></div></p><blockquote class="caption"><p>&#20351;&#29992;&#20114;&#26021;&#38145;&#30340;&#23433;&#20840;&#35745;&#25968;&#22120;<a name="(elem._fig-5..21)"></a></p></blockquote></blockquote><p>&#25105;&#20204;&#29992;&#20004;&#20010;&#24341;&#29992;&#27169;&#25311;&#20114;&#26021;&#38145;&#65306;&#19968;&#20010;&#25351;&#21521;&#20854;&#29366;&#24577;&#65288;&#24320;&#21551;&#25110;&#20851;&#38381;&#65289;&#65292;&#19968;&#20010;&#25351;&#21521;&#31561;&#24453;&#36825;&#25226;&#38145;&#30340;&#32447;&#31243;
&#21015;&#34920;&#12290;&#25105;&#20204;&#36824;&#25226;&#20114;&#26021;&#38145;&#20316;&#20026;&#19968;&#31181;&#34920;&#36798;&#20540;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-datatype</span><span class="hspace">&nbsp;</span><span class="RktSym">mutex</span><span class="hspace">&nbsp;</span><span class="RktSym">mutex?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-mutex</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ref-to-closed?</span><span class="hspace">&nbsp;</span><span class="RktSym">reference?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ref-to-wait-queue</span><span class="hspace">&nbsp;</span><span class="RktSym">reference?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#25105;&#20204;&#32473; <span class="stt">value-of/k</span> &#28155;&#21152;&#36866;&#24403;&#30340;&#34892;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mutex-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">mutex-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">new-mutex</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#20854;&#20013;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">new-mutex</span></span> : <span class="texMathInline">\mathit{()} \to \mathit{Mutex}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">new-mutex</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-mutex</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p><span class="stt">wait</span> &#21644; <span class="stt">signal</span> &#20316;&#20026;&#26032;&#30340;&#21333;&#21442;&#25968;&#25805;&#20316;&#65292;&#21482;&#26159;&#35843;&#29992;&#36807;&#31243; <span class="stt">wait-for-mutex</span> &#21644;
<span class="stt">signal-mutex</span>&#12290;<span class="stt">wait</span> &#21644; <span class="stt">signal</span> &#37117;&#27714;&#20986;&#23427;&#20204;&#21807;&#19968;&#21442;&#25968;&#30340;&#20540;&#65292;&#25152;&#20197;&#65292;&#22312;
<span class="stt">apply-cont</span> &#20013;&#25105;&#20204;&#20889;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">wait-cont</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">wait-for-mutex</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;mutex</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">saved-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">52</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">signal-cont</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">signal-mutex</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;mutex</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">saved-cont</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">53</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#29616;&#22312;&#65292;&#25105;&#20204;&#21487;&#20197;&#20889;&#20986; <span class="stt">wait-for-mutex</span> &#21644; <span class="stt">signal-mutex</span>&#12290;&#36825;&#20123;&#36807;&#31243;&#21462;&#20004;&#20010;&#21442;&#25968;&#65306;
&#19968;&#20010;&#20114;&#26021;&#38145;&#65292;&#19968;&#20010;&#32447;&#31243;&#65292;&#20854;&#24037;&#20316;&#26041;&#24335;&#22914;&#19978;&#25152;&#36848;&#65288;<span class="EoplFigureRef"></span>&#65289;&#12290;</p><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">wait-for-mutex</span></span> : <span class="texMathInline">\mathit{Mutex} \times \mathit{Thread} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span style="font-weight: bold">&#29992;&#27861;</span> : <span class="stt">&#31561;&#24453;&#20114;&#26021;&#38145;&#24320;&#21551;&#65292;&#28982;&#21518;&#20851;&#38381;&#23427;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">wait-for-mutex</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m</span><span class="hspace">&nbsp;</span><span class="RktSym">th</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">mutex</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-mutex</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ref-to-closed?</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-wait-queue</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-closed?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-wait-queue</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">enqueue</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-wait-queue</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">th</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-next-thread</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-closed?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">th</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">signal-mutex</span></span> : <span class="texMathInline">\mathit{Mutex} \times \mathit{Thread} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">signal-mutex</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m</span><span class="hspace">&nbsp;</span><span class="RktSym">th</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">mutex</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-mutex</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ref-to-closed?</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-wait-queue</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">closed?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-closed?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">wait-queue</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-wait-queue</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktSym">closed?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">empty?</span><span class="hspace">&nbsp;</span><span class="RktSym">wait-queue</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="hspace">&nbsp;</span><span class="RktSym">ref-to-closed?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">th</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dequeue</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">wait-queue</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first-waiting-th</span><span class="hspace">&nbsp;</span><span class="RktSym">other-waiting-ths</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">place-on-ready-queue!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">first-waiting-th</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">ref-to-wait-queue</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">other-waiting-ths</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">th</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">th</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p><span class="stt">wait-for-mutex</span> &#21644; <span class="stt">signal-mutex</span>
<a name="(idx._(gentag._899))"></a>
<a name="(idx._(gentag._900))"></a>
<a name="(idx._(gentag._901))"></a><a name="(elem._fig-5..22)"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._902))"></a>
<a name="(idx._(gentag._903))"></a>
<a name="(idx._(gentag._904))"></a>
<a name="(idx._(gentag._905))"></a>
<a name="(idx._(gentag._906))"></a>
<a name="(idx._(gentag._907))"></a>
<a name="(idx._(gentag._908))"></a>
<a name="(idx._(gentag._909))"></a>
<a name="(idx._(gentag._910))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex5..45)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;&#26412;&#33410;&#30340;&#35821;&#35328;&#28155;&#21152;&#24418;&#24335; <span class="stt">yield</span>&#12290;&#32447;&#31243;&#19981;&#35770;&#20309;&#26102;&#25191;&#34892; <span class="stt">yield</span>&#65292;&#37117;&#23558;&#33258;&#36523;&#25918;&#20837;&#23601;&#32490;&#38431;
&#21015;&#20043;&#20013;&#65292;&#23601;&#32490;&#38431;&#21015;&#22836;&#37096;&#30340;&#32447;&#31243;&#25509;&#30528;&#25191;&#34892;&#12290;&#24403;&#32447;&#31243;&#32487;&#32493;&#26102;&#65292;&#23601;&#22909;&#20687;&#35843;&#29992; <span class="stt">yield</span> &#36820;&#22238;&#20102;
99&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..46)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22312;<span class="EoplExerciseRef"></span> &#30340;&#31995;&#32479;&#20013;&#65292;&#32447;&#31243;&#25918;&#20837;&#23601;&#32490;&#38431;&#21015;&#65292;&#26082;&#21487;&#33021;&#26159;&#22240;&#20026;&#32791;&#23613;&#26102;&#38388;&#29255;&#65292;&#20063;&#21487;
&#33021;&#26159;&#22240;&#20026;&#23427;&#36873;&#25321;&#35753;&#27493;&#12290;&#22312;&#21518;&#19968;&#31181;&#24773;&#20917;&#19979;&#65292;&#32447;&#31243;&#20250;&#20197;&#19968;&#20010;&#23436;&#25972;&#30340;&#26102;&#38388;&#29255;&#37325;&#21551;&#12290;&#20462;&#25913;&#31995;&#32479;&#65292;&#35753;&#23601;
&#32490;&#38431;&#21015;&#35760;&#24405;&#27599;&#20010;&#32447;&#31243;&#30340;&#21097;&#20313;&#26102;&#38388;&#29255;&#65288;&#22914;&#26524;&#26377;&#30340;&#35805;&#65289;&#65292;&#22312;&#32447;&#31243;&#37325;&#21551;&#26102;&#20173;&#20351;&#29992;&#21097;&#20313;&#30340;&#26102;&#38388;&#29255;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..47)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22914;&#26524;&#21097;&#20313;&#20004;&#20010;&#23376;&#32447;&#31243;&#65292;&#20108;&#32773;&#37117;&#22312;&#31561;&#24453;&#21478;&#19968;&#20010;&#23376;&#32447;&#31243;&#25345;&#26377;&#30340;&#20114;&#26021;&#38145;&#20250;&#24590;&#26679;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..48)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._911))"></a>
&#25105;&#20204;&#29992;&#36807;&#31243;&#34920;&#31034;&#32447;&#31243;&#12290;&#23558;&#20854;&#25913;&#20026;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#27861;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..49)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._912))"></a>
<a name="(idx._(gentag._913))"></a>
&#20026; THREADS &#23436;&#25104;<span class="EoplExerciseRef"></span>&#65288;&#29992;&#22534;&#26632;&#19978;&#30340;&#24103;&#34920;&#31034;&#32493;&#25991;&#65289;&#12290;
<a name="(idx._(gentag._914))"></a>
<a name="(idx._(gentag._915))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..50)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._916))"></a>
&#23492;&#23384;&#26412;&#33410;&#30340;&#35299;&#37322;&#22120;&#12290;&#24517;&#39035;&#23492;&#23384;&#30340;&#20114;&#36882;&#24402;&#23614;&#35843;&#29992;&#36807;&#31243;&#26377;&#21738;&#20123;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..51)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25105;&#20204;&#24819;&#35201;&#32452;&#32455;&#25105;&#20204;&#30340;&#31243;&#24207;&#65292;&#36991;&#20813;<span class="EoplFigureRef"></span> &#20013;&#30340;&#31243;&#24207;&#31354;&#36716;&#12290;&#24688;&#24688;&#30456;&#21453;&#65292;&#23427;&#24212;&#35813;
&#33021;&#22815;&#36827;&#20837;&#20241;&#30496;&#29366;&#24577;&#65292;&#24182;&#22312;&#29983;&#20135;&#32773;&#21521;&#20849;&#20139;&#32531;&#23384;&#25554;&#20837;&#20540;&#26102;&#21796;&#37266;&#12290;&#29992;&#20855;&#26377;&#20114;&#26021;&#38145;&#30340;&#31243;&#24207;&#23436;&#25104;&#36825;&#20123;&#65292;
&#25110;&#32773;&#23454;&#29616;&#19968;&#31181;&#21516;&#27493;&#25805;&#20316;&#31526;&#23436;&#25104;&#36825;&#20123;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..52)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986;&#20351;&#29992;&#20114;&#26021;&#38145;&#30340;&#31243;&#24207;&#65292;&#22914;<span class="EoplFigureRef"></span>&#65292;&#20294;&#20027;&#32447;&#31243;&#31561;&#24453;&#25152;&#26377;&#19977;&#20010;&#23376;&#32447;&#31243;&#32467;&#26463;&#65292;
&#28982;&#21518;&#36820;&#22238; <span class="stt">x</span> &#30340;&#20540;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..53)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;&#32447;&#31243;&#30340;&#34920;&#31034;&#65292;&#28155;&#21152;<span class="emph">&#32447;&#31243;&#25551;&#36848;&#31526;</span> (<span class="emph">thread identifier</span>)&#12290;&#27599;&#20010;&#26032;&#32447;&#31243;&#37117;&#26377;&#19968;&#20010;&#26032;
&#30340;&#32447;&#31243;&#25551;&#36848;&#31526;&#12290;&#24403;&#23376;&#32447;&#31243;&#21019;&#24314;&#26102;&#65292;&#20256;&#32473;&#23427;&#30340;&#19981;&#26159;&#26412;&#33410;&#20013;&#30340;&#20219;&#24847;&#20540; 28&#65292;&#32780;&#26159;&#23427;&#30340;&#32447;&#31243;&#25551;&#36848;&#31526;&#12290;
&#23376;&#32447;&#31243;&#30340;&#25551;&#36848;&#31526;&#20063;&#20316;&#20026; <span class="stt">spawn</span> &#34920;&#36798;&#24335;&#30340;&#20540;&#36820;&#22238;&#32473;&#29238;&#32447;&#31243;&#12290;&#32473;&#35299;&#37322;&#22120;&#28155;&#21152;&#36741;&#21161;&#32452;&#20214;&#65292;&#36319;
&#36394;&#32447;&#31243;&#25551;&#36848;&#31526;&#30340;&#21019;&#24314;&#12290;&#39564;&#35777;&#23601;&#32490;&#38431;&#21015;&#20013;&#19968;&#20010;&#32447;&#31243;&#25551;&#36848;&#31526;&#33267;&#22810;&#20986;&#29616;&#19968;&#27425;&#12290;&#23376;&#32447;&#31243;&#22914;&#20309;&#33719;&#30693;&#29238;&#32447;
&#31243;&#30340;&#25551;&#36848;&#31526;&#65311;&#21407;&#31243;&#24207;&#30340;&#32447;&#31243;&#25551;&#36848;&#31526;&#24212;&#22914;&#20309;&#22788;&#29702;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..54)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;<span class="EoplExerciseRef"></span> &#30340;&#35299;&#37322;&#22120;&#28155;&#21152;&#32452;&#20214; <span class="stt">kill</span>&#12290;<span class="stt">kill</span> &#32467;&#26500;&#21462;&#19968;&#32447;&#31243;&#21495;&#65292;&#22312;
&#23601;&#32490;&#38431;&#21015;&#25110;&#25152;&#26377;&#31561;&#24453;&#38431;&#21015;&#20013;&#25214;&#20986;&#23545;&#24212;&#30340;&#32447;&#31243;&#65292;&#28982;&#21518;&#21024;&#38500;&#23427;&#12290;&#27492;&#22806;&#65292;&#24403;&#23427;&#25214;&#21040;&#30446;&#26631;&#32447;&#31243;&#26102;&#65292;&#36820;
&#22238;&#30495;&#65307;&#22312;&#25152;&#26377;&#38431;&#21015;&#20013;&#37117;&#25214;&#19981;&#21040;&#25351;&#23450;&#32447;&#31243;&#21495;&#26102;&#65292;&#36820;&#22238;&#20551;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..55)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;<span class="EoplExerciseRef"></span> &#30340;&#35299;&#37322;&#22120;&#28155;&#21152;&#32447;&#31243;&#36890;&#20449;&#32452;&#20214;&#65292;&#19968;&#20010;&#32447;&#31243;&#21487;&#20197;&#29992;&#21478;&#19968;&#32447;&#31243;&#30340;&#25551;&#36848;&#31526;
&#32473;&#23427;&#21457;&#36865;&#19968;&#20010;&#20540;&#12290;&#32447;&#31243;&#21487;&#20197;&#36873;&#25321;&#25509;&#25910;&#28040;&#24687;&#65292;&#27809;&#26377;&#32447;&#31243;&#32473;&#23427;&#21457;&#28040;&#24687;&#26102;&#21487;&#20197;&#38459;&#22622;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..56)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;<span class="EoplExerciseRef"></span> &#30340;&#35299;&#37322;&#22120;&#65292;&#19981;&#35201;&#20351;&#29992;&#20849;&#20139;&#23384;&#20648;&#22120;&#65292;&#32780;&#26159;&#35753;&#27599;&#20010;&#32447;&#31243;&#20855;&#26377;&#33258;&#24049;&#30340;
&#23384;&#20648;&#22120;&#12290;&#22312;&#36825;&#31181;&#35821;&#35328;&#20013;&#65292;&#20960;&#20046;&#21487;&#20197;&#25490;&#38500;&#20114;&#26021;&#38145;&#12290;&#37325;&#20889;&#26412;&#33410;&#35821;&#35328;&#30340;&#31034;&#20363;&#31243;&#24207;&#65292;&#20294;&#19981;&#29992;&#20114;&#26021;&#38145;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..57)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22312;&#20320;&#26368;&#29233;&#30340;&#25805;&#20316;&#31995;&#32479;&#25945;&#26448;&#20013;&#65292;&#26377;&#21508;&#31181;&#21508;&#26679;&#30340;&#21516;&#27493;&#26426;&#21046;&#12290;&#25361;&#20986;&#19977;&#31181;&#65292;&#22312;&#26412;&#33410;&#30340;&#26694;&#26550;&#19979;&#23454;&#29616;&#23427;&#20204;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex5..58)"></a><span class="texMathInline">\textnormal{[}<span class="emph">&#32477;&#23545;</span> <span class="texMathInline">{\star}</span>\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._917))"></a>
&#21644;&#26379;&#21451;&#21507;&#20123;&#25259;&#33832;&#21543;&#65292;&#20294;&#26159;&#19968;&#20154;&#19968;&#27425;&#19968;&#23450;&#21482;&#25343;&#19968;&#22359;&#65281;</p></blockquote><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="state.html" title="backward to &quot;4 状态&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;编程语言要素&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="cps.html" title="forward to &quot;6 续文传递风格&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>