<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>6&nbsp;续文传递风格</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="tip.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript">
(function() {
  document.write('<link rel="stylesheet" href="katex/katex.min.css" />');
})();(function() {document.write('<scr' + 'ipt type="text/javascript" src="katex/katex.min.js"></scr' + 'ipt>');})();(function(f) {
  // A "simple" onLoad function
  if (window.document.readyState == "complete") {
    f();
  } else if (window.document.addEventListener) {
    window.document.addEventListener("DOMContentLoaded", f, false);
  } else if (window.attachEvent) {
    window.attachEvent("onreadystatechange", function() {
      if (window.document.readyState == "complete") {
        f();
      }
    });
  } else {
    var oldLoad = window.onload;
    if (typeof(oldLoad) == "function") {
      window.onload = function() {
        try {
          oldLoad();
        } finally {
          f();
        }
      };
    } else {
      window.onload = f;
    }
  }
})(function() {
  // This is an ugly way to change the doctype, in case the scribble document
  // did not use (with-html5).
  if (!(document.doctype && document.doctype.publicId == '')) {
    if (console && console.log) {
      console.log("Re-wrote the document to use the HTML5 doctype.\n"
                  + "  Consider using the following declaration:\n"
                  + "      @title[#:style (with-html5 manual-doc-style)]{…}");
    }
    var wholeDoc = '<!doctype HTML>\n' + document.documentElement.outerHTML;
    document.open();
    document.clear();
    document.write(wholeDoc);
  }
  var inlineElements = document.getElementsByClassName("texMathInline");
  for (var i = 0; i < inlineElements.length; i++) {
    var e = inlineElements[i];
    katex.render(e.textContent, e, { displayMode:false, throwOnError:false });
  }
  var displayElements = document.getElementsByClassName("texMathDisplay");
  for (var i = 0; i < displayElements.length; i++) {
    var e = displayElements[i];
    katex.render(e.textContent, e, { displayMode:true, throwOnError:false });
  }
});
</script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">&#32534;&#31243;&#35821;&#35328;&#35201;&#32032;</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="fw-trans.html" class="tocviewlink" data-pltdoc="x">&#35793;&#32773;&#30340;&#35805;</a></td></tr><tr><td align="right"></td><td><a href="glo.html" class="tocviewlink" data-pltdoc="x">&#35793;&#21517;&#34920;</a></td></tr><tr><td align="right"></td><td><a href="fw.html" class="tocviewlink" data-pltdoc="x">&#24207;</a></td></tr><tr><td align="right"></td><td><a href="pf.html" class="tocviewlink" data-pltdoc="x">&#21069;&#35328;</a></td></tr><tr><td align="right"></td><td><a href="awk.html" class="tocviewlink" data-pltdoc="x">&#33268;&#35874;</a></td></tr><tr><td align="right">1&nbsp;</td><td><a href="isd.html" class="tocviewlink" data-pltdoc="x">&#24402;&#32435;&#24335;&#25968;&#25454;&#38598;</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="da.html" class="tocviewlink" data-pltdoc="x">&#25968;&#25454;&#25277;&#35937;</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="expr.html" class="tocviewlink" data-pltdoc="x">&#34920;&#36798;&#24335;</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="state.html" class="tocviewlink" data-pltdoc="x">&#29366;&#24577;</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="cpi.html" class="tocviewlink" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="types.html" class="tocviewlink" data-pltdoc="x">&#31867;&#22411;</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="modules.html" class="tocviewlink" data-pltdoc="x">&#27169;&#22359;</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="oac.html" class="tocviewlink" data-pltdoc="x">&#23545;&#35937;&#21644;&#31867;</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="further-reading.html" class="tocviewlink" data-pltdoc="x">&#25193;&#23637;&#38405;&#35835;</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="sllgen-parsing-system.html" class="tocviewlink" data-pltdoc="x">SLLGEN&#35299;&#26512;&#31995;&#32479;</a></td></tr><tr><td align="right"></td><td><a href="bib.html" class="tocviewlink" data-pltdoc="x">&#21442;&#32771;&#20070;&#30446;</a></td></tr><tr><td align="right"></td><td><a href="indices.html" class="tocviewlink" data-pltdoc="x">&#32034;&#24341;</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>6&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">6.1&nbsp;</td><td><a href="#%28part._s6..1%29" class="tocviewlink" data-pltdoc="x">&#20889;&#20986;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#30340;&#31243;&#24207;</a></td></tr><tr><td align="right">6.2&nbsp;</td><td><a href="#%28part._s6..2%29" class="tocviewlink" data-pltdoc="x">&#23614;&#24335;</a></td></tr><tr><td align="right">6.3&nbsp;</td><td><a href="#%28part._s6..3%29" class="tocviewlink" data-pltdoc="x">&#36716;&#25442;&#20026;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</a></td></tr><tr><td align="right">6.4&nbsp;</td><td><a href="#%28part._s6..4%29" class="tocviewlink" data-pltdoc="x">&#24314;&#27169;&#35745;&#31639;&#25928;&#26524;</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">6.1<tt>&nbsp;</tt></span><a href="#%28part._s6..1%29" class="tocsubseclink" data-pltdoc="x">&#20889;&#20986;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#30340;&#31243;&#24207;</a></td></tr><tr><td><span class="tocsublinknumber">6.2<tt>&nbsp;</tt></span><a href="#%28part._s6..2%29" class="tocsubseclink" data-pltdoc="x">&#23614;&#24335;</a></td></tr><tr><td><span class="tocsublinknumber">6.3<tt>&nbsp;</tt></span><a href="#%28part._s6..3%29" class="tocsubseclink" data-pltdoc="x">&#36716;&#25442;&#20026;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</a></td></tr><tr><td><span class="tocsublinknumber">6.4<tt>&nbsp;</tt></span><a href="#%28part._s6..4%29" class="tocsubseclink" data-pltdoc="x">&#24314;&#27169;&#35745;&#31639;&#25928;&#26524;</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="cpi.html" title="backward to &quot;5 传递续文的解释器&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;编程语言要素&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="types.html" title="forward to &quot;7 类型&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>6<tt>&nbsp;</tt><a name="(part._cps)"></a>&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</h3><p><a name="(idx._(gentag._918))"></a>
<a name="(idx._(gentag._919))"></a>
&#22312;<a href="cpi.html" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a>&#65292;&#25105;&#20204;&#25226;&#35299;&#37322;&#22120;&#20013;&#30340;&#25152;&#26377;&#20027;&#35201;&#36807;&#31243;&#35843;&#29992;&#37325;&#20889;&#25104;<span class="emph">&#23614;&#35843;&#29992;</span>&#12290;&#36825;&#26679;&#65292;&#25105;&#20204;
&#20445;&#35777;&#20219;&#20309;&#26102;&#20505;&#65292;&#19981;&#35770;&#25191;&#34892;&#30340;&#31243;&#24207;&#22810;&#22823;&#25110;&#22810;&#22797;&#26434;&#65292;&#35299;&#37322;&#22120;&#21482;&#20351;&#29992;&#26377;&#38480;&#30340;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;&#36825;&#31181;&#24615;&#36136;
&#21483;&#20570;<span class="emph">&#36845;&#20195;&#24615;&#25511;&#21046;&#34892;&#20026;</span>&#12290;
<a name="(idx._(gentag._920))"></a></p><p><a name="(idx._(gentag._921))"></a>
&#25105;&#20204;&#36890;&#36807;&#32473;&#27599;&#20010;&#36807;&#31243;&#22810;&#20256;&#19968;&#20010;<span class="emph">&#32493;&#25991;</span>&#21442;&#25968;&#23454;&#29616;&#36825;&#19968;&#30446;&#26631;&#12290;&#36825;&#31181;&#32534;&#31243;&#39118;&#26684;
&#21483;&#20570;<span class="emph">&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</span> (<span class="emph">continuation-passing style</span>) &#25110; <span class="emph">CPS</span>&#65292;&#19988;&#19981;&#38480;
&#20110;&#35299;&#37322;&#22120;&#12290;</p><p>&#26412;&#31456;&#65292;&#25105;&#20204;&#20171;&#32461;&#19968;&#31181;&#31995;&#32479;&#24615;&#30340;&#26041;&#27861;&#65292;&#23558;&#20219;&#19968;&#36807;&#31243;&#36716;&#25442;&#20026;&#20855;&#26377;&#36845;&#20195;&#24615;&#25511;&#21046;&#34892;&#20026;&#30340;&#31561;&#25928;&#36807;&#31243;&#12290;&#23454;
&#29616;&#36825;&#19968;&#28857;&#38656;&#35201;&#23558;&#36807;&#31243;&#36716;&#25442;&#20026;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#12290;</p><h4>6.1<tt>&nbsp;</tt><a name="(part._s6..1)"></a>&#20889;&#20986;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#30340;&#31243;&#24207;</h4><p><a name="(idx._(gentag._922))"></a>
&#38500;&#20102;&#20889;&#35299;&#37322;&#22120;&#65292;CPS &#36824;&#26377;&#21035;&#30340;&#20316;&#29992;&#12290;&#25105;&#20204;&#32771;&#34385;&#8220;&#32769;&#29087;&#20154;&#8221;&#38454;&#20056;&#31243;&#24207;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#38454;&#20056;&#30340;&#20256;&#36882;&#32493;&#25991;&#29256;&#26412;&#26159;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact/k</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact/k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#20854;&#20013;&#65292;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (end-cont) </span><span class="texMathInline">val</span><span class="stt">) = </span><span class="texMathInline">val</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (fact1-cont </span><span class="texMathInline">n</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt">) = </span><span class="texMathInline">val</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">= (apply-cont </span><span class="texMathInline">cont</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(* </span><span class="texMathInline">n</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">val</span><span class="stt">))</span></p></td></tr></table></blockquote></blockquote><p>&#22312;&#36825;&#19968;&#29256;&#20869;&#65292;<span class="stt">fact/k</span> &#21644; <span class="stt">apply-cont</span> &#20013;&#30340;&#25152;&#26377;&#35843;&#29992;&#37117;&#22312;&#26411;&#23614;&#65292;&#22240;&#27492;&#19981;&#20135;&#29983;&#25511;&#21046;
&#19978;&#19979;&#25991;&#12290;</p><p><a name="(idx._(gentag._923))"></a>
<a name="(idx._(gentag._924))"></a>
&#25105;&#20204;&#21487;&#20197;&#29992;&#25968;&#25454;&#32467;&#26500;&#23454;&#29616;&#36825;&#20123;&#32493;&#25991;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-datatype</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">integer?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact1-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-n</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-n</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p><a name="(idx._(gentag._925))"></a>
&#25105;&#20204;&#36824;&#33021;&#20197;&#22810;&#31181;&#26041;&#24335;&#36716;&#25442;&#36825;&#19968;&#31243;&#24207;&#65292;&#27604;&#22914;&#23492;&#23384;&#23427;&#65292;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;</p><p><a name="(idx._(gentag._926))"></a>
&#25105;&#20204;&#29978;&#33267;&#33021;&#23558;&#20854;&#36716;&#20026;&#36339;&#36291;&#24335;&#65292;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;&#22914;&#26524;&#29992;&#26222;&#36890;&#30340;&#25351;&#20196;&#24335;&#35821;&#35328;&#65292;
&#25105;&#20204;&#33258;&#28982;&#33021;&#23558;&#36339;&#24202;&#26367;&#25442;&#20026;&#36866;&#24403;&#30340;&#24490;&#29615;&#12290;
<a name="(idx._(gentag._927))"></a></p><p><a name="(idx._(gentag._928))"></a>
&#20294;&#26159;&#65292;&#26412;&#31456;&#25105;&#20204;&#20027;&#35201;&#20851;&#24515;&#65292;&#29992;&#36807;&#31243;&#34920;&#31034;&#27861;&#65288;&#22914;<span class="EoplFigureRef"></span>&#65289;&#26102;&#20250;&#21457;&#29983;&#20160;&#20040;&#12290;&#22238;&#24518;
&#19968;&#19979;&#65292;&#22312;&#36807;&#31243;&#34920;&#31034;&#27861;&#20013;&#65292;&#32493;&#25991;&#29992;&#23427;&#22312; <span class="stt">apply-cont</span> &#20013;&#30340;&#21160;&#20316;&#34920;&#31034;&#12290;&#36807;&#31243;&#34920;&#31034;&#20026;&#65306;
<a name="(idx._(gentag._929))"></a></p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">end-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">arg-n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">arg-n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact/k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact/k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact1-cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">saved-n</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-n</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p>&#23492;&#23384;&#21518;&#30340; <span class="stt">fact/k</span>
<a name="(idx._(gentag._930))"></a><a name="(elem._fig-6..1)"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._931))"></a>
&#25105;&#20204;&#36824;&#21487;&#20197;&#26356;&#36827;&#19968;&#27493;&#65292;&#23558;&#31243;&#24207;&#20013;&#25152;&#26377;&#35843;&#29992;&#32493;&#25991;&#26500;&#36896;&#22120;&#30340;&#22320;&#26041;&#26367;&#25442;&#20026;&#20854;&#23450;&#20041;&#12290;&#22240;&#20026;&#23450;&#20041;&#22312;&#34892;&#20869;
&#23637;&#24320;&#65292;&#36825;&#19968;&#36716;&#25442;&#21483;&#20570;<span class="emph">&#20869;&#32852;</span> (<span class="emph">inlining</span>)&#12290;&#25105;&#20204;&#36824;&#35201;&#20869;&#32852; <span class="stt">apply-cont</span> &#30340;&#35843;&#29992;&#65292;
&#19981;&#20877;&#20889; <span class="stt">(apply-cont cont val)</span>&#65292;&#32780;&#26159;&#30452;&#25509;&#20889; <span class="stt">(cont val)</span>&#12290;</p><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">pc</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">arg-n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">arg-n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">pc</span><span class="hspace">&nbsp;</span><span class="RktSym">fact/k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">trampoline!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">trampoline!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure?</span><span class="hspace">&nbsp;</span><span class="RktSym">pc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">trampoline!</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">pc</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">pc</span><span class="hspace">&nbsp;</span><span class="RktSym">fact/k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">continuation</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">pc</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">pc</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p>&#23492;&#23384;&#21518;&#30340;&#36339;&#36291;&#24335; <span class="stt">fact/k</span>
<a name="(idx._(gentag._932))"></a><a name="(elem._fig-6..2)"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._933))"></a>
&#22914;&#26524;&#25105;&#20204;&#25353;&#36825;&#31181;&#26041;&#24335;&#20869;&#32852;&#25152;&#26377;&#29992;&#21040;&#32493;&#25991;&#30340;&#22320;&#26041;&#65292;&#25105;&#20204;&#24471;&#21040;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact/k</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact/k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p><span class="stt">fact/k</span> &#30340;&#23450;&#20041;&#21487;&#20197;&#35835;&#20316;&#65306;</p><blockquote><p><span class="emph">&#33509; <span class="texMathInline">n</span> &#20026; 0&#65292;&#23558; 1 &#20256;&#32473;&#32493;&#25991;&#65307;&#21542;&#21017;&#65292;&#27714; <span class="texMathInline">n-1</span> &#30340; <span class="stt">fact</span>&#65292;&#27714;&#20540;&#25152;&#22312;&#30340;&#32493;&#25991;&#65292;&#21462;
&#20854;&#32467;&#26524; <span class="stt">val</span>&#65292;&#28982;&#21518;&#23558; <span class="stt">(* </span><span class="texMathInline">n</span><span class="stt"> val)</span> &#30340;&#20540;&#20256;&#32473;&#24403;&#21069;&#32493;&#25991;&#12290;
</span></p></blockquote><p><a name="(idx._(gentag._934))"></a>
&#36807;&#31243; <span class="stt">fact/k</span> &#20855;&#26377;&#24615;&#36136; <span class="stt">(fact/k </span><span class="texMathInline">n</span><span class="stt"> </span><span class="texMathInline">g</span><span class="stt">) = (</span><span class="texMathInline">g</span><span class="stt"> </span><span class="texMathInline">n!</span><span class="stt">)</span>&#12290;&#23545; <span class="texMathInline">n</span>
&#20351;&#29992;&#24402;&#32435;&#27861;&#24456;&#23481;&#26131;&#35777;&#26126;&#36825;&#26465;&#24615;&#36136;&#12290;&#31532;&#19968;&#27493;&#65292;&#24403; <span class="texMathInline">n = 0</span>&#65292;&#25105;&#20204;&#35745;&#31639;&#65306;</p><blockquote class="SubFlow"><blockquote class="Small"><blockquote class="SCodeFlow"><p><span class="stt">(fact/k 0 </span><span class="texMathInline">g</span><span class="stt">) = (</span><span class="texMathInline">g</span><span class="stt"> 1) = (</span><span class="texMathInline">g</span><span class="stt"> (fact 0))</span></p></blockquote></blockquote><p>&#24402;&#32435;&#27493;&#39588;&#20013;&#65292;&#23545;&#26576;&#20010; <span class="texMathInline">n</span>&#65292;&#35774; <span class="stt">(fact/k </span><span class="texMathInline">n</span><span class="stt"> </span><span class="texMathInline">g</span><span class="stt">) = (</span><span class="texMathInline">g</span><span class="stt"> </span><span class="texMathInline">n!</span><span class="stt">)</span>&#65292;&#35797;&#35777;&#26126;
<span class="stt">(fact/k </span><span class="texMathInline">(n + 1)</span><span class="stt"> </span><span class="texMathInline">g</span><span class="stt">) = (</span><span class="texMathInline">g</span><span class="stt"> </span><span class="texMathInline">(n + 1)!</span><span class="stt">)</span>&#12290;&#35201;&#35777;&#26126;&#23427;&#65292;&#25105;&#20204;&#35745;&#31639;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(fact/k </span><span class="texMathInline">n + 1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">g</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (fact/k </span><span class="texMathInline">n</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(lambda (val) (</span><span class="texMathInline">g</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(* </span><span class="texMathInline">n + 1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">val))))</span></p></td></tr><tr><td><p><span class="stt">= ((lambda (val) (</span><span class="texMathInline">g</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(* </span><span class="texMathInline">n + 1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">val)))</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span>&#65288;&#26681;&#25454;&#24402;&#32435;&#20551;&#35774;&#65289;<span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">(fact </span><span class="texMathInline">n</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt">= (</span><span class="texMathInline">g</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(* </span><span class="texMathInline">n + 1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(fact </span><span class="texMathInline">n</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt">= (</span><span class="texMathInline">g</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(fact </span><span class="texMathInline">n + 1</span><span class="stt">))</span></p></td></tr></table></blockquote><p>&#24402;&#32435;&#23436;&#27605;&#12290;</p></blockquote><p>&#20687;<a href="isd.html#%28part._s1..3%29" data-pltdoc="x">&#36741;&#21161;&#36807;&#31243;&#21644;&#19978;&#19979;&#25991;&#21442;&#25968;</a>&#19968;&#26679;&#65292;&#36825;&#37324;&#30340; <span class="texMathInline">g</span> &#26159;&#19978;&#19979;&#25991;&#21442;&#25968;&#65307;&#24615;&#36136; <span class="stt">(fact/k </span><span class="texMathInline">n</span><span class="stt"> </span><span class="texMathInline">g</span><span class="stt">) =</span><span class="stt">
</span><span class="stt">(</span><span class="texMathInline">g</span><span class="stt"> </span><span class="texMathInline">n!</span><span class="stt">)</span> &#20316;&#20026;&#29420;&#31435;&#35268;&#33539;&#65292;&#36981;&#24490;&#25105;&#20204;&#30340;&#21407;&#21017;<a href="isd.html#%28elem._no-myth%29" data-pltdoc="x"><span style="font-weight: bold">&#36991;&#20813;&#31070;&#31192;&#23567;&#24037;&#20855;</span></a>&#12290;
<a name="(idx._(gentag._935))"></a>
<a name="(idx._(gentag._936))"></a></p><p><a name="(idx._(gentag._937))"></a>
&#29616;&#22312;&#65292;&#25105;&#20204;&#29992;&#21516;&#26679;&#30340;&#26041;&#24335;&#36716;&#25442;&#35745;&#31639;&#26000;&#27874;&#37027;&#22865;&#25968;&#21015;&#30340; <span class="stt">fib</span>&#12290;&#25105;&#20204;&#20174;&#19979;&#38754;&#30340;&#36807;&#31243;&#24320;&#22987;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fib</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#36825;&#37324;&#25105;&#20204;&#20004;&#27425;&#36882;&#24402;&#35843;&#29992; <span class="stt">fib</span>&#65292;&#25152;&#20197;&#25105;&#20204;&#38656;&#35201;&#19968;&#20010; <span class="stt">end-cont</span> &#21644;&#20004;&#20010;&#32493;&#25991;&#26500;&#36896;&#22120;&#65292;
&#20108;&#32773;&#21508;&#23545;&#24212;&#19968;&#20010;&#21442;&#25968;&#65292;&#23601;&#20687;&#22788;&#29702;<a href="cpi.html#%28part._s5..1%29" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a>&#20013;&#30340;&#24046;&#20540;&#34920;&#36798;&#24335;&#37027;&#26679;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fib</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib/k</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end-cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fib/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib/k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib1-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (end-cont) </span><span class="texMathInline">val</span><span class="stt">) = </span><span class="texMathInline">val</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (fib1-cont </span><span class="texMathInline">n</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (fib/k (- </span><span class="texMathInline">n</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">2) (fib2-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(apply-cont (fib2-cont </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">cont</span><span class="stt">) </span><span class="texMathInline">val2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (apply-cont </span><span class="texMathInline">cont</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(+ </span><span class="texMathInline">val1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">val2</span><span class="stt">))</span></p></td></tr></table></blockquote><p><a name="(idx._(gentag._938))"></a>
<a name="(idx._(gentag._939))"></a>
&#22312;&#36807;&#31243;&#34920;&#31034;&#27861;&#20013;&#65292;&#25105;&#20204;&#26377;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">end-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fib1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib/k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib2-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fib2-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#22914;&#26524;&#25105;&#20204;&#20869;&#32852;&#25152;&#26377;&#20351;&#29992;&#36825;&#20123;&#36807;&#31243;&#30340;&#22320;&#26041;&#65292;&#21487;&#24471;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fib</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib/k</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fib/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib/k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib/k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#31867;&#20284;&#38454;&#20056;&#65292;&#25105;&#20204;&#21487;&#20197;&#25226;&#36825;&#20010;&#23450;&#20041;&#35835;&#20316;&#65306;</p><blockquote><p><span class="emph">&#33509; <span class="texMathInline">n &lt; 2</span>&#65292;&#23558; 1 &#20256;&#32473;&#32493;&#25991;&#12290;&#21542;&#21017;&#65292;&#22788;&#29702; <span class="texMathInline">n-1</span>&#65292;&#27714;&#20540;&#25152;&#22312;&#30340;&#32493;&#25991;&#65292;&#21462;&#20854;&#32467;&#26524;
<span class="stt">val1</span>&#65292;&#28982;&#21518;&#22788;&#29702; <span class="stt">val2</span>&#65292;&#27714;&#20540;&#25152;&#22312;&#30340;&#32493;&#25991;&#65292;&#21462;&#20854;&#32467;&#26524; <span class="stt">val2</span>&#65292;&#28982;&#21518;&#23558; <span class="stt">(+
val1 val2)</span> &#30340;&#20540;&#20256;&#32473;&#24403;&#21069;&#32493;&#25991;&#12290;
<a name="(idx._(gentag._940))"></a></span></p></blockquote><p>&#29992;&#25512;&#23548; <span class="stt">fact</span> &#30340;&#26041;&#24335;&#65292;&#24456;&#23481;&#26131;&#24471;&#20986;&#65292;&#23545;&#20219;&#24847; <span class="texMathInline">g</span>&#65292;<span class="stt">(fib/k </span><span class="texMathInline">n</span><span class="stt"> </span><span class="texMathInline">g</span><span class="stt">) =</span><span class="stt">
</span><span class="stt">(</span><span class="texMathInline">g</span><span class="stt"> (fib </span><span class="texMathInline">n</span><span class="stt">))</span>&#12290;&#36825;&#37324;&#26377;&#20010;&#20551;&#24819;&#30340;&#20363;&#23376;&#65292;&#25512;&#24191;&#20102;&#36825;&#19968;&#24819;&#27861;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">17</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">33</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">44</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#21464;&#25104;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktVal">17</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktVal">33</span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">44</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#20854;&#20013;&#65292;&#36807;&#31243; <span class="stt">f</span>&#12289;<span class="stt">g</span> &#21644; <span class="stt">h</span> &#37117;&#20197;&#31867;&#20284;&#26041;&#24335;&#36716;&#25442;&#12290;</p><ul><li><p>&#22312; <span class="stt">(zero? x)</span> &#36825;&#19968;&#34892;&#65292;&#25105;&#20204;&#23558; 17 &#36820;&#22238;&#32473;&#32493;&#25991;&#12290;</p></li><li><p>&#22312; <span class="stt">(= x 1)</span> &#36825;&#19968;&#34892;&#65292;&#25105;&#20204;&#25353;&#23614;&#36882;&#24402;&#30340;&#26041;&#24335;&#35843;&#29992; <span class="stt">f</span>&#12290;</p></li><li><p>&#22312; <span class="stt">(= x 2)</span> &#36825;&#19968;&#34892;&#65292;&#25105;&#20204;&#22312;&#21152;&#27861;&#30340;&#25805;&#20316;&#25968;&#20301;&#32622;&#35843;&#29992; <span class="stt">f</span>&#12290;</p></li><li><p>&#22312; <span class="stt">(= x 3)</span> &#36825;&#19968;&#34892;&#65292;&#25105;&#20204;&#22312;&#36807;&#31243;&#35843;&#29992;&#30340;&#25805;&#20316;&#25968;&#20301;&#32622;&#35843;&#29992; <span class="stt">f</span>&#12290;</p></li><li><p>&#22312; <span class="stt">(= x 4)</span> &#36825;&#19968;&#34892;&#65292;&#26377;&#20004;&#20010;&#36807;&#31243;&#35843;&#29992;&#22312;&#21152;&#27861;&#30340;&#25805;&#20316;&#25968;&#20301;&#32622;&#12290;</p></li><li><p>&#22312; <span class="stt">else</span> &#36825;&#19968;&#34892;&#65292;&#26377;&#20004;&#20010;&#36807;&#31243;&#35843;&#29992;&#22312;&#21478;&#19968;&#20010;&#36807;&#31243;&#35843;&#29992;&#20869;&#30340;&#25805;&#20316;&#25968;&#20301;&#32622;&#12290;</p></li></ul></blockquote><p>&#20174;&#36825;&#20123;&#20363;&#23376;&#20013;&#28014;&#29616;&#20986;&#19968;&#31181;&#27169;&#24335;&#12290;</p><blockquote class="Tip"><blockquote class="SCentered"><p><a name="(elem._cps-recipe)"></a><span style="font-weight: bold">CPS &#31192;&#26041;</span>
<a name="(idx._(gentag._941))"></a>
<a name="(idx._(gentag._942))"></a></p></blockquote><blockquote class="TipContent"><p>&#35201;&#23558;&#31243;&#24207;&#36716;&#25442;&#20026;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#65306;</p><ol><li><p>&#32473;&#27599;&#20010;&#36807;&#31243;&#20256;&#19968;&#20010;&#39069;&#22806;&#21442;&#25968;&#65288;&#36890;&#24120;&#26159; <span class="stt">cont</span> &#25110; <span class="stt">k</span>&#65289;&#12290;</p></li><li><p>&#19981;&#35770;&#36807;&#31243;&#36820;&#22238;&#24120;&#37327;&#36824;&#26159;&#21464;&#37327;&#65292;&#37117;&#23558;&#36820;&#22238;&#20540;&#20256;&#32473;&#32493;&#25991;&#65292;&#23601;&#20687;&#19978;&#38754;&#30340; <span class="stt">(cont 17)</span>&#12290;</p></li><li><p>&#36807;&#31243;&#35843;&#29992;&#22312;&#23614;&#37096;&#26102;&#65292;&#29992;&#21516;&#26679;&#30340;&#32493;&#25991; <span class="stt">cont</span> &#35843;&#29992;&#36807;&#31243;&#12290;</p></li><li><p>&#36807;&#31243;&#35843;&#29992;&#22312;&#25805;&#20316;&#25968;&#20301;&#32622;&#26102;&#65292;&#22312;&#26032;&#30340;&#32493;&#25991;&#20013;&#27714;&#36807;&#31243;&#35843;&#29992;&#30340;&#20540;&#65292;&#36825;&#20010;&#32493;&#25991;&#32473;&#35843;&#29992;&#32467;&#26524;&#21629;
&#21517;&#65292;&#32487;&#32493;&#36827;&#34892;&#35745;&#31639;&#12290;</p></li></ol></blockquote></blockquote><p>&#36825;&#20123;&#35268;&#21017;&#34429;&#19981;&#27491;&#24335;&#65292;&#20294;&#36275;&#20197;&#35299;&#37322;&#36825;&#31181;&#27169;&#24335;&#12290;
<a name="(idx._(gentag._943))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex6..1)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32771;&#34385;<span class="EoplFigureRef"></span>&#65292;&#20026;&#20160;&#20040;&#31227;&#38500; <span class="stt">fact/k</span> &#23450;&#20041;&#20013;&#30340; <span class="stt">(set! pc fact/k)</span>
&#21644; <span class="stt">apply-cont</span> &#20013;&#23450;&#20041;&#30340; <span class="stt">(set! pc apply-cont)</span>&#65292;&#31243;&#24207;&#20173;&#33021;&#27491;&#24120;&#36816;&#34892;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..2)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#29992;&#24402;&#32435;&#27861;&#35777;&#26126;&#65306;&#23545;&#20219;&#24847; <span class="texMathInline">g</span>&#65292;<span class="stt">(fib/k </span><span class="texMathInline">n</span><span class="stt"> </span><span class="texMathInline">g</span><span class="stt">) = (</span><span class="texMathInline">g</span><span class="stt"> (fib </span><span class="texMathInline">n</span><span class="stt">))</span>&#65292;&#24402;&#32435;
&#21464;&#37327;&#20026; <span class="texMathInline">n</span>&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..3)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25226;&#19979;&#38754;&#27599;&#20010; Scheme &#34920;&#36798;&#24335;&#37325;&#20889;&#20026;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#12290;&#20551;&#35774;&#25152;&#26377;&#26410;&#30693;&#20989;&#25968;&#37117;&#24050;&#32463;&#37325;&#20889;&#25104; CPS &#39118;
&#26684;&#12290;</p><ol><li><p><span class="stt">(lambda (x y) (p (+ 8 x) (q y)))</span></p></li><li><p><span class="stt">(lambda (x y u v) (+ 1 (f (g x y) (+ u v))))</span></p></li><li><p><span class="stt">(+ 1 (f (g x y) (+ u (h v))))</span></p></li><li><p><span class="stt">(zero? (if a (p x) (p y)))</span></p></li><li><p><span class="stt">(zero? (if (f a) (p x) (p y)))</span></p></li><li><p><span class="stt">(let ((x (let ((y 8)) (p y)))) x)</span></p></li><li><p><span class="stt">(let ((x (if a (p x) (p y)))) x)</span></p></li></ol></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..4)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._944))"></a>
<a name="(idx._(gentag._945))"></a>
<a name="(idx._(gentag._946))"></a>
<a name="(idx._(gentag._947))"></a>
<a name="(idx._(gentag._948))"></a>
<a name="(idx._(gentag._949))"></a>
<a name="(idx._(gentag._950))"></a>
<a name="(idx._(gentag._951))"></a>
<a name="(idx._(gentag._952))"></a>
<a name="(idx._(gentag._953))"></a>
<a name="(idx._(gentag._954))"></a>
&#25226;&#19979;&#38754;&#30340;&#25152;&#26377;&#36807;&#31243;&#37325;&#20889;&#20026;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#12290;&#34920;&#31034;&#27599;&#20010;&#36807;&#31243;&#30340;&#32493;&#25991;&#26102;&#65292;&#20808;&#29992;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#27861;&#65292;&#28982;
&#21518;&#29992;&#36807;&#31243;&#34920;&#31034;&#27861;&#65292;&#28982;&#21518;&#29992;&#20869;&#32852;&#36807;&#31243;&#34920;&#31034;&#27861;&#12290;&#26368;&#21518;&#65292;&#20889;&#20986;&#23492;&#23384;&#29256;&#26412;&#12290;&#29031;<a href="cpi.html" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a>&#37027;&#26679;&#23450;&#20041;
<span class="stt">end-cont</span>&#65292;&#39564;&#35777;&#20320;&#23454;&#29616;&#30340;&#36825;&#22235;&#20010;&#29256;&#26412;&#26159;&#23614;&#35843;&#29992;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-cont (end-cont) </span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(eopl:printf "&#35745;&#31639;&#32467;&#26463;.~%")</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(eopl:printf "&#36825;&#21477;&#35805;&#21482;&#33021;&#20986;&#29616;&#19968;&#27425;.~%")</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">val</span><span class="stt">)</span></p></td></tr></table></blockquote><ol><li><p><span class="stt">remove-first</span>&#65288;<a href="isd.html#%28elem._remove-first%29" data-pltdoc="x">1.2.3 &#33410;</a>&#65289;</p></li><li><p><span class="stt">list-sum</span>&#65288;<a href="isd.html#%28elem._list-sum%29" data-pltdoc="x">1.3 &#33410;</a>&#65289;</p></li><li><p><span class="stt">occurs-free?</span>&#65288;<a href="isd.html#%28elem._occurs-free-1~3f%29" data-pltdoc="x">1.2.4 &#33410;</a>&#65289;</p></li><li><p><span class="stt">subst</span>&#65288;<a href="isd.html#%28elem._subst%29" data-pltdoc="x">1.2.5 &#33410;</a>&#65289;
<a name="(idx._(gentag._955))"></a>
<a name="(idx._(gentag._956))"></a>
<a name="(idx._(gentag._957))"></a>
<a name="(idx._(gentag._958))"></a>
<a name="(idx._(gentag._959))"></a>
<a name="(idx._(gentag._960))"></a>
<a name="(idx._(gentag._961))"></a>
<a name="(idx._(gentag._962))"></a>
<a name="(idx._(gentag._963))"></a>
<a name="(idx._(gentag._964))"></a></p></li></ol></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..5)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#24403;&#25105;&#20204;&#25226;&#34920;&#36798;&#24335;&#37325;&#20889;&#20026;CPS&#26102;&#65292;&#25105;&#20204;&#23601;&#20026;&#34920;&#36798;&#24335;&#20013;&#30340;&#36807;&#31243;&#36873;&#25321;&#20102;&#19968;&#31181;&#27714;&#20540;&#39034;&#24207;&#12290;&#25226;&#21069;&#38754;&#30340;&#27599;
&#20010;&#20363;&#23376;&#37325;&#20889;&#20026;CPS&#65292;&#19988;&#20351;&#36807;&#31243;&#35843;&#29992;&#20174;&#21491;&#21521;&#24038;&#27714;&#20540;&#12290;
<a name="(idx._(gentag._965))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..6)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22312; <span class="stt">(lambda (x y) (+ (f (g x)) (h (j y))))</span> &#20013;&#65292;&#36807;&#31243;&#35843;&#29992;&#26377;&#22810;&#23569;&#31181;&#19981;&#21516;&#30340;&#27714;&#20540;&#39034;
&#24207;&#65311;&#23545;&#27599;&#31181;&#27714;&#20540;&#39034;&#24207;&#65292;&#20889;&#20986;&#23545;&#24212;&#30340; CPS &#34920;&#36798;&#24335;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..7)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._966))"></a>
<a name="(idx._(gentag._967))"></a>
<a name="(idx._(gentag._968))"></a>
<a name="(idx._(gentag._969))"></a>
&#20889;&#20986;<span class="EoplFigureRef"></span>&#12289;<span class="stt">fig-5.5</span> &#21644; <span class="stt">fig-5.6</span> &#20013;&#35299;&#37322;&#22120;&#30340;&#36807;
&#31243;&#34920;&#31034;&#21644;&#20869;&#32852;&#36807;&#31243;&#34920;&#31034;&#12290;
<a name="(idx._(gentag._970))"></a>
<a name="(idx._(gentag._971))"></a>
<a name="(idx._(gentag._972))"></a>
<a name="(idx._(gentag._973))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..8)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._974))"></a>
<a name="(idx._(gentag._975))"></a>
&#20889;&#20986;<a href="cpi.html#%28part._s5..4%29" data-pltdoc="x">&#24322;&#24120;</a>&#35299;&#37322;&#22120;&#30340;&#36807;&#31243;&#34920;&#31034;&#21644;&#20869;&#32852;&#36807;&#31243;&#34920;&#31034;&#12290;&#36825;&#26497;&#23500;&#25361;&#25112;&#24615;&#65292;&#22240;&#20026;&#25105;&#20204;&#23454;&#38469;&#19978;&#26377;
&#20004;&#20010;&#35266;&#27979;&#22120;&#65292;<span class="stt">apply-cont</span> &#21644; <span class="stt">apply-handler</span>&#12290;&#25552;&#31034;&#65306;&#32771;&#34385;&#20462;&#25913;
<span class="stt">cps-recipe</span>&#30340;&#31192;&#26041;&#65292;&#32473;&#27599;&#20010;&#36807;&#31243;&#28155;&#21152;&#20004;&#20010;&#21442;&#25968;&#65292;&#19968;&#20010;&#34920;&#31034; <span class="stt">apply-cont</span> &#20013;
&#32493;&#25991;&#30340;&#34892;&#20026;&#65292;&#19968;&#20010;&#34920;&#31034; <span class="stt">apply-handler</span> &#20013;&#32493;&#25991;&#30340;&#34892;&#20026;&#12290;<br/>
<a name="(idx._(gentag._976))"></a>
<a name="(idx._(gentag._977))"></a></p></blockquote><p><a name="(idx._(gentag._978))"></a>
&#26377;&#26102;&#65292;&#25105;&#20204;&#33021;&#21457;&#29616;&#26356;&#24039;&#22937;&#30340;&#26041;&#24335;&#34920;&#31034;&#32493;&#25991;&#12290;&#25105;&#20204;&#37325;&#26032;&#32771;&#34385;&#29992;&#36807;&#31243;&#34920;&#31034;&#32493;&#25991;&#30340; <span class="stt">fact</span>&#12290;&#20854;
&#20013;&#65292;&#25105;&#20204;&#26377;&#20004;&#20010;&#32493;&#25991;&#26500;&#36896;&#22120;&#65292;&#20889;&#20316;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">end-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#22312;&#36825;&#20010;&#31995;&#32479;&#20013;&#65292;&#25152;&#26377;&#32493;&#25991;&#37117;&#29992;&#26576;&#20010;&#25968;&#20056;&#20197;&#21442;&#25968;&#12290;<span class="stt">end-cont</span> &#23558;&#20854;&#21442;&#25968;&#20056; 1&#65292;&#33509;
<span class="texMathInline">cont</span> &#23558;&#21442;&#25968;&#20056; <span class="texMathInline">k</span>&#65292;&#37027;&#20040; <span class="stt">(fact1 </span><span class="texMathInline">n</span><span class="stt"> </span><span class="texMathInline">cont</span><span class="stt">)</span> &#23558;&#20854;&#20540;&#20056; <span class="texMathInline">k * n</span>&#12290;</p><p>&#25152;&#20197;&#27599;&#20010;&#32493;&#25991;&#37117;&#24418;&#22914; <span class="stt">(lambda (val) (* </span><span class="texMathInline">k</span><span class="stt"> val))</span>&#12290;&#36825;&#24847;&#21619;&#30528;&#25105;&#20204;&#21487;&#20197;&#29992;&#27599;&#20010;&#32493;&#25991;
&#20165;&#26377;&#30340;&#33258;&#30001;&#21464;&#37327;&#8212;&#8212;&#25968;&#23383; <span class="texMathInline">k</span>&#8212;&#8212;&#34920;&#31034;&#23427;&#12290;&#29992;&#36825;&#31181;&#34920;&#31034;&#26041;&#24335;&#65292;&#25105;&#20204;&#26377;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">end-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact1-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#22914;&#26524;&#25105;&#20204;&#22312; <span class="stt">fact/k</span> &#30340;&#21407;&#22987;&#23450;&#20041;&#20013;&#20869;&#32852;&#36825;&#20123;&#36807;&#31243;&#65292;&#24182;&#20351;&#29992;&#24615;&#36136; <span class="stt">(* </span><span class="texMathInline">cont</span><span class="stt"> 1) =</span><span class="stt">
</span><span class="texMathInline">cont</span>&#65292;&#21487;&#24471;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact/k</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact/k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#20294;&#26159;&#36825;&#21644; <span class="stt">fact-iter</span>&#65288;<span class="stt">fact-iter</span>&#65289;&#23436;&#20840;&#30456;&#21516;&#65281;&#25152;&#20197;&#25105;&#20204;&#26126;&#30333;&#20102;&#65292;
<a name="(idx._(gentag._979))"></a>&#32047;&#21152;&#22120;&#36890;&#24120;&#21482;&#26159;&#32493;&#25991;&#30340;&#19968;&#31181;&#34920;&#31034;&#26041;&#24335;&#12290;&#36825;&#20196;&#20154;&#21360;&#35937;&#28145;&#21051;&#12290;&#30456;&#24403;&#19968;
&#37096;&#20998;&#32463;&#20856;&#30340;&#31243;&#24207;&#20248;&#21270;&#38382;&#39064;&#21407;&#26469;&#26159;&#36825;&#19968;&#24605;&#24819;&#30340;&#29305;&#20363;&#12290;
<a name="(idx._(gentag._980))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex6..9)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20056;&#27861;&#30340;&#20160;&#20040;&#24615;&#36136;&#20351;&#36825;&#31181;&#31243;&#24207;&#20248;&#21270;&#25104;&#20026;&#21487;&#33021;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..10)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._981))"></a>
&#32473; <span class="stt">list-sum</span> &#35774;&#35745;&#19968;&#31181;&#31616;&#20415;&#30340;&#32493;&#25991;&#34920;&#31034;&#26041;&#24335;&#65292;&#23601;&#20687;&#19978;&#38754;&#30340; <span class="stt">fact/k</span> &#37027;&#26679;&#12290;</p></blockquote><h4>6.2<tt>&nbsp;</tt><a name="(part._s6..2)"></a>&#23614;&#24335;</h4><p><a name="(idx._(gentag._982))"></a>
<a name="(idx._(gentag._983))"></a>
&#35201;&#20889;&#20986;&#31243;&#24207;&#26469;&#20570;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#21464;&#25442;&#65292;&#25105;&#20204;&#38656;&#35201;&#25214;&#20986;&#36755;&#20837;&#21644;&#36755;&#20986;&#35821;&#35328;&#12290;&#25105;&#20204;&#36873;&#25321; LETREC &#20316;&#20026;
&#36755;&#20837;&#35821;&#35328;&#65292;&#24182;&#34917;&#20805;&#22810;&#21442;&#25968;&#36807;&#31243;&#21644;&#22810;&#22768;&#26126;&#30340; <span class="stt">letrec</span> &#34920;&#36798;&#24335;&#12290;
<a name="(idx._(gentag._984))"></a>
&#20854;&#35821;&#27861;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026; CPS-IN&#12290;&#20026;&#20102;&#21306;&#20998;&#36825;&#31181;&#35821;&#35328;&#21644;&#36755;&#20986;&#35821;&#35328;
&#30340;&#34920;&#36798;&#24335;&#65292;&#25105;&#20204;&#25226;&#36825;&#20123;&#21483;&#20570;<span class="emph">&#36755;&#20837;&#34920;&#36798;&#24335;</span> (<span class="emph">input expression</span>)&#12290;</p><p><a name="(idx._(gentag._985))"></a>
&#35201;&#23450;&#20041; CPS &#21464;&#25442;&#31639;&#27861;&#30340;&#21487;&#33021;&#36755;&#20986;&#65292;&#25105;&#20204;&#35201;&#25214;&#20986; CPI-IN &#30340;&#23376;&#38598;&#65292;&#22312;&#36825;&#20010;&#38598;&#21512;&#20013;&#65292;&#36807;&#31243;&#35843;&#29992;
&#19981;&#20135;&#29983;&#20219;&#20309;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;
<a name="(idx._(gentag._986))"></a></p><p>&#22238;&#24518;<a href="cpi.html" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a>&#20013;&#30340;&#21407;&#21017;&#65306;</p><blockquote class="SubFlow"><blockquote class="Tip"><blockquote class="SCentered"><p><span style="font-weight: bold">&#19981;&#26159;&#36807;&#31243;&#35843;&#29992;&#65292;&#32780;&#26159;&#25805;&#20316;&#25968;&#30340;&#27714;&#20540;&#23548;&#33268;&#25511;&#21046;&#19978;&#19979;&#25991;&#25193;&#22823;&#12290;</span>
<a name="(idx._(gentag._987))"></a>
<a name="(idx._(gentag._988))"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._989))"></a>
&#37027;&#20040;&#65292;&#22312;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#20013;&#65292;&#26159; <span class="stt">fact</span> &#30340;&#35843;&#29992;&#20301;&#32622;<span class="emph">&#20316;&#20026;&#25805;&#20316;&#25968;</span>&#23548;&#33268;&#20102;&#25511;&#21046;&#19978;&#19979;&#25991;&#30340;&#20135;&#29983;&#12290;&#30456;&#21453;&#65292;&#22312;</p><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact-iter</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact-iter-acc</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fact-iter-acc</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact-iter-acc</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._990))"></a></div></p></blockquote><p><a name="(idx._(gentag._991))"></a>
&#20013;&#65292; &#36807;&#31243;&#35843;&#29992;&#37117;&#19981;&#22312;&#25805;&#20316;&#25968;&#20301;&#32622;&#12290;&#25105;&#20204;&#35828;&#36825;&#20123;&#35843;&#29992;&#22312;<span class="emph">&#23614;&#31471;</span> (<span class="emph">tail position</span>)&#65292;&#22240;
&#20026;&#23427;&#20204;&#30340;&#20540;&#23601;&#26159;&#25972;&#20010;&#35843;&#29992;&#30340;&#32467;&#26524;&#12290;&#25105;&#20204;&#31216;&#20043;&#20026;<span class="emph">&#23614;&#35843;&#29992;</span> (<span class="emph">tail call</span>)&#12290;</p></blockquote><blockquote class="EoplFigure"><p>[!ht]
<br/>
<span class="Iidentity">\begin{align*}\mathit{Program} &amp;::= \mathit{InpExp} \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">a-program (exp1)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= \mathit{Number} \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">const-exp (num)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= <span class="stt">(- </span><span class="Iidentity">\mathit{InpExp}</span><span class="stt"> , </span><span class="Iidentity">\mathit{InpExp}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">diff-exp (exp1 exp2)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= <span class="stt">(zero? </span><span class="Iidentity">\mathit{InpExp}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">zero?-exp (exp1)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= <span class="stt">if </span><span class="Iidentity">\mathit{InpExp}</span><span class="stt"> then </span><span class="Iidentity">\mathit{InpExp}</span><span class="stt"> else </span><span class="Iidentity">\mathit{InpExp}</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">if-exp (exp1 exp2 exp3)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= \mathit{Identifier} \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">var-exp (var)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= <span class="stt">let </span><span class="Iidentity">\mathit{Identifier}</span><span class="stt"> = </span><span class="Iidentity">\mathit{InpExp}</span><span class="stt"> in </span><span class="Iidentity">\mathit{InpExp}</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">let-exp (var exp1 body)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= <span class="stt">letrec </span><span class="Iidentity">\{\mathit{Identifier}\ }<span class="stt">(</span><span class="Iidentity">\{\mathit{Identifier}\}^{*(,)}</span><span class="stt">)</span> = <span class="Iidentity">\mathit{InpExp}\</span>^{*}</span><span class="stt"> in </span><span class="Iidentity">\mathit{InpExp}</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">letrec-exp (p-names b-varss p-bodies letrec-body)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= <span class="stt">proc (</span><span class="Iidentity">\mathit{\{Identifier\}^{*(,)}}</span><span class="stt">) </span><span class="Iidentity">\mathit{InpExp}</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">proc-exp (vars body)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= <span class="stt">(</span><span class="Iidentity">\mathit{InpExp}</span><span class="stt"> </span><span class="Iidentity">\{\mathit{InpExp}\}^{*}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">call-exp (rator rands)</span>}\end{align*}</span></p><blockquote class="caption"><p>CPS-IN&#30340;&#35821;&#27861;
<a name="(idx._(gentag._992))"></a><a name="(elem._fig-6..3)"></a></p></blockquote></blockquote><p>&#20877;&#22238;&#24518;&#19968;&#19979;&#21407;&#21017;<span style="font-weight: bold">&#23614;&#35843;&#29992;&#19981;&#25193;&#22823;&#32493;&#25991;</span>&#65306;</p><blockquote class="Tip"><blockquote class="SCentered"><p><span style="font-weight: bold">&#23614;&#35843;&#29992;&#19981;&#25193;&#22823;&#32493;&#25991;</span>
<a name="(idx._(gentag._993))"></a>
<a name="(idx._(gentag._994))"></a></p></blockquote><p class="TipContent">&#33509; <span class="texMathInline">exp_1</span> &#30340;&#20540;&#20316;&#20026; <span class="texMathInline">exp_2</span> &#30340;&#20540;&#36820;&#22238;&#65292;&#21017;
<span class="texMathInline">exp_1</span> &#21644;<span class="texMathInline">exp_2</span> &#24212;&#22312;&#21516;&#26679;&#30340;&#32493;&#25991;&#20013;&#25191;&#34892;&#12290;</p></blockquote><p>&#33509;&#25152;&#26377;&#36807;&#31243;&#35843;&#29992;&#21644;&#25152;&#26377;&#21253;&#21547;&#36807;&#31243;&#35843;&#29992;&#30340;&#23376;&#34920;&#36798;&#24335;&#37117;&#22312;&#23614;&#31471;&#65292;&#25105;&#20204;&#31216;&#19968;&#20010;&#34920;&#36798;&#24335;
&#20026;<span class="emph">&#23614;&#24335;</span> (<span class="emph">tail form</span>)&#12290;&#36825;&#20010;&#26465;&#20214;&#34920;&#26126;&#25152;&#26377;&#36807;&#31243;&#35843;&#29992;&#37117;&#19981;&#20250;&#20135;&#29983;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;</p><p>&#22240;&#27492;&#65292;&#22312; Scheme &#20013;&#65292;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">z</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></blockquote><p>&#26159;&#23614;&#24335;&#65292;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">z</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#20063;&#26159;&#23614;&#24335;&#65292;&#20294;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">+</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">z</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">37</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#19981;&#26159;&#12290;&#22240;&#20026; <span class="stt">if</span> &#34920;&#36798;&#24335;&#21253;&#21547;&#19968;&#20010;&#19981;&#22312;&#23614;&#31471;&#30340;&#36807;&#31243;&#35843;&#29992;&#12290;</p></blockquote><p>&#36890;&#24120;&#65292;&#35201;&#21028;&#23450;&#35821;&#35328;&#30340;&#23614;&#31471;&#65292;&#25105;&#20204;&#24517;&#39035;&#29702;&#35299;&#20854;&#21547;&#20041;&#12290;&#22788;&#20110;&#23614;&#31471;&#30340;&#23376;&#34920;&#36798;&#24335;&#20855;&#26377;&#22914;&#19979;&#24615;&#36136;&#65306;&#35813;&#34920;
&#36798;&#24335;&#27714;&#20540;&#21518;&#65292;&#20854;&#20540;&#38543;&#21363;&#25104;&#20026;&#25972;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;&#19968;&#20010;&#34920;&#36798;&#24335;&#21487;&#33021;&#26377;&#22810;&#20010;&#23614;&#31471;&#12290;&#20363;&#22914;&#65292;<span class="stt">if</span>
&#34920;&#36798;&#24335;&#21487;&#33021;&#36873;&#25321;&#30495;&#20540;&#20998;&#25903;&#65292;&#20063;&#21487;&#33021;&#36873;&#25321;&#20551;&#20540;&#20998;&#25903;&#12290;&#23545;&#23614;&#31471;&#30340;&#23376;&#34920;&#36798;&#24335;&#65292;&#19981;&#38656;&#35201;&#20445;&#23384;&#20449;&#24687;&#65292;&#22240;
&#27492;&#20063;&#23601;&#19981;&#20250;&#20135;&#29983;&#25511;&#21046;&#19978;&#19979;&#25991;&#12290;</p><p>CPS-IN &#20013;&#30340;&#23614;&#31471;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;&#23614;&#31471;&#27599;&#20010;&#23376;&#34920;&#36798;&#24335;&#30340;&#20540;&#37117;&#21487;&#33021;&#25104;&#20026;&#25972;&#20010;&#34920;
&#36798;&#24335;&#30340;&#20540;&#12290;&#22312;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#20013;&#65292;&#25805;&#20316;&#25968;&#20301;&#32622;&#30340;&#23376;&#34920;&#36798;&#24335;&#20250;&#20135;&#29983;&#26032;&#30340;&#32493;&#25991;&#12290;&#23614;&#31471;&#30340;&#23376;&#34920;&#36798;
&#24335;&#22312;&#21407;&#34920;&#36798;&#24335;&#30340;&#32493;&#25991;&#20013;&#27714;&#20540;&#65292;&#22914;<span class="stt">tail-call-explain</span>&#25152;&#36848;&#12290;
<a name="(idx._(gentag._995))"></a></p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!t]</div><div class="SIntrapara"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">zero?(</span><span class="texMathInline">O</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">-(</span><span class="texMathInline">O</span><span class="stt">,</span><span class="texMathInline">O</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">if </span><span class="texMathInline">O</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">then </span><span class="texMathInline">T</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">else </span><span class="texMathInline">T</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">let </span><span class="texMathInline">Var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">= </span><span class="texMathInline">O</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">in </span><span class="texMathInline">T</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">letrec </span><span class="texMathInline">\{Var \ <span class="stt">(</span>\{Var\}^{*(,)}<span class="stt">)</span> \ <span class="stt">=</span> \ T\}^{*}</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">in </span><span class="texMathInline">T</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">proc (</span><span class="texMathInline">\{Var\}^{*(,)}</span><span class="stt">) = </span><span class="texMathInline">T</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">(</span><span class="texMathInline">O</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">O</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">...</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">O</span><span class="stt">)</span></p></td></tr></table></blockquote></div></p><blockquote class="caption"><p>CPS-IN &#20013;&#30340;&#23614;&#31471;&#21644;&#25805;&#20316;&#25968;&#20301;&#32622;&#12290;&#23614;&#31471;&#35760;&#20026; <span class="texMathInline">T</span>&#12290;&#25805;&#20316;&#25968;&#20301;&#32622;
&#35760;&#20026; <span class="texMathInline">O</span>&#12290;<a name="(idx._(gentag._996))"></a><a name="(elem._fig-6..4)"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._997))"></a>
&#25105;&#20204;&#26681;&#25454;&#36825;&#31181;&#21306;&#21035;&#35774;&#35745; CPS &#36716;&#25442;&#31639;&#27861;&#30340;&#30446;&#26631;&#35821;&#35328; CPS-OUT&#12290;&#36825;&#31181;&#35821;&#35328;&#30340;&#35821;&#27861;
&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;&#36825;&#22871;&#35821;&#27861;&#23450;&#20041;&#20102; CPS-IN &#30340;&#23376;&#38598;&#65292;&#20294;&#30053;&#26377;&#19981;&#21516;&#12290;&#29983;&#25104;&#24335;&#30340;
&#21517;&#23383;&#24635;&#20197; <span class="stt">cps-</span> &#24320;&#22836;&#65292;&#36825;&#26679;&#23427;&#20204;&#19981;&#20250;&#19982; CPS-IN &#20013;&#29983;&#25104;&#24335;&#30340;&#21517;&#23383;&#28151;&#28102;&#12290;</p><p><a name="(idx._(gentag._998))"></a>
<a name="(idx._(gentag._999))"></a>
&#26032;&#30340;&#35821;&#27861;&#26377;&#20004;&#20010;&#38750;&#32456;&#32467;&#31526;&#65292;<span class="texMathInline">\mathit{SimpleExp}</span> &#21644; <span class="texMathInline">\mathit{TfExp}</span>&#12290;&#36825;&#31181;&#35774;&#35745;&#20013;&#65292;
<span class="texMathInline">\mathit{SimpleExp}</span> &#34920;&#36798;&#24335;&#19981;&#21253;&#21547;&#20219;&#20309;&#36807;&#31243;&#35843;&#29992;&#65292;<span class="texMathInline">\mathit{TfExp}</span> &#34920;&#36798;&#24335;&#19968;&#23450;&#26159;
&#23614;&#24335;&#12290;</p><p>&#22240;&#20026; <span class="texMathInline">\mathit{SimpleExp}</span> &#34920;&#36798;&#24335;&#19981;&#21253;&#21547;&#20219;&#20309;&#36807;&#31243;&#35843;&#29992;&#65292;&#23427;&#20204;&#22823;&#33268;&#21487;&#20197;&#30475;&#25104;&#21482;&#26377;&#19968;&#34892;&#30340;
&#31616;&#21333;&#20195;&#30721;&#65292;&#23545;&#25105;&#20204;&#26469;&#35828;&#65292;&#23427;&#20204;&#31616;&#21333;&#21040;&#19981;&#38656;&#20351;&#29992;&#25511;&#21046;&#22534;&#26632;&#12290;&#31616;&#21333;&#34920;&#36798;&#24335;&#21253;&#25324; <span class="stt">proc</span> &#34920;&#36798;
&#24335;&#65292;&#22240;&#20026; <span class="stt">proc</span> &#34920;&#36798;&#24335;&#30452;&#25509;&#36820;&#22238;&#19968;&#20010;&#36807;&#31243;&#20540;&#65292;&#20294;&#36807;&#31243;&#30340;&#20027;&#20307;&#24517;&#39035;&#26159;&#23614;&#24335;&#12290;
<a name="(idx._(gentag._1000))"></a></p><p>&#23614;&#34920;&#36798;&#24335;&#30340;&#20256;&#36882;&#32493;&#25991;&#35299;&#37322;&#22120;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;&#30001;&#20110;&#36825;&#31181;&#35821;&#35328;&#30340;&#36807;&#31243;&#21462;&#22810;&#20010;&#21442;
&#25968;&#65292;&#25105;&#20204;&#29992;<span class="EoplExerciseRef"></span> &#20013;&#30340; <span class="stt">extend-env*</span> &#21019;&#24314;&#22810;&#20010;&#32465;&#23450;&#65292;&#24182;&#29992;&#31867;&#20284;&#26041;&#24335;
&#25193;&#23637; <span class="stt">extend-env-rec</span>&#65292;&#24471;&#21040; <span class="stt">extend-env-rec*</span>&#12290;</p><p>&#22312;&#36825;&#20010;&#35299;&#37322;&#22120;&#20013;&#65292;&#25152;&#26377;&#36882;&#24402;&#35843;&#29992;&#37117;&#22312;&#65288;Scheme &#30340;&#65289;&#23614;&#31471;&#65292;&#25152;&#20197;&#36816;&#34892;&#35299;&#37322;&#22120;&#19981;&#20250;&#22312; Scheme
&#20013;&#20135;&#29983;&#25511;&#21046;&#19978;&#19979;&#25991;&#65288;&#19981;&#20840;&#26159;&#36825;&#26679;&#65306;&#36807;&#31243;
<span class="stt">value-of-simple-exp</span>&#65288;<span class="EoplExerciseRef"></span>&#65289;&#20250;&#22312; Scheme &#20013;&#20135;&#29983;&#25511;&#21046;&#19978;&#19979;&#25991;&#65292;
&#20294;&#36825;&#21487;&#20197;&#36991;&#20813;&#65288;&#21442;&#35265;<span class="EoplExerciseRef"></span>&#65289;&#65289;&#12290;</p><p>&#26356;&#37325;&#35201;&#30340;&#26159;&#65292;&#35299;&#37322;&#22120;&#19981;&#20250;&#20135;&#29983;&#26032;&#30340;&#32493;&#25991;&#12290;&#36807;&#31243; <span class="stt">value-of/k</span> &#21462;&#19968;&#20010;&#32493;&#25991;&#21442;&#25968;&#65292;&#21407;&#23553;&#19981;
&#21160;&#22320;&#20256;&#32473;&#27599;&#20010;&#36882;&#24402;&#35843;&#29992;&#12290;&#25152;&#20197;&#65292;&#25105;&#20204;&#21487;&#20197;&#24456;&#23481;&#26131;&#22320;&#31227;&#38500;&#32493;&#25991;&#21442;&#25968;&#12290;</p><p>&#24403;&#28982;&#65292;&#27809;&#26377;&#36890;&#29992;&#30340;&#26041;&#24335;&#21028;&#26029;&#19968;&#20010;&#36807;&#31243;&#30340;&#25511;&#21046;&#34892;&#20026;&#26159;&#21542;&#26159;&#36845;&#20195;&#24335;&#30340;&#12290;&#32771;&#34385;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">strange-predicate?</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fact-iter</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#21482;&#26377; <span class="stt">strange-predicate?</span> &#23545;&#25152;&#26377;&#36275;&#22815;&#22823;&#30340; <span class="stt">n</span> &#37117;&#36820;&#22238;&#20551;&#26102;&#65292;&#36825;&#20010;&#36807;&#31243;&#25165;&#26159;&#36845;&#20195;
&#24335;&#30340;&#12290;&#20294;&#21363;&#20351;&#33021;&#26597;&#30475; <span class="stt">strange-predicate?</span> &#30340;&#20195;&#30721;&#65292;&#20063;&#21487;&#33021;&#26080;&#27861;&#21028;&#26029;&#36825;&#19968;&#26465;&#20214;&#30340;&#30495;&#20551;&#12290;
&#22240;&#27492;&#65292;&#25105;&#20204;&#26368;&#22810;&#21482;&#33021;&#23492;&#24076;&#26395;&#20110;&#31243;&#24207;&#20013;&#30340;&#36807;&#31243;&#35843;&#29992;&#19981;&#20135;&#29983;&#25511;&#21046;&#19978;&#19979;&#25991;&#65292;&#32780;&#19981;&#35770;&#20854;&#26159;&#21542;&#25191;&#34892;&#12290;
<a name="(idx._(gentag._1001))"></a>
<a name="(idx._(gentag._1002))"></a></p></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara"><br/>
</div><div class="SIntrapara"><blockquote class="Small"><p><span class="Iidentity">\begin{align*}\mathit{Program} &amp;::= \mathit{TfExp} \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-a-program (exp1)</span>} \\[5pt]
\mathit{SimpleExp} &amp;::= \mathit{Number} \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-const-exp (num)</span>} \\[5pt]
\mathit{SimpleExp} &amp;::= \mathit{Identifier} \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-var-exp (var)</span>} \\[5pt]
\mathit{SimpleExp} &amp;::= <span class="stt">(- </span><span class="Iidentity">\mathit{SimpleExp}</span><span class="stt"> , </span><span class="Iidentity">\mathit{SimpleExp}</span><span class="stt">)</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-diff-exp (simple1 simple2)</span>} \\[5pt]
\mathit{SimpleExp} &amp;::= <span class="stt">(zero? </span><span class="Iidentity">\mathit{SimpleExp}</span><span class="stt">)</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-zero?-exp (simple1)</span>} \\[5pt]
\mathit{SimpleExp} &amp;::= <span class="stt">proc (</span><span class="Iidentity">\mathit{\{Identifier\}^{*(,)}}</span><span class="stt">) </span><span class="Iidentity">\mathit{TfExp}</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-proc-exp (vars body)</span>} \\[5pt]
    \mathit{TfExp} &amp;::= <span class="Iidentity">\mathit{SimpleExp}</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">simple-exp-&gt;exp (simple-exp1)</span>} \\[5pt]
   \mathit{TfExp} &amp;::= <span class="stt">let </span><span class="Iidentity">\mathit{Identifier}</span><span class="stt"> = </span><span class="Iidentity">\mathit{SimpleExp}</span><span class="stt"> in </span><span class="Iidentity">\mathit{TfExp}</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-let-exp (var simple1 body)</span>} \\[5pt]
    \mathit{TfExp} &amp;::= <span class="stt">letrec </span><span class="Iidentity">\{\mathit{Identifier}\ }<span class="stt">(</span><span class="Iidentity">\{\mathit{Identifier}\}^{*(,)}</span><span class="stt">)</span> = <span class="Iidentity">\mathit{TfExp}\</span>^{*}</span><span class="stt"> in </span><span class="Iidentity">\mathit{TfExp}</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-letrec-exp (p-names b-varss p-bodies body)</span>} \\[5pt]
    \mathit{TfExp} &amp;::= <span class="stt">if </span><span class="Iidentity">\mathit{SimpleExp}</span><span class="stt"> then </span><span class="Iidentity">\mathit{TfExp}</span><span class="stt"> else </span><span class="Iidentity">\mathit{TfExp}</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-if-exp (simple1 body1 body2)</span>} \\[5pt]
    \mathit{TfExp} &amp;::= <span class="stt">(</span><span class="Iidentity">\mathit{SimpleExp}</span><span class="stt"> </span><span class="Iidentity">\{\mathit{SimpleExp}\}^{*}</span><span class="stt">)</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">call-exp (rator rands)</span>}\end{align*}</span></p></blockquote></div></p><p><div class="SIntrapara"><blockquote class="caption"><p>CPS-OUT &#30340;&#35821;&#27861;
<a name="(idx._(gentag._1003))"></a><a name="(elem._fig-6..5)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._1004))"></a></div></p></blockquote><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of/k</span></span> : <span class="texMathInline">\mathit{TfExp} \times \mathit{Env} \times \mathit{Cont} \to \mathit{FinalAnswer}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">tfexp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple-exp-&gt;exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-let-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">rhs</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">rhs</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-letrec-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p-names</span><span class="hspace">&nbsp;</span><span class="RktSym">b-varss</span><span class="hspace">&nbsp;</span><span class="RktSym">p-bodies</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env-rec**</span><span class="hspace">&nbsp;</span><span class="RktSym">p-names</span><span class="hspace">&nbsp;</span><span class="RktSym">b-varss</span><span class="hspace">&nbsp;</span><span class="RktSym">p-bodies</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-if-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple1</span><span class="hspace">&nbsp;</span><span class="RktSym">body1</span><span class="hspace">&nbsp;</span><span class="RktSym">body2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;bool</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-call-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">rands</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">rator-proc</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand-vals</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">rands</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-procedure/k</span><span class="hspace">&nbsp;</span><span class="RktSym">rator-proc</span><span class="hspace">&nbsp;</span><span class="RktSym">rand-vals</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">apply-procedure/k</span></span> : <span class="texMathInline">\mathit{Proc} \times \mathit{ExpVal} \times \mathit{Cont} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">args</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env*</span><span class="hspace">&nbsp;</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktSym">args</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="caption"><p>CPS-OUT &#20013;&#30340;&#23614;&#24335;&#35299;&#37322;&#22120;<a name="(elem._fig-6..6)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._1005))"></a></div></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..11)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986; <span class="stt">value-of-simple-exp</span>&#65292;&#23436;&#25104;<span class="EoplFigureRef"></span> &#20013;&#30340;&#35299;&#37322;&#22120;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..12)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#21028;&#26029;&#19979;&#21015;&#34920;&#36798;&#24335;&#26159;&#21542;&#26159;&#31616;&#21333;&#30340;&#12290;</p><ol><li><p><span class="stt">-((f -(x,1)),1)</span></p></li><li><p><span class="stt">(f -(-(x,y),1))</span></p></li><li><p><span class="stt">if zero?(x) then -(x,y) else -(-(x,y),1)</span></p></li><li><p><span class="stt">let x = proc (y) (y x) in -(x,3)</span></p></li><li><p><span class="stt">let f = proc (x) x in (f 3)</span></p></li></ol></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..13)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#29992;&#19978;&#38754;<span class="stt">cps-recipe</span>&#30340; CPS &#31192;&#26041;&#65292;&#25226;&#19979;&#21015; CPS-IN &#34920;&#36798;&#24335;&#32763;&#35793;&#20026;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;&#12290;
&#29992;<span class="EoplFigureRef"></span> &#20013;&#30340;&#35299;&#37322;&#22120;&#36816;&#34892;&#36716;&#25442;&#21518;&#30340;&#31243;&#24207;&#65292;&#27979;&#35797;&#23427;&#20204;&#65292;&#30830;&#20445;&#21407;&#31243;&#24207;&#21644;&#36716;&#25442;&#21518;
&#30340;&#29256;&#26412;&#23545;&#25152;&#26377;&#36755;&#20837;&#37117;&#32473;&#20986;&#21516;&#26679;&#30340;&#32467;&#26524;&#12290;</p><ol><li><p><span class="stt">removeall</span>&#12290;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">removeall(n,s) =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">if null?(s)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">then emptylist</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">else if number?(car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then if equal?(n,car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then (removeall n cdr(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else cons(car(s),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(removeall n cdr(s)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else cons((removeall n car(s)),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(removeall n cdr(s)))</span></p></td></tr></table></blockquote></li><li><p><span class="stt">occurs-in?</span>&#12290;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">occurs-in?(n,s) =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">if null?(s)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">else if number?(car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then if equal?(n,car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else (occurs-in? n cdr(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else if (occurs-in? n car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else (occurs-in? n cdr(s))</span></p></td></tr></table></blockquote></li><li><p><span class="stt">remfirst</span>&#12290;&#23427;&#20351;&#29992;&#21069;&#38754;&#20363;&#23376;&#20013;&#30340; <span class="stt">occurs-in?</span>&#12290;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">remfirst(n,s) =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">loop(s) =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">if null?(s)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then emptylist</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else if number?(car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then if equal?(n,car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then cdr(s)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else cons(car(s),(loop cdr(s)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else if (occurs-in? n car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then cons((remfirst n car(s)),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">cdr(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else cons(car(s),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(remfirst n cdr(s)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">in (loop s)</span></p></td></tr></table></blockquote></li><li><p><span class="stt">depth</span>&#12290;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">depth(s) =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">if null?(s)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">else if number?(car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then (depth cdr(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else if less?(add1((depth car(s))),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(depth cdr(s)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then (depth cdr(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else add1((depth car(s)))</span></p></td></tr></table></blockquote></li><li><p><span class="stt">depth-with-let</span>&#12290;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">depth(s) =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">if null?(s)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">else if number?(car(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then (depth cdr(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else let dfirst = add1((depth car(s)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">drest = (depth cdr(s))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in if less?(dfirst,drest)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then drest</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else dfirst</span></p></td></tr></table></blockquote></li><li><p><span class="stt">map</span>&#12290;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">map(f, l) = if null?(l)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then emptylist</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else cons((f car(l)),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(map f cdr(l)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">square(n) = *(n,n)</span></p></td></tr><tr><td><p><span class="stt">in (map square list(1,2,3,4,5))</span></p></td></tr></table></blockquote></li><li><p><span class="stt">fnlrgtn</span>&#12290;n-list &#31867;&#20284; s-list&#65288;<span class="stt">s-list</span>&#65289;&#65292;&#21482;&#19981;&#36807;&#20854;&#20013;&#30340;&#20803;&#32032;&#19981;
&#26159;&#31526;&#21495;&#65292;&#32780;&#26159;&#25968;&#23383;&#12290;<span class="stt">fnlrgtn</span> &#21462;&#19968; n-list&#65292;&#19968;&#20010;&#25968;&#23383; <span class="stt">n</span>&#65292;&#36820;&#22238;&#21015;&#34920;&#20013;&#65288;&#20174;&#24038;&#21521;
&#21491;&#25968;&#65289;&#31532;&#19968;&#20010;&#22823;&#20110; <span class="stt">n</span> &#30340;&#25968;&#23383;&#12290;&#19968;&#26086;&#25214;&#21040;&#32467;&#26524;&#65292;&#23601;&#19981;&#20877;&#26816;&#26597;&#21015;&#34920;&#20013;&#21097;&#20313;&#20803;&#32032;&#12290;&#20363;&#22914;&#65292;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(fnlrgtn list(1,list(3,list(2),7,list(9)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">6)</span></p></td></tr></table></blockquote><p>&#36820;&#22238; 7&#12290;</p></li><li><p><span class="stt">every</span>&#12290;&#36825;&#20010;&#36807;&#31243;&#21462;&#19968;&#35859;&#35789;&#65292;&#19968;&#20010;&#21015;&#34920;&#65292;&#24403;&#19988;&#20165;&#24403;&#35859;&#35789;&#23545;&#21015;&#34920;&#20013;&#25152;&#26377;&#20803;&#32032;&#37117;&#20026;
&#30495;&#26102;&#65292;&#36820;&#22238;&#30495;&#12290;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">every(pred, l) =</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">if null?(l)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">else if (pred car(l))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then (every pred cdr(l))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else 0</span></p></td></tr><tr><td><p><span class="stt">in (every proc(n) greater?(n,5) list(6,7,8,9))</span></p></td></tr></table></blockquote></li></ol></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..14)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#34917;&#20805; <span class="stt">value-of-program</span> &#21644; <span class="stt">apply-cont</span>&#65292;&#23436;&#25104;<span class="EoplFigureRef"></span> &#20013;&#30340;&#35299;&#37322;
&#22120;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..15)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#35266;&#23519;&#21069;&#19968;&#36947;&#32451;&#20064;&#20013;&#30340;&#35299;&#37322;&#22120;&#21487;&#30693;&#65292;<span class="stt">cont</span> &#21482;&#26377;&#19968;&#20010;&#20540;&#12290;&#26681;&#25454;&#36825;&#19968;&#35266;&#23519;&#23436;&#20840;&#31227;&#38500;
<span class="stt">cont</span> &#21442;&#25968;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..16)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1006))"></a>
&#23492;&#23384;<span class="EoplFigureRef"></span> &#20013;&#30340;&#35299;&#37322;&#22120;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..17)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1007))"></a>
&#25226;<span class="EoplFigureRef"></span> &#20013;&#30340;&#35299;&#37322;&#22120;&#36716;&#25442;&#20026;&#36339;&#36291;&#24335;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..18)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913; CPS-OUT &#30340;&#35821;&#27861;&#65292;&#25226;&#31616;&#21333; <span class="stt">diff-exp</span> &#21644; <span class="stt">zero?-exp</span> &#30340;&#21442;&#25968;&#38480;&#21046;&#20026;&#24120;&#37327;&#21644;&#21464;
&#37327;&#12290;&#36825;&#26679;&#65292;&#35821;&#35328;&#20013;&#30340; <span class="stt">value-of-simple-exp</span> &#23601;&#19981;&#24517;&#36882;&#24402;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..19)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986; Scheme &#36807;&#31243; <span class="stt">tail-form?</span>&#65292;&#23427;&#21462;&#19968; CPS-IN &#31243;&#24207;&#30340;&#35821;&#27861;&#26641;&#65292;&#35821;&#27861;
&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#65292;&#21028;&#26029;&#21516;&#19968;&#23383;&#31526;&#20018;&#26159;&#21542;&#26159;<span class="EoplFigureRef"></span> &#20013;&#35821;&#27861;&#23450;&#20041;
&#30340;&#23614;&#24335;&#12290;</p></blockquote><h4>6.3<tt>&nbsp;</tt><a name="(part._s6..3)"></a>&#36716;&#25442;&#20026;&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</h4><p><a name="(idx._(gentag._1008))"></a>
<a name="(idx._(gentag._1009))"></a>
&#26412;&#33410;&#65292;&#25105;&#20204;&#24320;&#21457;&#31639;&#27861;&#65292;&#23558;&#20219;&#24847;&#31243;&#24207;&#20174; CPS-IN &#36716;&#25442;&#20026; CPS-OUT&#12290;</p><p>&#23601;&#20687;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#19968;&#26679;&#65292;&#25105;&#20204;&#30340;&#32763;&#35793;&#22120;<span class="emph">&#36319;&#38543;&#35821;&#27861;</span>&#12290;&#20063;&#20687;&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;&#19968;&#26679;&#65292;
&#25105;&#20204;&#30340;&#32763;&#35793;&#22120;&#20877;&#21462;&#19968;&#20010;&#34920;&#31034;&#32493;&#25991;&#30340;&#21442;&#25968;&#12290;&#22810;&#20986;&#30340;&#36825;&#20010;&#21442;&#25968;&#26159;&#19968;&#20010;&#34920;&#31034;&#32493;&#25991;&#30340;&#31616;&#21333;&#34920;&#36798;&#24335;&#12290;</p><p>&#20687;&#20043;&#21069;&#37027;&#26679;&#65292;&#25105;&#20204;&#39318;&#20808;&#32473;&#20986;&#20363;&#23376;&#65292;&#28982;&#21518;&#25552;&#20986;&#35268;&#33539;&#65292;&#26368;&#21518;&#20889;&#20986;&#31243;&#24207;&#12290;<span class="EoplFigureRef"></span>
&#23637;&#31034;&#20102;&#19982;&#21069;&#19968;&#33410;&#31867;&#20284;&#30340; Scheme &#20363;&#23376;&#65292;&#21482;&#26159;&#26356;&#21152;&#35814;&#32454;&#12290;</p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]
</div><div class="SIntrapara"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">17</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">37</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">33</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">44</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></div></p><p>&#21464;&#25442;&#20026;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktVal">17</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktVal">37</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktVal">33</span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">44</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><blockquote class="caption"><p>CPS &#21464;&#25442;&#31034;&#20363;&#65288;Scheme&#65289;<a name="(elem._fig-6..7)"></a></p></blockquote></blockquote><p>&#31532;&#19968;&#31181;&#24773;&#20917;&#26159;&#24120;&#37327;&#12290;&#24120;&#37327;&#30452;&#25509;&#20256;&#32473;&#32493;&#25991;&#65292;&#23601;&#20687;&#19978;&#38754; <span class="stt">(zero? x)</span> &#36825;&#19968;&#34892;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp </span><span class="texMathInline">n</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">K</span><span class="stt">) = (</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">n</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#20854;&#20013;&#65292;<span class="texMathInline">K</span> &#34920;&#31034;&#32493;&#25991;&#65292;&#26159;&#19968;&#20010; simple-exp&#12290;</p></blockquote><p>&#21516;&#26679;&#65292;&#21464;&#37327;&#30452;&#25509;&#20256;&#32473;&#32493;&#25991;&#12290;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">K</span><span class="stt">) = (</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">var</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#24403;&#28982;&#65292;&#25105;&#20204;&#31639;&#27861;&#30340;&#36755;&#20837;&#36755;&#20986;&#37117;&#26159;&#25277;&#35937;&#35821;&#27861;&#26641;&#65292;&#25152;&#20197;&#25105;&#20204;&#24212;&#35813;&#29992;&#25277;&#35937;&#35821;&#27861;&#26500;&#36896;&#22120;&#65292;&#32780;&#19981;&#26159;&#20855;&#20307;
&#35821;&#27861;&#65292;&#23601;&#20687;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp (const-exp </span><span class="texMathInline">n</span><span class="stt">) </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (make-send-to-cont </span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(cps-const-exp </span><span class="texMathInline">n</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(cps-of-exp (var-exp </span><span class="texMathInline">var</span><span class="stt">) </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (make-send-to-cont </span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(cps-var-exp </span><span class="texMathInline">var</span><span class="stt">))</span></p></td></tr></table></blockquote><p>&#20854;&#20013;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">make-send-to-cont</span></span> : <span class="texMathInline">\mathit{SimpleExp} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">make-send-to-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">k-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-call-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">simple-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#25105;&#20204;&#38656;&#35201; <span class="stt">list</span>&#65292;&#22240;&#20026;&#22312; CPS-OUT &#20013;&#65292;&#27599;&#20010;&#35843;&#29992;&#34920;&#36798;&#24335;&#37117;&#21462;&#19968;&#20010;&#25805;&#20316;&#25968;&#21015;&#34920;&#12290;</p></blockquote><p>&#20294;&#26159;&#22312;&#35268;&#33539;&#20013;&#65292;&#25105;&#20204;&#20173;&#28982;&#20351;&#29992;&#20855;&#20307;&#35821;&#27861;&#65292;&#22240;&#20026;&#20855;&#20307;&#35821;&#27861;&#36890;&#24120;&#26356;&#23481;&#26131;&#35835;&#25026;&#12290;</p><p><a name="(idx._(gentag._1010))"></a>
<a name="(idx._(gentag._1011))"></a>
&#36807;&#31243;&#21602;&#65311;&#25105;&#20204;&#36716;&#25442;<span class="EoplFigureRef"></span> &#20013;&#37027;&#26679;&#30340; <span class="stt">(lambda (x) ...)</span> &#36807;&#31243;&#26102;&#65292;&#20026;&#20854;
&#26032;&#22686;&#19968;&#20010;&#21442;&#25968; <span class="stt">k</span>&#65292;&#28982;&#21518;&#36716;&#25442;&#20027;&#20307;&#65292;&#24182;&#23558;&#20027;&#20307;&#30340;&#20540;&#20256;&#32473;&#32493;&#25991; <span class="stt">k</span>&#12290;&#25105;&#20204;
&#22312;<span class="EoplFigureRef"></span> &#20013;&#27491;&#26159;&#36825;&#26679;&#20570;&#30340;&#12290;&#25152;&#20197;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">proc (</span><span class="texMathInline">var_1</span><span class="stt">, ..., </span><span class="texMathInline">var_n</span><span class="stt">) </span><span class="texMathInline">exp</span></p></td></tr></table></blockquote><p>&#21464;&#25104;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">proc (</span><span class="texMathInline">var_1</span><span class="stt">, ..., </span><span class="texMathInline">var_n</span><span class="stt">, k) (cps-of-exp </span><span class="texMathInline">exp</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">k)</span></p></td></tr></table></blockquote><p>&#23601;&#20687;&#22270;&#20013;&#37027;&#26679;&#12290;&#20294;&#26159;&#65292;&#36825;&#36824;&#27809;&#23436;&#12290;&#25105;&#20204;&#30340;&#30446;&#26631;&#26159;&#29983;&#25104;&#20195;&#30721;&#65292;&#27714; <span class="stt">proc</span> &#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#24182;
&#23558;&#32467;&#26524;&#20256;&#32473;&#32493;&#25991; <span class="texMathInline">K</span>&#12290;&#25152;&#20197; <span class="stt">proc</span> &#34920;&#36798;&#24335;&#30340;&#23436;&#25972;&#35268;&#33539;&#20026;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;proc (</span><span class="texMathInline">var_1</span><span class="stt">, ..., </span><span class="texMathInline">var_n</span><span class="stt">) </span><span class="texMathInline">exp</span><span class="stt">&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">var_1</span><span class="stt">, ..., </span><span class="texMathInline">var_n</span><span class="stt">, k) (cps-of-exp </span><span class="texMathInline">exp</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">k)&gt;&gt;)</span></p></td></tr></table></blockquote></blockquote><p>&#20854;&#20013;&#65292;<span class="stt">k</span> &#26159;&#26032;&#21464;&#37327;&#65292;<span class="texMathInline">K</span> &#34920;&#31034;&#32493;&#25991;&#65292;&#26159;&#20219;&#24847;&#31616;&#21333;&#34920;&#36798;&#24335;&#12290;</p><p><a name="(idx._(gentag._1012))"></a>
&#26377;&#25805;&#20316;&#25968;&#30340;&#34920;&#36798;&#24335;&#21602;&#65311;&#25105;&#20204;&#26242;&#26102;&#32473;&#35821;&#35328;&#28155;&#21152;&#20219;&#24847;&#22810;&#20010;&#25805;&#20316;&#25968;&#30340;&#27714;&#21644;&#34920;&#36798;&#24335;&#12290;&#35201;&#28155;&#21152;&#36825;&#31181;&#34920;&#36798;
&#24335;&#65292;&#25105;&#20204;&#32473; CPS-IN &#30340;&#35821;&#27861;&#28155;&#21152;&#29983;&#25104;&#24335;&#65306;</p><blockquote class="Small"><p><span class="Iidentity">\begin{align*}\mathit{InpExp} &amp;::= <span class="stt">+(</span><span class="Iidentity">\mathit{\{InpExp\}^{*(,)}}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">sum-exp (exps)</span>}\end{align*}</span></p></blockquote><p>&#32473; CPS-OUT &#30340;&#35821;&#27861;&#28155;&#21152;&#29983;&#25104;&#24335;&#65306;</p><blockquote class="Small"><p><span class="Iidentity">\begin{align*}\mathit{SimpleExp} &amp;::= <span class="stt">+(</span><span class="Iidentity">\mathit{\{SimpleExp\}^{*(,)}}</span><span class="stt">)</span> \\[-3pt]
 &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-sum-exp (simple-exps)</span>}\end{align*}</span></p></blockquote><p>&#36825;&#20010;&#26032;&#29983;&#25104;&#24335;&#20173;&#20445;&#25345;&#24615;&#36136;&#65306;&#31616;&#21333;&#34920;&#36798;&#24335;&#20869;&#19981;&#20250;&#20986;&#29616;&#36807;&#31243;&#35843;&#29992;&#12290;</p><p><span class="stt">(cps-of-exp </span><span class="texMathInline">\textnormal{\guillemotleft}</span><span class="stt">+(</span><span class="texMathInline">exp_1</span><span class="stt">, ...,</span><span class="stt">
</span><span class="texMathInline">exp_n</span><span class="stt">)</span><span class="texMathInline">\textnormal{\guillemotright}</span><span class="stt"> </span><span class="texMathInline">K</span><span class="stt">)</span> &#21487;&#33021;&#26159;&#20160;&#20040;&#21602;&#65311;&#21487;&#33021; <span class="texMathInline">exp_1</span>,
<span class="texMathInline">\dots</span>, <span class="texMathInline">exp_n</span> &#37117;&#26159;&#31616;&#21333;&#30340;&#65292;&#23601;&#20687;<span class="EoplFigureRef"></span> &#20013;&#30340; <span class="stt">(= x 2)</span>&#12290;&#37027;
&#20040;&#65292;&#25972;&#20010;&#34920;&#36798;&#24335;&#37117;&#26159;&#31616;&#21333;&#30340;&#65292;&#25105;&#20204;&#21487;&#20197;&#23558;&#23427;&#30340;&#20540;&#25509;&#20256;&#32473;&#32493;&#25991;&#12290;&#35774; <span class="texMathInline">simp</span> &#20026;&#19968;&#31616;&#21333;&#34920;&#36798;&#24335;&#65292;
&#37027;&#20040;&#26377;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;+(</span><span class="texMathInline">simp_1</span><span class="stt">, ..., </span><span class="texMathInline">simp_n</span><span class="stt">)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">&lt;&lt;+(</span><span class="texMathInline">simp_1</span><span class="stt">, ..., </span><span class="texMathInline">simp_n</span><span class="stt">)&gt;&gt;)</span></p></td></tr></table></blockquote><p>&#22914;&#26524;&#25805;&#20316;&#25968;&#19981;&#26159;&#31616;&#21333;&#30340;&#21602;&#65311;&#37027;&#20040;&#27714;&#20540;&#32493;&#25991;&#38656;&#35201;&#32473;&#20854;&#20540;&#21629;&#21517;&#65292;&#28982;&#21518;&#32487;&#32493;&#27714;&#21644;&#65292;&#23601;&#20687;&#19978;&#38754;
<span class="stt">(= x 3)</span> &#36825;&#34892;&#12290;&#20854;&#20013;&#30340;&#31532;&#20108;&#20010;&#26159;&#39318;&#20010;&#22797;&#26434;&#25805;&#20316;&#25968;&#12290;&#37027;&#20040;&#25105;&#20204;&#30340; CPS &#36716;&#25442;&#22120;&#24212;&#20855;&#26377;&#24615;&#36136;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;+(</span><span class="texMathInline">simp_1</span><span class="stt">, </span><span class="texMathInline">exp_2</span><span class="stt">, </span><span class="texMathInline">simp_3</span><span class="stt">, ..., </span><span class="texMathInline">simp_n</span><span class="stt">)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp </span><span class="texMathInline">exp_2</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">var_2</span><span class="stt">) (</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">+(</span><span class="texMathInline">simp_1</span><span class="stt">, </span><span class="texMathInline">var_2</span><span class="stt">, </span><span class="texMathInline">simp_3</span><span class="stt">, ..., </span><span class="texMathInline">simp_n</span><span class="stt">))&gt;&gt;)</span></p></td></tr></table></blockquote><p>&#22914;&#26524; <span class="texMathInline">exp_2</span> &#21482;&#26159;&#19968;&#20010;&#36807;&#31243;&#35843;&#29992;&#65292;&#37027;&#20040;&#36755;&#20986;&#21644;&#22270;&#20013;&#30456;&#21516;&#12290;&#20294; <span class="texMathInline">exp_2</span> &#21487;&#33021;&#26356;&#22797;&#26434;&#65292;&#25152;
&#20197;&#25105;&#20204;&#36882;&#24402;&#35843;&#29992; <span class="stt">cps-of-exp</span> &#22788;&#29702; <span class="texMathInline">exp_2</span> &#21644;&#26356;&#22823;&#30340;&#32493;&#25991;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">proc (</span><span class="texMathInline">var_2</span><span class="stt">) (</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">+(</span><span class="texMathInline">simp_1</span><span class="stt">, </span><span class="texMathInline">var_2</span><span class="stt">, </span><span class="texMathInline">simp_3</span><span class="stt">, ..., </span><span class="texMathInline">simp_n</span><span class="stt">))</span></p></td></tr></table></blockquote><p>&#32780;&#27714;&#21644;&#34920;&#36798;&#24335;&#20013;&#65292;&#36824;&#26377;&#21478;&#19968;&#31181;&#22797;&#26434;&#25805;&#20316;&#25968;&#65292;&#23601;&#20687; <span class="stt">(= x 5)</span> &#36825;&#31181;&#12290;&#25152;&#20197;&#65292;&#19981;&#26159;&#30452;&#25509;&#20351;&#29992;
&#32493;&#25991;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">proc (</span><span class="texMathInline">var_2</span><span class="stt">) (</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">+(</span><span class="texMathInline">simp_1</span><span class="stt">, </span><span class="texMathInline">var_2</span><span class="stt">, ..., </span><span class="texMathInline">simp_n</span><span class="stt">))</span></p></td></tr></table></blockquote><p>&#25105;&#20204;&#36824;&#35201;&#36882;&#24402;&#22788;&#29702;&#26356;&#22823;&#30340;&#21442;&#25968;&#12290;&#25105;&#20204;&#21487;&#20197;&#25226;&#36825;&#26465;&#35268;&#21017;&#24635;&#32467;&#20026;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;+(</span><span class="texMathInline">simp_1</span><span class="stt">, </span><span class="texMathInline">exp_2</span><span class="stt">, </span><span class="texMathInline">exp_3</span><span class="stt">, ..., </span><span class="texMathInline">exp_n</span><span class="stt">)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp </span><span class="texMathInline">exp_2</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">var_2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;+(</span><span class="texMathInline">simp_1</span><span class="stt">, </span><span class="texMathInline">var_2</span><span class="stt">, </span><span class="texMathInline">exp_3</span><span class="stt">, ..., </span><span class="texMathInline">exp_n</span><span class="stt">))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr></table></blockquote></blockquote><p><span class="stt">cps-of-exp</span> &#30340;&#27599;&#20010;&#36882;&#24402;&#35843;&#29992;&#37117;&#20445;&#35777;&#20250;&#32456;&#27490;&#12290;&#31532;&#19968;&#20010;&#35843;&#29992;&#20250;&#32456;&#27490;&#26159;&#22240;&#20026; <span class="texMathInline">exp_2</span> &#27604;
&#21407;&#34920;&#36798;&#24335;&#23567;&#12290;&#31532;&#20108;&#20010;&#35843;&#29992;&#20250;&#32456;&#27490;&#26159;&#36824;&#26159;&#22240;&#20026;&#20854;&#21442;&#25968;&#20063;&#27604;&#21407;&#26469;&#30340;&#23567;&#65306;<span class="texMathInline">var_2</span> &#24635;&#26159;&#27604;
<span class="texMathInline">exp_2</span> &#23567;&#12290;</p><p>&#20363;&#22914;&#65292;&#26597;&#30475; <span class="stt">(= x 5)</span> &#36825;&#19968;&#34892;&#65292;&#24182;&#20351;&#29992; CPS-IN &#30340;&#35821;&#27861;&#65292;&#25105;&#20204;&#26377;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;+((f x), 33, (g y))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp &lt;&lt;(f x)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">v1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;+(v1, 33, (g y))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp &lt;&lt;(f x)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">v1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(g y)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc </span><span class="texMathInline">v2</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;+(v1, 33, v2)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp &lt;&lt;(f x)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">v1</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(g y)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc </span><span class="texMathInline">v2</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">&lt;&lt;+(v1, 33, v2)&gt;&gt;)))</span></p></td></tr><tr><td><p><span class="stt">= (f x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(g y</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">&lt;&lt;+(v1, 33, v2)&gt;&gt;)))</span></p></td></tr></table></blockquote><p><a name="(idx._(gentag._1013))"></a>
&#36807;&#31243;&#35843;&#29992;&#19982;&#20043;&#31867;&#20284;&#12290;&#22914;&#26524;&#25805;&#20316;&#31526;&#21644;&#25805;&#20316;&#25968;&#37117;&#26159;&#31616;&#21333;&#30340;&#65292;&#37027;&#20040;&#25105;&#20204;&#28155;&#21152;&#32493;&#25991;&#21442;&#25968;&#65292;&#30452;&#25509;&#35843;&#29992;&#36807;
&#31243;&#65292;&#23601;&#20687; <span class="stt">(= x 2)</span> &#36825;&#34892;&#12290;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;(</span><span class="texMathInline">simp_0</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">simp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">... </span><span class="texMathInline">simp_n</span><span class="stt">)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (</span><span class="texMathInline">simp_0</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">simp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">... </span><span class="texMathInline">simp_n</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#21478;&#19968;&#26041;&#38754;&#65292;&#22914;&#26524;&#26576;&#20010;&#25805;&#20316;&#25968;&#26159;&#22797;&#26434;&#30340;&#65292;&#37027;&#20040;&#25105;&#20204;&#24517;&#39035;&#20808;&#27714;&#23427;&#30340;&#20540;&#65292;&#20687; <span class="stt">(= x 4)</span> &#36825;&#34892;&#12290;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;(</span><span class="texMathInline">simp_0</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">simp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_3</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">... </span><span class="texMathInline">exp_n</span><span class="stt">)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp </span><span class="texMathInline">exp_2</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">var_2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(</span><span class="texMathInline">simp_0</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">simp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">var_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_3</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">... </span><span class="texMathInline">exp_n</span><span class="stt">)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;)</span></p></td></tr></table></blockquote><p>&#32780;&#19988;&#65292;&#20687;&#20043;&#21069;&#37027;&#26679;&#65292;<span class="stt">cps-of-exp</span> &#30340;&#31532;&#20108;&#20010;&#35843;&#29992;&#36882;&#24402;&#36827;&#20837;&#36807;&#31243;&#35843;&#29992;&#20043;&#20013;&#65292;&#20026;&#27599;&#20010;&#22797;&#26434;&#21442;
&#25968;&#35843;&#29992; <span class="stt">cps-of-exp</span>&#65292;&#30452;&#21040;&#25152;&#26377;&#21442;&#25968;&#37117;&#26159;&#31616;&#21333;&#21442;&#25968;&#12290;</p><p>&#20889;&#25104; CPS-IN &#30340;&#20363;&#23376; <span class="stt">(= x 5)</span> &#21487;&#29992;&#36825;&#20123;&#35268;&#21017;&#22788;&#29702;&#22914;&#19979;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;(h (f x) -(44,y) (g y))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp &lt;&lt;(f x)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(h v1 -(44,y) (g y))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;)</span></p></td></tr><tr><td><p><span class="stt">= (f x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(h v1 -(44,y) (g y))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt">= (f x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(g y)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(h v1 -(44,y) v2)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt">= (f x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(g y</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(h v1 -(44,y) v2)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)))</span></p></td></tr><tr><td><p><span class="stt">= (f x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(g y</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(h v1 -(44,y) v2 </span><span class="texMathInline">K</span><span class="stt">)))</span></p></td></tr></table></blockquote><p>&#27714;&#21644;&#34920;&#36798;&#24335;&#21644;&#36807;&#31243;&#35843;&#29992;&#30340;&#35268;&#33539;&#36981;&#24490;&#21516;&#26679;&#30340;&#27169;&#24335;&#65306;&#25214;&#20986;&#31532;&#19968;&#20010;&#22797;&#26434;&#25805;&#20316;&#25968;&#65292;&#36882;&#24402;&#22788;&#29702;&#37027;&#20010;&#25805;&#20316;
&#25968;&#21644;&#20462;&#25913;&#36807;&#30340;&#25805;&#20316;&#25968;&#21015;&#34920;&#12290;&#36825;&#23545;&#20219;&#20309;&#27714;&#20540;&#25805;&#20316;&#25968;&#30340;&#34920;&#36798;&#24335;&#37117;&#26377;&#25928;&#12290;&#22914;&#26524; <span class="stt">complex-exp</span>
&#26159;&#26576;&#20010;&#38656;&#35201;&#27714;&#20540;&#25805;&#20316;&#25968;&#30340; CPS-IN &#34920;&#36798;&#24335;&#65292;&#37027;&#20040;&#25105;&#20204;&#26377;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp (complex-exp </span><span class="texMathInline">simp_0</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">simp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_3</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">... </span><span class="texMathInline">exp_n</span><span class="stt">) </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp </span><span class="texMathInline">exp_2</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">var_2</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(complex-exp </span><span class="texMathInline">simp_0</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">simp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">exp_3</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">... </span><span class="texMathInline">exp_n</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;)</span></p></td></tr></table></blockquote><p>&#20854;&#20013;&#65292;<span class="texMathInline">var_2</span> &#26159;&#19968;&#20010;&#26032;&#21464;&#37327;&#12290;</p></blockquote><p>&#22788;&#29702;&#27714;&#21644;&#34920;&#36798;&#24335;&#21644;&#36807;&#31243;&#35843;&#29992;&#30340;&#21807;&#19968;&#19981;&#21516;&#20043;&#22788;&#26159;&#22312;&#25152;&#26377;&#21442;&#25968;&#37117;&#31616;&#21333;&#26102;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#35201;
&#25226;&#27599;&#20010;&#21442;&#25968;&#36716;&#25442;&#20026; CPS-OUT &#20013;&#30340; <span class="stt">simple-exp</span>&#65292;&#24182;&#29992;&#36716;&#25442;&#32467;&#26524;&#29983;&#25104;&#19968;&#20010;&#23614;&#24335;&#12290;</p><p>&#25105;&#20204;&#21487;&#20197;&#25226;&#36825;&#31181;&#34892;&#20026;&#23553;&#35013;&#21040;&#36807;&#31243; <span class="stt">cps-of-exps</span> &#20013;&#65292;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;
&#23427;&#30340;&#21442;&#25968;&#26159;&#36755;&#20837;&#34920;&#36798;&#24335;&#30340;&#21015;&#34920;&#21644;&#36807;&#31243; <span class="stt">builder</span>&#12290;&#23427;&#29992;<span class="EoplExerciseRef"></span> &#20013;&#30340;
<span class="stt">list-index</span>&#65292;&#25214;&#20986;&#21015;&#34920;&#20013;&#31532;&#19968;&#20010;&#22797;&#26434;&#34920;&#36798;&#24335;&#30340;&#20301;&#32622;&#12290;&#22914;&#26524;&#26377;&#36825;&#26679;&#30340;&#22797;&#26434;&#34920;&#36798;&#24335;&#65292;&#37027;&#20040;
&#23427;&#36716;&#25442;&#35813;&#34920;&#36798;&#24335;&#65292;&#36716;&#25442;&#25152;&#22312;&#30340;&#32493;&#25991;&#32473;&#34920;&#36798;&#24335;&#30340;&#32467;&#26524;&#21629;&#21517;&#65288;&#32465;&#23450;&#21040; <span class="stt">var</span> &#30340;&#26631;&#35782;&#31526;&#65289;&#65292;&#28982;
&#21518;&#36882;&#24402;&#22788;&#29702;&#20462;&#25913;&#21518;&#30340;&#34920;&#36798;&#24335;&#21015;&#34920;&#12290;</p><p>&#22914;&#26524;&#19981;&#23384;&#22312;&#22797;&#26434;&#34920;&#36798;&#24335;&#65292;&#37027;&#20040;&#25105;&#20204;&#29992; <span class="stt">builder</span> &#22788;&#29702;&#34920;&#36798;&#24335;&#21015;&#34920;&#12290;&#20294;&#36825;&#20123;&#34920;&#36798;&#24335;&#34429;&#26159;&#31616;
&#21333;&#30340;&#65292;&#23427;&#20204;&#20173;&#23646;&#20110; CPS-IN &#30340;&#35821;&#27861;&#12290;&#22240;&#27492;&#65292;&#25105;&#20204;&#29992;&#36807;&#31243; <span class="stt">cps-of-simple-exp</span> &#25226;&#27599;&#20010;&#34920;
&#36798;&#24335;&#36716;&#25442;&#20026; CPS-OUT &#30340;&#35821;&#27861;&#12290;&#28982;&#21518;&#65292;&#25105;&#20204;&#25226; <span class="texMathInline">\mathit{SimpleExp}</span> &#30340;&#21015;&#34920;&#20256;&#32473;
<span class="stt">builder</span>&#65288;<span class="stt">list-set</span> &#22914;<span class="EoplExerciseRef"></span> &#25152;&#36848;&#65289;&#12290;</p><p>&#36807;&#31243; <span class="stt">inp-exp-simple?</span> &#21462;&#19968; CPS-IN &#34920;&#36798;&#24335;&#65292;&#21028;&#26029;&#34920;&#31034;&#23427;&#30340;&#23383;&#31526;&#20018;&#33021;&#21542;&#35299;&#26512;&#20026;
<span class="texMathInline">\mathit{SimpleExp}</span>&#12290;&#23427;&#20351;&#29992;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#36807;&#31243; <span class="stt">every?</span>&#12290;&#33509;
<span class="texMathInline">lst</span> &#20013;&#30340;&#25152;&#26377;&#20803;&#32032;&#28385;&#36275; <span class="texMathInline">pred</span>&#65292;<span class="stt">(every? </span><span class="texMathInline">pred</span><span class="stt"> </span><span class="texMathInline">lst</span><span class="stt">)</span> &#36820;&#22238; <span class="stt">#t</span>&#65292;
&#21542;&#21017;&#36820;&#22238;<span class="stt">#f</span>&#12290;</p><p><span class="stt">cps-of-simple-exp</span> &#30340;&#20195;&#30721;&#30452;&#25130;&#20102;&#24403;&#65292;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;&#23427;&#36824;&#23558;
<span class="stt">proc-exp</span> &#30340;&#20027;&#20307;&#32763;&#35793;&#20570; CPS &#21464;&#25442;&#12290;&#33509;&#35201;&#20351;&#36755;&#20986;&#20026; <span class="texMathInline">\mathit{SimpleExp}</span>&#65292;&#36825;&#26159;&#24517;
&#35201;&#30340;&#12290;</p><p>&#25105;&#20204;&#21487;&#20197;&#29992; <span class="stt">cps-of-exps</span> &#29983;&#25104;&#27714;&#21644;&#34920;&#36798;&#24335;&#21644;&#36807;&#31243;&#35843;&#29992;&#30340;&#23614;&#24335;&#12290;</p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">cps-of-exps</span></span> : <span class="texMathInline">\mathit{Listof(InpExp)} \times \mathit{(Listof(InpExp) \to TfExp)} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-exps</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exps</span><span class="hspace">&nbsp;</span><span class="RktSym">builder</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-rest</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">exps</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">cps-of-rest</span></span> : <span class="texMathInline">\mathit{Listof(InpExp)} \to \mathit{TfExp}</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">pos</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list-index</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">not</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">inp-exp-simple?</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">not</span><span class="hspace">&nbsp;</span><span class="RktSym">pos</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">builder</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fresh-identifier</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="hspace">&nbsp;</span><span class="RktSym">pos</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-rest</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list-set</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="hspace">&nbsp;</span><span class="RktSym">pos</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">inp-exp-simple?</span></span> : <span class="texMathInline">\mathit{InpExp} \to \mathit{Bool}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">inp-exp-simple?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">and</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">inp-exp-simple?</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">inp-exp-simple?</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">inp-exp-simple?</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ids</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">every?</span><span class="hspace">&nbsp;</span><span class="RktSym">inp-exp-simple?</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p><span class="stt">cps-of-exps</span><a name="(elem._fig-6..8)"></a></p></blockquote></blockquote><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">cps-of-sum-exp</span></span> : <span class="texMathInline">\mathit{Listof(InpExp)} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-sum-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exps</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">k-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-sum-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">cps-of-simple-exp</span></span> : <span class="texMathInline">\mathit{InpExp} \to \mathit{SimpleExp}</span></td></tr><tr><td><span style="font-weight: bold">&#29992;&#27861;</span> : <span class="stt">&#35774; (inp-exp-simple? exp) = #f</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-simple-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-const-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-var-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-diff-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-zero?-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ids</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">append</span><span class="hspace">&nbsp;</span><span class="RktSym">ids</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">k%00</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-var-exp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">k%00</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-sum-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">report-invalid-exp-to-cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p><span class="stt">cps-of-simple-exp</span><a name="(elem._fig-6..9)"></a></p></blockquote></blockquote><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">cps-of-call-exp</span></span> : <span class="texMathInline">\mathit{InpExp} \times \mathit{Listof(InpExp)} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-call-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">rands</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">rands</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-call-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">append</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._1014))"></a>
<a name="(idx._(gentag._1015))"></a></div></p></blockquote><p>&#29616;&#22312;&#65292;&#25105;&#20204;&#21487;&#20197;&#20889;&#20986; CPS &#32763;&#35793;&#22120;&#30340;&#21097;&#20313;&#37096;&#20998;
&#65288;<span class="EoplFigureRef"></span>&ndash;<span class="stt">fig-6.12</span>&#65289;&#12290;&#23427;<span class="emph">&#36319;&#38543;&#35821;&#27861;</span>&#12290;&#24403;&#34920;&#36798;&#24335;&#24635;&#26159;
&#31616;&#21333;&#30340;&#65292;&#22914;&#24120;&#37327;&#12289;&#21464;&#37327;&#21644;&#36807;&#31243;&#65292;&#25105;&#20204;&#30452;&#25509;&#29992; <span class="stt">make-send-to-cont</span> &#29983;&#25104;&#20195;&#30721;&#12290;&#21542;&#21017;&#65292;&#25105;
&#20204;&#35843;&#29992;&#36741;&#21161;&#36807;&#31243;&#65292;&#27599;&#20010;&#36741;&#21161;&#36807;&#31243;&#37117;&#35843;&#29992; <span class="stt">cps-of-exps</span> &#27714;&#23376;&#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#29992;&#36866;&#24403;&#30340;&#29983;&#25104;
&#22120;&#26500;&#36896; CPS &#36755;&#20986;&#30340;&#26368;&#20869;&#37096;&#12290;&#19968;&#20010;&#20363;&#22806;&#26159; <span class="stt">cps-of-letrec-exp</span>&#65292;&#23427;&#27809;&#26377;&#32039;&#37051;&#30340;&#23376;&#34920;&#36798;&#24335;&#65292;
&#25152;&#20197;&#23427;&#30452;&#25509;&#29983;&#25104; CPS &#36755;&#20986;&#12290;&#26368;&#21518;&#65292;&#25105;&#20204;&#35843;&#29992; <span class="stt">cps-of-exps</span> &#32763;&#35793;&#25972;&#20010;&#31243;&#24207;&#65292;&#23427;&#21462;&#19968;&#29983;
&#25104;&#22120;&#65292;&#35813;&#29983;&#25104;&#22120;&#30452;&#25509;&#36820;&#22238;&#19968;&#20010;&#31616;&#21333;&#34920;&#36798;&#24335;&#12290;
<a name="(idx._(gentag._1016))"></a></p><p>&#22312;&#19979;&#38754;&#30340;&#32451;&#20064;&#20013;&#65292;&#29992; CPS-OUT &#30340;&#35821;&#27861;&#21644;&#35299;&#37322;&#22120;&#36816;&#34892;&#36755;&#20986;&#34920;&#36798;&#24335;&#65292;&#30830;&#20445;&#23427;&#20204;&#26159;&#23614;&#24335;&#12290;</p><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">cps-of-exp</span></span> : <span class="texMathInline">\mathit{InpExp} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-const-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-var-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">append</span><span class="hspace">&nbsp;</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">k%00</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-var-exp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">k%00</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">zero?-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-zero?-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">diff-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-diff-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-sum-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-if-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-let-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letrec-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p-names</span><span class="hspace">&nbsp;</span><span class="RktSym">b-varss</span><span class="hspace">&nbsp;</span><span class="RktSym">p-bodies</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-letrec-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">p-names</span><span class="hspace">&nbsp;</span><span class="RktSym">b-varss</span><span class="hspace">&nbsp;</span><span class="RktSym">p-bodies</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">call-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">rands</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-call-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">rator</span><span class="hspace">&nbsp;</span><span class="RktSym">rands</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">cps-of-zero?-exp</span></span> : <span class="texMathInline">\mathit{InpExp} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-zero?-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">k-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-zero?-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p><span class="stt">cps-of-exp</span>&#65292;&#31532;1&#37096;&#20998;
<a name="(idx._(gentag._1017))"></a>
<a name="(idx._(gentag._1018))"></a><a name="(elem._fig-6..10)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">cps-of-diff-exp</span></span> : <span class="texMathInline">\mathit{InpExp} \times \mathit{InpExp} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-diff-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">k-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-diff-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cadr</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">cps-of-if-exp</span></span> : <span class="texMathInline">\mathit{InpExp} \times \mathit{InpExp} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-if-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-if-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">cps-of-let-exp</span></span> : <span class="texMathInline">\mathit{Var} \times \mathit{InpExp} \times \mathit{InpExp} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-let-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">id</span><span class="hspace">&nbsp;</span><span class="RktSym">rhs</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">call-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">id</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">rhs</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">cps-of-letrec-exp</span></span> : <br/> <span class="texMathInline">\phantom{x}\mathit{Listof(Var)} \times \mathit{Listof(Listof(Var))} \times \mathit{Listof(InpExp)} \times \mathit{InpExp} \times \mathit{SimpleExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-letrec-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p-names</span><span class="hspace">&nbsp;</span><span class="RktSym">b-varss</span><span class="hspace">&nbsp;</span><span class="RktSym">p-bodies</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-letrec-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">p-names</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">b-vars</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">append</span><span class="hspace">&nbsp;</span><span class="RktSym">b-vars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">k%00</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">b-varss</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p-body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">p-body</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-var-exp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">k%00</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">p-bodies</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">letrec-body</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p><span class="stt">cps-of-exp</span>&#65292;&#31532;2&#37096;&#20998;<a name="(elem._fig-6..11)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">cps-of-program</span></span> : <span class="texMathInline">\mathit{InpExp} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pgm</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">program</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-a-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-args</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple-exp-&gt;exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">new-args</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p><span class="stt">cps-of-exp</span>&#65292;&#31532;3&#37096;&#20998;
<a name="(idx._(gentag._1019))"></a>
<a name="(idx._(gentag._1020))"></a><a name="(elem._fig-6..12)"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._1021))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex6..20)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1022))"></a>
<a name="(idx._(gentag._1023))"></a>
&#25105;&#20204;&#30340;&#36807;&#31243; <span class="stt">cps-of-exps</span> &#36843;&#20351;&#23376;&#34920;&#36798;&#24335;&#25353;&#20174;&#24038;&#21521;&#21491;&#30340;&#39034;&#24207;&#27714;&#20540;&#12290;&#20462;&#25913;
<span class="stt">cps-of-exps</span>&#65292;&#20351;&#23376;&#34920;&#36798;&#24335;&#20174;&#21491;&#21521;&#24038;&#27714;&#20540;&#12290;
<a name="(idx._(gentag._1024))"></a>
<a name="(idx._(gentag._1025))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..21)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913; <span class="stt">cps-of-call-exp</span>&#65292;&#20808;&#20174;&#24038;&#21521;&#21491;&#27714;&#20986;&#25805;&#20316;&#25968;&#30340;&#20540;&#65292;&#20877;&#27714;&#25805;&#20316;&#31526;&#30340;&#20540;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..22)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#26377;&#26102;&#65292;&#24403;&#25105;&#20204;&#29983;&#25104; <span class="stt">(</span><span class="texMathInline">K</span><span class="stt"> </span><span class="texMathInline">simp</span><span class="stt">)</span>&#65292;<span class="texMathInline">K</span> &#24050;&#32463;&#26159;&#19968;&#20010; <span class="stt">proc-exp</span>&#12290;&#25152;&#20197;&#65292;&#19981;
&#26159;&#29983;&#25104;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(proc (</span><span class="texMathInline">var_1</span><span class="stt">) ... </span><span class="texMathInline">simp</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#32780;&#24212;&#29983;&#25104;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let </span><span class="texMathInline">var_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">= </span><span class="texMathInline">simp</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">in ...</span></p></td></tr></table></blockquote><p>&#37027;&#20040;&#65292;CPS &#20195;&#30721;&#20855;&#26377;&#24615;&#36136;&#65306;&#24418;&#22914;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(proc (</span><span class="texMathInline">var</span><span class="stt">) </span><span class="texMathInline">exp_1</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">simp</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#30340;&#23376;&#34920;&#36798;&#24335;&#33509;&#19981;&#22312;&#21407;&#34920;&#36798;&#24335;&#20013;&#65292;&#21017;&#19981;&#20250;&#20986;&#29616;&#22312; CPS &#20195;&#30721;&#20013;&#12290;</p><p>&#20462;&#25913; <span class="stt">make-send-to-cont</span>&#65292;&#29983;&#25104;&#26356;&#22909;&#30340;&#20195;&#30721;&#12290;&#26032;&#30340;&#35268;&#21017;&#20309;&#26102;&#29983;&#25928;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..23)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1026))"></a>
&#35266;&#23519;&#21487;&#30693;&#65292;<span class="stt">if</span> &#30340;&#35268;&#21017;&#23548;&#33268;&#32493;&#25991; <span class="texMathInline">K</span> &#22797;&#21046;&#20004;&#27425;&#65292;&#25152;&#20197;&#22312;&#23884;&#22871;&#30340; <span class="stt">if</span> &#20013;&#65292;&#36716;&#25442;&#21518;
&#30340;&#20195;&#30721;&#23610;&#23544;&#21576;&#25351;&#25968;&#22686;&#38271;&#12290;&#36816;&#34892;&#19968;&#20010;&#20363;&#23376;&#65292;&#39564;&#35777;&#36825;&#19968;&#35266;&#23519;&#12290;&#28982;&#21518;&#65292;&#20462;&#25913;&#36716;&#25442;&#65292;&#25226; <span class="texMathInline">K</span> &#32465;&#23450;
&#21040;&#26032;&#30340;&#21464;&#37327;&#65292;&#20174;&#32780;&#36991;&#20813;&#36825;&#31181;&#22686;&#38271;&#12290;
<a name="(idx._(gentag._1027))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..24)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1028))"></a>
&#32473;&#35821;&#35328;&#28155;&#21152;&#21015;&#34920;&#65288;<span class="EoplExerciseRef"></span>&#65289;&#12290;&#35760;&#20303;&#65306;&#21015;&#34920;&#30340;&#21442;&#25968;&#19981;&#22312;&#23614;&#31471;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..25)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1029))"></a>
&#25193;&#23637; CPS-IN&#65292;&#35753; <span class="stt">let</span> &#34920;&#36798;&#24335;&#22768;&#26126;&#20219;&#24847;&#25968;&#37327;&#30340;&#21464;&#37327;&#65288;<span class="EoplExerciseRef"></span>&#65289;&#12290;
<a name="(idx._(gentag._1030))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..26)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#30001; <span class="stt">cps-of-exps</span> &#24341;&#20837;&#30340;&#32493;&#25991;&#21464;&#37327;&#22312;&#32493;&#25991;&#20013;&#21482;&#20250;&#21482;&#20250;&#20986;&#29616;&#19968;&#27425;&#12290;&#20462;&#25913;
<span class="stt">make-send-to-cont</span>&#65292;&#19981;&#26159;&#29983;&#25104;<span class="EoplExerciseRef"></span> &#20013;&#30340;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let </span><span class="texMathInline">var_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">= </span><span class="texMathInline">simp_1</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">in </span><span class="texMathInline">T</span></p></td></tr></table></blockquote><p>&#32780;&#26159;&#29983;&#25104; <span class="texMathInline">T[simp_1/var_1]</span>&#12290;&#20854;&#20013;&#65292;&#31526;&#21495; <span class="texMathInline">E_1[E_2/var]</span> &#24847;&#20026;&#65292;&#25226;&#34920;&#36798;&#24335; <span class="texMathInline">E_1</span>
&#20013;&#33258;&#30001;&#20986;&#29616;&#30340;&#25152;&#26377;&#21464;&#37327; <span class="texMathInline">var</span> &#26367;&#25442;&#20026; <span class="texMathInline">E_2</span>&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..27)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25353;&#24403;&#21069;&#26041;&#24335;&#65292;<span class="stt">cps-of-let-exp</span> &#29983;&#25104;&#19968;&#20010;&#26080;&#29992;&#30340; <span class="stt">let</span> &#34920;&#36798;&#24335;&#65288;&#20026;&#20160;&#20040;&#65311;&#65289;&#12290;&#20462;&#25913;
&#36825;&#20010;&#36807;&#31243;&#65292;&#30452;&#25509;&#25226; <span class="stt">let</span> &#21464;&#37327;&#20316;&#20026;&#32493;&#25991;&#21464;&#37327;&#12290;&#37027;&#20040;&#65292;&#33509; <span class="texMathInline">exp_1</span> &#26159;&#22797;&#26434;&#30340;&#65292;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;let </span><span class="texMathInline">var_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">= </span><span class="texMathInline">exp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">in </span><span class="texMathInline">exp_2</span><span class="stt">&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp </span><span class="texMathInline">exp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">&lt;&lt;proc (</span><span class="texMathInline">var_1</span><span class="stt">) (cps-of-exp </span><span class="texMathInline">exp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;)</span></p></td></tr></table></blockquote></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..28)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#35797;&#24819;&#65306;&#26377;&#19968;&#20010; Scheme &#31243;&#24207;&#30340; CPS &#36716;&#25442;&#22120;&#65292;&#29992;&#23427;&#36716;&#25442;<a href="expr.html" data-pltdoc="x">&#34920;&#36798;&#24335;</a>&#20013;&#30340;&#31532;&#19968;&#20010;&#35299;&#37322;&#22120;&#65292;&#32467;
&#26524;&#20250;&#24590;&#26679;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..29)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32771;&#34385; <span class="stt">cps-of-exps</span> &#30340;&#21464;&#20307;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-exps</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exps</span><span class="hspace">&nbsp;</span><span class="RktSym">builder</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-rest</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">exps</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">acc</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">cps-of-rest</span></span> : <span class="texMathInline">\mathit{Listof(InpExp)} \times \mathit{Listof(SimpleExp)} \to \mathit{TfExp}</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">null?</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">builder</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reverse</span><span class="hspace">&nbsp;</span><span class="RktSym">acc</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">inp-exp-simple?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-rest</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">acc</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fresh-identifier</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-rest</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">exps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">acc</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#20026;&#20160;&#20040; <span class="stt">cps-of-exp</span> &#30340;&#36825;&#31181;&#21464;&#20307;&#27604;<span class="EoplFigureRef"></span> &#20013;&#30340;&#26356;&#39640;&#25928;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..30)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#35843;&#29992; <span class="stt">cps-of-exps</span> &#22788;&#29702;&#38271;&#24230;&#20026; 1 &#30340;&#34920;&#36798;&#24335;&#21015;&#34920;&#21487;&#20197;&#31616;&#21270;&#22914;&#19979;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exps (list </span><span class="texMathInline">exp</span><span class="stt">) </span><span class="texMathInline">builder</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp/ctx </span><span class="texMathInline">exp</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(lambda (simp) (</span><span class="texMathInline">builder</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(list simp))))</span></p></td></tr></table></blockquote><p>&#20854;&#20013;&#65292;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">cps-of-exp/ctx</span></span> : <span class="texMathInline">\mathit{InpExp} \times \mathit{(SimpleExp \rightarrow{} TfExp)} \to \mathit{TfExp}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-exp/ctx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">context</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">inp-exp-simple?</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">context</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fresh-identifier</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-proc-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">context</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-var-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#36825;&#26679;&#65292;&#30001;&#20110;&#21015;&#34920;&#30340;&#21442;&#25968;&#25968;&#37327;&#24050;&#32463;&#30830;&#23450;&#65292;&#25105;&#20204;&#21487;&#20197;&#31616;&#21270;&#20986;&#29616; <span class="stt">(cps-of-exps (list ...))</span>
&#30340;&#22320;&#26041;&#12290;&#37027;&#20040;&#65292;&#35832;&#22914; <span class="stt">cps-of-diff-exp</span> &#21487;&#20197;&#29992; <span class="stt">cps-of-exp/ctx</span> &#23450;&#20041;&#65292;&#32780;&#19981;&#38656;
&#35201; <span class="stt">cps-of-exps</span>&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cps-of-diff-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp/ctx</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exp/ctx</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-diff-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simp1</span><span class="hspace">&nbsp;</span><span class="RktSym">simp2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#23545; <span class="stt">cps-of-call-exp</span> &#20013;&#29992;&#21040;&#30340; <span class="stt">cps-of-exps</span>&#65292;&#25105;&#20204;&#21487;&#20197;&#29992;
<span class="stt">cps-of-exp/ctx</span> &#22788;&#29702; <span class="stt">rator</span>&#65292;&#20294;&#20173;&#38656;&#20351;&#29992; <span class="stt">cps-of-exps</span> &#22788;&#29702; <span class="stt">rands</span>&#12290;
&#21024;&#38500;&#32763;&#35793;&#22120;&#20013;&#20854;&#20182;&#22320;&#26041;&#20986;&#29616;&#30340; <span class="stt">cps-of-exps</span>&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..31)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1031))"></a>
<a name="(idx._(gentag._1032))"></a>
<a name="(idx._(gentag._1033))"></a>
&#20889;&#19968;&#20010;&#32763;&#35793;&#22120;&#65292;&#23427;&#21462; <span class="stt">cps-of-program</span> &#30340;&#36755;&#20986;&#65292;&#29983;&#25104;&#19968;&#20010;&#31561;&#20215;&#31243;&#24207;&#65292;&#20854;&#20013;&#25152;&#26377;&#30340;&#32493;&#25991;
&#37117;&#29992;<a href="cpi.html" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a>&#20013;&#30340;&#25968;&#25454;&#32467;&#26500;&#34920;&#31034;&#12290;&#29992;&#21015;&#34920;&#34920;&#31034;&#37027;&#20123;&#29992; <span class="stt">define-datatype</span> &#29983;&#25104;&#30340;&#25968;
&#25454;&#32467;&#26500;&#12290;&#30001;&#20110;&#25105;&#20204;&#30340;&#35821;&#35328;&#19981;&#25903;&#25345;&#31526;&#21495;&#65292;&#20320;&#21487;&#20197;&#22312;&#39318;&#39033;&#20301;&#32622;&#20351;&#29992;&#25972;&#25968;&#26631;&#31614;&#65292;&#20197;&#27492;&#21306;&#20998;&#25968;&#25454;&#31867;&#22411;
&#30340;&#21464;&#20307;&#12290;
<a name="(idx._(gentag._1034))"></a>
<a name="(idx._(gentag._1035))"></a>
<a name="(idx._(gentag._1036))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..32)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1037))"></a>
&#20889;&#19968;&#20010;&#32763;&#35793;&#22120;&#65292;&#23427;&#31867;&#20284;<span class="EoplExerciseRef"></span>&#65292;&#20294;&#25226;&#25152;&#26377;&#36807;&#31243;&#34920;&#31034;&#20026;&#25968;&#25454;&#32467;&#26500;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..33)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1038))"></a>
&#20889;&#19968;&#20010;&#32763;&#35793;&#22120;&#65292;&#23427;&#21462;<span class="EoplExerciseRef"></span> &#30340;&#36755;&#20986;&#65292;&#23558;&#20854;&#36716;&#25442;&#20026;<span class="EoplFigureRef"></span>
&#37027;&#26679;&#30340;&#23492;&#23384;&#22120;&#31243;&#24207;&#12290;
<a name="(idx._(gentag._1039))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..34)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1040))"></a>
<a name="(idx._(gentag._1041))"></a>
<a name="(idx._(gentag._1042))"></a>
&#25105;&#20204;&#25226;&#31243;&#24207;&#36716;&#25442;&#20026; CPS &#26102;&#65292;&#19981;&#20165;&#23558;&#31243;&#24207;&#20013;&#30340;&#25511;&#21046;&#19978;&#19979;&#25991;&#21464;&#20026;&#26174;&#24335;&#30340;&#65292;&#32780;&#19988;&#36824;&#30830;&#23450;&#20102;&#25805;&#20316;&#30340;
&#25191;&#34892;&#39034;&#24207;&#65292;&#20197;&#21450;&#25152;&#26377;&#20013;&#38388;&#32467;&#26524;&#30340;&#21517;&#23383;&#12290;&#21518;&#32773;&#21483;&#20570;<span class="emph">&#24207;&#21015;&#21270;</span> (<span class="emph">sequentialization</span>)&#12290;&#22914;
&#26524;&#25105;&#20204;&#19981;&#20851;&#24515;&#33021;&#21542;&#33719;&#24471;&#36845;&#20195;&#24615;&#25511;&#21046;&#34892;&#20026;&#65292;&#25105;&#20204;&#24207;&#21015;&#21270;&#31243;&#24207;&#26102;&#21487;&#23558;&#20854;&#36716;&#25442;&#20026;
<span class="emph">A-normal form</span>&#65292;&#25110;&#31216;<span class="emph">ANF</span>&#12290;&#36825;&#37324;&#26159;&#19968;&#20010; ANF &#31243;&#24207;&#30340;&#20363;&#23376;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">fib/anf</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib/anf</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fib/anf</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>CPS &#31243;&#24207;&#20256;&#36882;&#21629;&#21517;&#20013;&#38388;&#32467;&#26524;&#30340;&#32493;&#25991;&#65292;&#20174;&#32780;&#24207;&#21015;&#21270;&#35745;&#31639;&#65307;ANF &#31243;&#24207;&#29992; <span class="stt">let</span> &#34920;&#36798;&#24335;&#21629;&#21517;&#25152;
&#26377;&#20013;&#38388;&#32467;&#26524;&#65292;&#20174;&#32780;&#24207;&#21015;&#21270;&#35745;&#31639;&#12290;</p><p>&#37325;&#20889; <span class="stt">cps-of-exp</span>&#65292;&#29983;&#25104; ANF &#31243;&#24207;&#32780;&#38750; CPS &#31243;&#24207;&#65288;&#23545;&#19981;&#22312;&#23614;&#31471;&#30340;&#26465;&#20214;&#34920;&#36798;&#24335;&#65292;
&#29992;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#26041;&#27861;&#22788;&#29702;&#65289;&#12290;&#28982;&#21518;&#65292;&#29992;&#20462;&#25913;&#21518;&#30340; <span class="stt">cps-of-exp</span> &#22788;&#29702;&#20363;
<span class="stt">fib</span> &#30340;&#23450;&#20041;&#65292;&#39564;&#35777;&#20854;&#32467;&#26524;&#26159;&#21542;&#20026; <span class="stt">fib/anf</span>&#12290;&#26368;&#21518;&#65292;&#39564;&#35777;&#23545;&#24050;&#32463;&#26159; ANF &#30340;&#36755;&#20837;&#31243;
&#24207;&#65292;&#20320;&#30340;&#32763;&#35793;&#22120;&#20135;&#29983;&#30340;&#31243;&#24207;&#19982;&#36755;&#20837;&#21482;&#26377;&#32465;&#23450;&#21464;&#37327;&#21517;&#19981;&#21516;&#12290;
<a name="(idx._(gentag._1043))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..35)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#29992;&#20960;&#20010;&#20363;&#23376;&#39564;&#35777;&#65306;&#33509;&#37319;&#29992;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#20248;&#21270;&#26041;&#27861;&#65292;&#23545; ANF &#36716;&#25442;&#22120;
&#65288;<span class="EoplExerciseRef"></span>&#65289;&#30340;&#36755;&#20837;&#21644;&#36755;&#20986;&#31243;&#24207;&#36827;&#34892; CPS &#21464;&#25442;&#65292;&#25152;&#24471;&#32467;&#26524;&#30456;&#21516;&#12290;
<a name="(idx._(gentag._1044))"></a>
<a name="(idx._(gentag._1045))"></a></p></blockquote><h4>6.4<tt>&nbsp;</tt><a name="(part._s6..4)"></a>&#24314;&#27169;&#35745;&#31639;&#25928;&#26524;</h4><p><a name="(idx._(gentag._1046))"></a>
CPS &#30340;&#21478;&#19968;&#37325;&#35201;&#24212;&#29992;&#26159;&#25552;&#20379;&#27169;&#22411;&#65292;&#23558;&#35745;&#31639;&#25928;&#26524;&#21464;&#20026;&#26174;&#24335;&#30340;&#12290;&#35745;&#31639;&#25928;&#26524;&#8212;&#8212;&#20687;&#26159;&#25171;&#21360;&#25110;&#32473;&#21464;&#37327;&#36171;
&#20540;&#8212;&#8212;&#24456;&#38590;&#29992;<a href="expr.html" data-pltdoc="x">&#34920;&#36798;&#24335;</a>&#20351;&#29992;&#30340;&#26041;&#31243;&#25512;&#29702;&#24314;&#27169;&#12290;&#36890;&#36807; CPS &#21464;&#25442;&#65292;&#25105;&#20204;&#21487;&#20197;&#23558;&#36825;&#20123;&#25928;&#26524;&#21464;&#20026;
&#26174;&#24335;&#30340;&#65292;&#23601;&#20687;&#25105;&#20204;&#22312;<a href="cpi.html" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a>&#20013;&#22788;&#29702;&#38750;&#23616;&#37096;&#25511;&#21046;&#27969;&#19968;&#26679;&#12290;</p><p><a name="(idx._(gentag._1047))"></a>
<a name="(idx._(gentag._1048))"></a>
<a name="(idx._(gentag._1049))"></a>
&#29992; CPS &#24314;&#27169;&#25928;&#26524;&#26102;&#65292;&#25105;&#20204;&#30340;&#22522;&#26412;&#21407;&#21017;&#26159;&#31616;&#21333;&#34920;&#36798;&#24335;&#19981;&#24212;&#26377;&#20219;&#20309;&#25928;&#26524;&#12290;&#31616;&#21333;&#34920;&#36798;&#24335;&#19981;&#24212;&#21547;&#26377;
&#36807;&#31243;&#35843;&#29992;&#20063;&#26159;&#22522;&#20110;&#36825;&#19968;&#21407;&#21017;&#65292;&#22240;&#20026;&#36807;&#31243;&#35843;&#29992;&#21487;&#33021;&#19981;&#32456;&#27490;&#65288;&#36825;&#24403;&#28982;&#26159;&#19968;&#31181;&#25928;&#26524;&#65281;&#65289;&#12290;</p><p>&#26412;&#33410;&#65292;&#25105;&#20204;&#30740;&#31350;&#19977;&#31181;&#25928;&#26524;&#65306;&#25171;&#21360;&#65292;&#23384;&#20648;&#22120;&#65288;&#29992;&#26174;&#24335;&#24341;&#29992;&#27169;&#22411;&#65289;&#65292;&#20197;&#21450;&#38750;&#26631;&#20934;&#25511;&#21046;&#27969;&#12290;</p><p>&#25105;&#20204;&#39318;&#20808;&#32771;&#34385;&#25171;&#21360;&#12290;&#25171;&#21360;&#24403;&#28982;&#26159;&#19968;&#31181;&#25928;&#26524;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(f print(3) print(4))</span></p></td></tr></table></blockquote><p>&#21644;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(f 1 1)</span></p></td></tr></table></blockquote><p>&#21363;&#20351;&#36820;&#22238;&#21516;&#26679;&#30340;&#31572;&#26696;&#65292;&#20063;&#20855;&#26377;&#19981;&#21516;&#25928;&#26524;&#12290;&#25928;&#26524;&#36824;&#21462;&#20915;&#20110;&#21442;&#25968;&#30340;&#27714;&#20540;&#39034;&#24207;&#12290;&#36804;&#20170;&#20026;&#27490;&#65292;&#25105;&#20204;&#30340;
&#35821;&#35328;&#24635;&#26159;&#25353;&#20174;&#24038;&#21521;&#21491;&#30340;&#39034;&#24207;&#27714;&#21442;&#25968;&#30340;&#20540;&#65292;&#20294;&#20854;&#20182;&#35821;&#35328;&#21487;&#33021;&#19981;&#26159;&#36825;&#26679;&#12290;</p></blockquote><p>&#35201;&#24314;&#27169;&#36825;&#20123;&#24819;&#27861;&#65292;&#25105;&#20204;&#25353;&#29031;&#19979;&#38754;&#30340;&#26041;&#24335;&#20462;&#25913; CPS &#21464;&#25442;&#65306;</p><ul><li><p>&#25105;&#20204;&#32473; CPS-IN &#28155;&#21152; <span class="stt">print</span> &#34920;&#36798;&#24335;&#65306;
<a name="(idx._(gentag._1050))"></a></p><blockquote class="Small"><p><span class="Iidentity">\begin{align*}\mathit{InpExp} &amp;::= <span class="stt">print (</span><span class="Iidentity">\mathit{InpExp}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">print-exp (exp1)</span>}\end{align*}</span></p></blockquote><p>&#25105;&#20204;&#23578;&#26410;&#20889;&#20986; CPS-IN &#30340;&#35299;&#37322;&#22120;&#65292;&#20294;&#35299;&#37322;&#22120;&#24212;&#24403;&#25193;&#23637;&#65292;&#20174;&#32780;&#22788;&#29702; <span class="stt">print-exp</span>&#65307;&#23427;&#25171;&#21360;
&#20986;&#21442;&#25968;&#30340;&#20540;&#65292;&#36820;&#22238;&#26576;&#20010;&#20540;&#65288;&#25105;&#20204;&#36873;&#20219;&#24847;&#20540; 38&#65289;&#12290;</p></li><li><p>&#25105;&#20204;&#32473; CPS-OUT &#28155;&#21152; <span class="stt">printk</span> &#34920;&#36798;&#24335;&#65306;</p><blockquote class="Small"><p><span class="Iidentity">\begin{align*}\mathit{TfExp} &amp;::= <span class="stt">printk (</span><span class="Iidentity">\mathit{SimpleExp}</span><span class="stt">) ; </span><span class="Iidentity">\mathit{TfExp}</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-printk-exp (simple-exp1 body)</span>}\end{align*}</span></p></blockquote><p>&#34920;&#36798;&#24335; <span class="stt">printk(</span><span class="texMathInline">simp</span><span class="stt">);</span><span class="texMathInline">exp</span> &#26377;&#19968;&#31181;&#25928;&#26524;&#65306;&#25171;&#21360;&#12290;&#22240;&#27492;&#65292;&#23427;&#24517;&#39035;&#26159;&#19968;&#20010;
<span class="texMathInline">\mathit{TfExp}</span>&#65292;&#32780;&#38750; <span class="texMathInline">\mathit{SimpleExp}</span>&#65292;&#19988;&#21482;&#33021;&#20986;&#29616;&#22312;&#23614;&#31471;&#12290;<span class="texMathInline">exp</span> &#30340;&#20540;
&#25104;&#20026;&#25972;&#20010; <span class="stt">printk</span>&#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#25152;&#20197; <span class="texMathInline">exp</span> &#26412;&#36523;&#22312;&#23614;&#31471;&#65292;&#21487;&#20197;&#26159;&#19968;&#20010; <span class="stt">tfexp</span>&#12290;
&#37027;&#20040;&#65292;&#36825;&#37096;&#20998;&#20195;&#30721;&#21487;&#20197;&#20889;&#20316;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">printk(-(v1,1));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(f v1 </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#35201;&#23454;&#29616;&#23427;&#65292;&#25105;&#20204;&#32473; CPS-OUT &#30340;&#35299;&#37322;&#22120;&#28155;&#21152;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">printk-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eopl:printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"~s~%"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">cont</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></li><li><p>&#25105;&#20204;&#32473; <span class="stt">cps-of-exp</span> &#28155;&#21152;&#19968;&#34892;&#20195;&#30721;&#65292;&#25226; <span class="stt">print</span> &#34920;&#36798;&#24335;&#32763;&#35793;&#20026;
<span class="stt">printk</span> &#34920;&#36798;&#24335;&#12290;&#25105;&#20204;&#20026; <span class="stt">print</span> &#36873;&#25321;&#20219;&#24847;&#36820;&#22238;&#20540; 38&#12290;&#25152;&#20197;&#65292;&#25105;&#20204;&#30340;&#32763;&#35793;&#24212;&#20026;&#65306;</p><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;print(</span><span class="texMathInline">simp_1</span><span class="stt">)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">) = printk(</span><span class="texMathInline">simp_1</span><span class="stt">) ; (</span><span class="texMathInline">K</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">38)</span></p></td></tr></table></blockquote><p>&#28982;&#21518;&#65292;&#30001;&#20110; <span class="stt">print</span> &#30340;&#21442;&#25968;&#21487;&#33021;&#26159;&#22797;&#26434;&#30340;&#65292;&#25105;&#20204;&#29992; <span class="stt">cps-of-exps</span> &#22788;&#29702;&#12290;&#36825;&#26679;&#65292;
&#25105;&#20204;&#32473; <span class="stt">cps-of-exp</span> &#26032;&#22686;&#36825;&#20960;&#34892;&#20195;&#30721;&#65306;</p><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">print-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">rator</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-printk-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-const-exp</span><span class="hspace">&nbsp;</span><span class="RktVal">38</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._1051))"></a></div></p></blockquote></li></ul><p>&#26469;&#30475;&#19968;&#20010;&#26356;&#22797;&#26434;&#30340;&#20363;&#23376;&#12290;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;(f print((g x)) print(4))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp &lt;&lt;print((g x))&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(f v1 print(4))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;)</span></p></td></tr><tr><td><p><span class="stt">= (cps-of-exp &lt;&lt;(g x)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(print v2)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(f v1 print(4))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;)&gt;&gt;)</span></p></td></tr><tr><td><p><span class="stt">= (g x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(print v2)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (v1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(f v1 print(4))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;))</span></p></td></tr><tr><td><p><span class="stt">= (g x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">printk(v2);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let v1 = 38</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (cps-of-exp &lt;&lt;(f v1 print(4))&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt">= (g x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">printk(v2);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let v1 = 38</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (cps-of-exp &lt;&lt;print(4)&gt;&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;&lt;proc (v3)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(cps-of-exp &lt;&lt;(f v1 v3)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)&gt;&gt;))</span></p></td></tr><tr><td><p><span class="stt">= (g x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">printk(v2);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let v1 = 38</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in printk(4);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let v3 = 38</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (cps-of-exp &lt;&lt;(f v1 v3)&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">))</span></p></td></tr><tr><td><p><span class="stt">= (g x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (v2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">printk(v2);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let v1 = 38</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in printk(4);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let v3 = 38</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (f v1 v3 </span><span class="texMathInline">k</span><span class="stt">))</span></p></td></tr></table></blockquote><p>&#36825;&#37324;&#65292;&#25105;&#20204;&#35843;&#29992; <span class="stt">g</span>&#65292;&#35843;&#29992;&#25152;&#22312;&#30340;&#32493;&#25991;&#25226;&#32467;&#26524;&#21629;&#21517;&#20026; <span class="stt">v2</span>&#12290;&#32493;&#25991;&#25171;&#21360;&#20986; <span class="stt">v2</span> &#30340;
&#20540;&#65292;&#25226; 38 &#20256;&#32473;&#19979;&#19968;&#32493;&#25991;&#65292;&#19979;&#19968;&#32493;&#25991;&#23558; <span class="stt">v1</span> &#32465;&#23450;&#21040;&#23454;&#21442; 38&#65292;&#25171;&#21360;&#20986; 4&#65292;&#28982;&#21518;&#35843;&#29992;&#19979;&#19968;
&#32493;&#25991;&#65292;&#19979;&#19968;&#32493;&#25991;&#25226; <span class="stt">v2</span> &#32465;&#23450;&#21040;&#23454;&#21442;&#65288;&#20063;&#26159; 38&#65289;&#65292;&#28982;&#21518;&#29992; <span class="stt">v1</span>&#65292;<span class="stt">v3</span> &#21644; <span class="texMathInline">K</span>
&#35843;&#29992; <span class="stt">f</span>&#12290;</p><p><a name="(idx._(gentag._1052))"></a>
<a name="(idx._(gentag._1053))"></a>
&#25105;&#20204;&#25353;&#29031;&#21516;&#26679;&#30340;&#27493;&#39588;&#24314;&#27169;&#26174;&#24335;&#24341;&#29992;&#65288;<a href="state.html#%28part._s4..2%29" data-pltdoc="x">EXPLICIT-REFS&#65306;&#26174;&#24335;&#24341;&#29992;&#35821;&#35328;</a>&#65289;&#12290;&#25105;&#20204;&#32473; CPS-IN &#21644; CPS-OUT &#28155;&#21152;&#26032;
&#30340;&#35821;&#27861;&#65292;&#32473; CPS-OUT &#30340;&#35299;&#37322;&#22120;&#28155;&#21152;&#20195;&#30721;&#65292;&#22788;&#29702;&#26032;&#30340;&#35821;&#27861;&#65292;&#32473; <span class="stt">cps-of-exp</span> &#28155;&#21152;&#20195;&#30721;&#65292;
&#23558;&#26032;&#30340; CPS-IN &#35821;&#27861;&#32763;&#35793;&#20026; CPS-OUT&#12290;&#23545;&#26174;&#24335;&#24341;&#29992;&#65292;&#25105;&#20204;&#38656;&#35201;&#28155;&#21152;&#21019;&#24314;&#24341;&#29992;&#65292;&#35299;&#24341;&#29992;&#21644;&#36171;&#20540;
&#30340;&#35821;&#27861;&#12290;</p><ul><li><p>&#25105;&#20204;&#32473; CPS-IN &#28155;&#21152;&#35821;&#27861;&#65306;
<a name="(idx._(gentag._1054))"></a>
<a name="(idx._(gentag._1055))"></a>
<a name="(idx._(gentag._1056))"></a>
<a name="(idx._(gentag._1057))"></a></p><blockquote class="Small"><p><span class="Iidentity">\begin{align*}\mathit{InpExp} &amp;::= <span class="stt">newref (</span><span class="Iidentity">\mathit{InpExp}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">newref-exp (exp1)</span>} \\[5pt]
  \mathit{InpExp} &amp;::= <span class="stt">deref (</span><span class="Iidentity">\mathit{InpExp}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">deref-exp (exp1)</span>} \\[5pt]
\mathit{InpExp} &amp;::= <span class="stt">setref (</span><span class="Iidentity">\mathit{InpExp}</span><span class="stt"> , </span><span class="Iidentity">\mathit{InpExp}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">setref-exp (exp1 exp2)</span>}\end{align*}</span></p></blockquote></li><li><p>&#25105;&#20204;&#32473; CPS-OUT &#28155;&#21152;&#35821;&#27861;&#65306;</p><blockquote class="Small"><p><span class="Iidentity">\begin{align*}\mathit{TfExp} &amp;::= <span class="stt">newrefk (</span><span class="Iidentity">\mathit{simple\mbox{-}exp}</span><span class="stt">, </span><span class="Iidentity">\mathit{simple\mbox{-}exp}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-newrefk-exp (simple1 simpe2)</span>} \\[5pt]
   \mathit{TfExp} &amp;::= <span class="stt">derefk (</span><span class="Iidentity">\mathit{simple\mbox{-}exp}</span><span class="stt">, </span><span class="Iidentity">\mathit{simple\mbox{-}exp}</span><span class="stt">)</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-derefk-exp (simple1 simpe2)</span>} \\[5pt]
   \mathit{TfExp} &amp;::= <span class="stt">setrefk (</span><span class="Iidentity">\mathit{simple\mbox{-}exp}</span><span class="stt">, </span><span class="Iidentity">\mathit{simple\mbox{-}exp}</span><span class="stt">) ; </span><span class="Iidentity">\mathit{TfExp}</span> \\[-3pt]
&amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">cps-setrefk-exp (simple1 simpe2)</span>}\end{align*}</span></p></blockquote><p><span class="stt">newrefk</span> &#34920;&#36798;&#24335;&#21462;&#20004;&#20010;&#21442;&#25968;&#65306;&#25918;&#20837;&#26032;&#20998;&#37197;&#21333;&#20803;&#30340;&#20540;&#65292;&#25509;&#25910;&#26032;&#20301;&#32622;&#24341;&#29992;&#30340;&#32493;&#25991;&#12290;
<span class="stt">derefk</span> &#19982;&#20043;&#31867;&#20284;&#12290;&#30001;&#20110; <span class="stt">setrefk</span> &#30340;&#25191;&#34892;&#36890;&#24120;&#21482;&#27714;&#25928;&#26524;&#65292;<span class="stt">setrefk</span> &#30340;&#35774;&#35745;
&#19982; <span class="stt">printk</span> &#31867;&#20284;&#12290;&#23427;&#23558;&#31532;&#20108;&#20010;&#21442;&#25968;&#30340;&#20540;&#36171;&#32473;&#31532;&#19968;&#20010;&#21442;&#25968;&#30340;&#20540;&#65292;&#21518;&#32773;&#24212;&#26159;&#19968;&#20010;&#24341;&#29992;&#65292;&#28982;
&#21518;&#23614;&#36882;&#24402;&#24335;&#22320;&#25191;&#34892;&#31532;&#19977;&#20010;&#21442;&#25968;&#12290;</p><p>&#22312;&#36825;&#38376;&#35821;&#35328;&#20013;&#65292;&#25105;&#20204;&#20889;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">newrefk(33, proc (loc1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">newrefk(44, proc (loc2)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">setrefk(loc1,22);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">derefk(loc1, proc (val)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">-(val,1))))</span></p></td></tr></table></blockquote><p>&#36825;&#20010;&#31243;&#24207;&#26032;&#20998;&#37197;&#19968;&#20010;&#20301;&#32622;&#65292;&#20540;&#20026; 33&#65292;&#25226; <span class="stt">loc1</span> &#32465;&#23450;&#21040;&#37027;&#20010;&#20301;&#32622;&#12290;&#28982;&#21518;&#65292;&#23427;&#26032;&#20998;&#37197;&#19968;&#20010;
&#20301;&#32622;&#65292;&#20540;&#20026; 44&#65292;&#25226; <span class="stt">loc2</span> &#32465;&#23450;&#21040;&#37027;&#20010;&#20301;&#32622;&#12290;&#28982;&#21518;&#65292;&#23427;&#25226;&#20301;&#32622; <span class="stt">loc1</span> &#30340;&#20869;&#23481;&#35774;&#20026;
22&#12290;&#26368;&#21518;&#65292;&#23427;&#21462;&#20986; <span class="stt">loc1</span> &#30340;&#20540;&#65292;&#25226;&#32467;&#26524;&#65288;&#24212;&#20026; 22&#65289;&#32465;&#23450;&#21040; <span class="stt">val</span>&#65292;&#27714;&#20986;&#24182;&#36820;&#22238;
<span class="stt">-(val,1)</span> &#30340;&#32467;&#26524; 21&#12290;</p><p>&#35201;&#24471;&#21040;&#36825;&#31181;&#34892;&#20026;&#65292;&#25105;&#20204;&#32473; CPS-OUT &#30340;&#35299;&#37322;&#22120;&#28155;&#21152;&#36825;&#20960;&#34892;&#20195;&#30721;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">cps-newrefk-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple1</span><span class="hspace">&nbsp;</span><span class="RktSym">simple2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">newval</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ref-val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-procedure/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span><span class="hspace">&nbsp;</span><span class="RktSym">val2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">newval</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">cps-derefk-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple1</span><span class="hspace">&nbsp;</span><span class="RktSym">simple2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-procedure/k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;ref</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">cps-setrefk-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simple1</span><span class="hspace">&nbsp;</span><span class="RktSym">simple2</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">ref</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;ref</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of-simple-exp</span><span class="hspace">&nbsp;</span><span class="RktSym">simple2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="hspace">&nbsp;</span><span class="RktSym">ref</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of/k</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></li><li><p>&#26368;&#21518;&#65292;&#25105;&#20204;&#32473; <span class="stt">cps-of-exp</span> &#28155;&#21152;&#36825;&#20960;&#34892;&#20195;&#30721;&#26469;&#20570;&#32763;&#35793;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">newref-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-newrefk-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">deref-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-derefk-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">setref-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-of-exps</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-setrefk-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cadr</span><span class="hspace">&nbsp;</span><span class="RktSym">simples</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-send-to-cont</span><span class="hspace">&nbsp;</span><span class="RktSym">k-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cps-const-exp</span><span class="hspace">&nbsp;</span><span class="RktVal">23</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#22312;&#26368;&#21518;&#19968;&#34892;&#65292;&#25105;&#20204;&#35753; <span class="stt">setref</span> &#36820;&#22238; 23&#65292;&#36825;&#19982; EXPLICIT-REFS &#19968;&#33268;&#12290;
<a name="(idx._(gentag._1058))"></a>
<a name="(idx._(gentag._1059))"></a>
<a name="(idx._(gentag._1060))"></a>
<a name="(idx._(gentag._1061))"></a>
<a name="(idx._(gentag._1062))"></a>
<a name="(idx._(gentag._1063))"></a></p></li></ul><blockquote class="EoplExercise"><p><a name="(elem._ex6..36)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1064))"></a>
&#32473; CPS-IN &#28155;&#21152; <span class="stt">begin</span> &#34920;&#36798;&#24335;&#65288;<span class="EoplExerciseRef"></span>&#65289;&#12290;CPS-OUT &#24212;&#35813;&#19981;&#38656;&#35201;&#20462;&#25913;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..37)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._1065))"></a>
&#32473; CPS-IN &#28155;&#21152;&#38544;&#24335;&#24341;&#29992;&#65288;<a href="state.html#%28part._s4..3%29" data-pltdoc="x">IMPLICIT-REFS&#65306;&#38544;&#24335;&#24341;&#29992;&#35821;&#35328;</a>&#65289;&#12290;&#29992;&#21644;&#26174;&#24335;&#24341;&#29992;&#30456;&#21516;&#30340; CPS-OUT&#65292;&#30830;&#20445;&#32763;&#35793;&#22120;
&#22312;&#36866;&#24403;&#30340;&#22320;&#26041;&#25554;&#20837;&#20998;&#37197;&#21644;&#35299;&#24341;&#29992;&#12290;&#25552;&#31034;&#65306;&#22238;&#24518;&#19968;&#19979;&#65292;&#22312;&#38544;&#24335;&#24341;&#29992;&#20986;&#29616;&#30340;&#22320;&#26041;&#65292;<span class="stt">var-exp</span>
&#19981;&#20877;&#26159;&#31616;&#21333;&#30340;&#65292;&#22240;&#20026;&#23427;&#38656;&#35201;&#35835;&#21462;&#23384;&#20648;&#22120;&#12290;
<a name="(idx._(gentag._1066))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..38)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22914;&#26524;&#19968;&#20010;&#21464;&#37327;&#19981;&#20250;&#20986;&#29616;&#22312; <span class="stt">set</span> &#34920;&#36798;&#24335;&#30340;&#24038;&#36793;&#65292;&#23427;&#26159;&#19981;&#21487;&#21464;&#30340;&#65292;&#22240;&#27492;&#21487;&#20197;&#35270;&#20026;&#31616;&#21333;&#30340;&#12290;
&#25193;&#23637;&#21069;&#19968;&#39064;&#30340;&#35299;&#31572;&#65292;&#25353;&#31616;&#21333;&#34920;&#36798;&#24335;&#22788;&#29702;&#25152;&#26377;&#36825;&#26679;&#30340;&#21464;&#37327;&#12290;<br/></p></blockquote><p><a name="(idx._(gentag._1067))"></a>
<a name="(idx._(gentag._1068))"></a>
<a name="(idx._(gentag._1069))"></a>
<a name="(idx._(gentag._1070))"></a>
&#26368;&#21518;&#26159;&#38750;&#23616;&#37096;&#25511;&#21046;&#27969;&#12290;&#25105;&#20204;&#26469;&#32771;&#34385;<span class="EoplExerciseRef"></span> &#20013;&#30340; <span class="stt">letcc</span>&#12290;<span class="stt">letcc</span>
&#34920;&#36798;&#24335; <span class="stt">letcc </span><span class="texMathInline">var</span><span class="stt"> in </span><span class="texMathInline">body</span> &#23558;&#24403;&#21069;&#32493;&#25991;&#32465;&#23450;&#21040;&#21464;&#37327; <span class="texMathInline">var</span>&#12290;<span class="texMathInline">body</span> &#20026;
&#35813;&#32465;&#23450;&#30340;&#20316;&#29992;&#22495;&#12290;&#32493;&#25991;&#30340;&#21807;&#19968;&#25805;&#20316;&#26159; <span class="stt">throw</span>&#12290;&#25105;&#20204;&#29992;&#35821;&#27861; <span class="stt">throw </span><span class="texMathInline">Expression</span><span class="stt">
</span><span class="stt">to </span><span class="texMathInline">Expression</span>&#65292;&#23427;&#38656;&#35201;&#27714;&#20986;&#20004;&#20010;&#23376;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;&#31532;&#20108;&#20010;&#34920;&#36798;&#24335;&#24212;&#36820;&#22238;&#19968;&#20010;&#32493;&#25991;&#65292;&#35813;&#32493;
&#25991;&#20316;&#29992;&#20110;&#31532;&#19968;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;<span class="stt">throw</span> &#24403;&#21069;&#30340;&#32493;&#25991;&#21017;&#34987;&#24573;&#30053;&#12290;</p><p>&#25105;&#20204;&#39318;&#20808;&#25353;&#29031;&#26412;&#31456;&#30340;&#26041;&#24335;&#20998;&#26512;&#36825;&#20123;&#34920;&#36798;&#24335;&#12290;&#36825;&#20123;&#34920;&#36798;&#24335;&#19968;&#23450;&#26159;&#22797;&#26434;&#30340;&#12290;<span class="stt">letcc</span> &#30340;&#20027;&#20307;
&#37096;&#20998;&#22312;&#23614;&#31471;&#65292;&#22240;&#20026;&#23427;&#30340;&#20540;&#23601;&#26159;&#25972;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;&#30001;&#20110; <span class="stt">throw</span> &#20013;&#30340;&#20004;&#20010;&#20301;&#32622;&#37117;&#38656;&#27714;&#20540;&#65292;
&#19988;&#37117;&#19981;&#26159; <span class="stt">throw</span> &#30340;&#20540;&#65288;&#30830;&#23454;&#65292;<span class="stt">throw</span> &#27809;&#26377;&#20540;&#65292;&#22240;&#20026;&#23427;&#19981;&#20250;&#36820;&#22238;&#21040;&#32039;&#37051;&#30340;&#32493;&#25991;&#65289;&#65292;
&#22240;&#27492;&#23427;&#20204;&#37117;&#22312;&#25805;&#20316;&#25968;&#20301;&#32622;&#12290;</p><p>&#29616;&#22312;&#65292;&#25105;&#20204;&#21487;&#20197;&#20889;&#20986;&#36716;&#25442;&#36825;&#20004;&#20010;&#34920;&#36798;&#24335;&#30340;&#35268;&#21017;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;letcc </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">in </span><span class="texMathInline">body</span><span class="stt">&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= let </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">= </span><span class="texMathInline">K</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">in (cps-of-exp </span><span class="texMathInline">body</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">var</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">(cps-of-exp &lt;&lt;throw </span><span class="texMathInline">simp_1</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">to </span><span class="texMathInline">simp_2</span><span class="stt">&gt;&gt; </span><span class="texMathInline">K</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (</span><span class="texMathInline">simp_2</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">simp_1</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#25105;&#20204;&#20173;&#29992; <span class="stt">cps-of-exps</span> &#22788;&#29702; <span class="stt">throw</span> &#21487;&#33021;&#21547;&#26377;&#30340;&#22797;&#26434;&#21442;&#25968;&#12290;&#36825;&#37324;&#65292;<span class="texMathInline">K</span> &#22914;&#26399;&#26395;
&#30340;&#37027;&#26679;&#24573;&#30053;&#12290;</p></blockquote><p>&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#19981;&#38656;&#35201;&#32473;&#32473; CPS-OUT &#28155;&#21152;&#35821;&#27861;&#65292;&#22240;&#20026;&#25105;&#20204;&#25805;&#20316;&#30340;&#27491;&#26159;&#25511;&#21046;&#32467;&#26500;&#12290;
<a name="(idx._(gentag._1071))"></a>
<a name="(idx._(gentag._1072))"></a>
<a name="(idx._(gentag._1073))"></a>
<a name="(idx._(gentag._1074))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex6..39)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22312; CPS &#32763;&#35793;&#22120;&#20013;&#23454;&#29616; <span class="stt">letcc</span> &#21644; <span class="stt">throw</span>&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex6..40)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22312; CPS &#32763;&#35793;&#22120;&#20013;&#28155;&#21152;&#21644;&#23454;&#29616;<a href="cpi.html#%28part._s5..4%29" data-pltdoc="x">&#24322;&#24120;</a>&#20013;&#30340; <span class="stt">try/catch</span> &#21644; <span class="stt">throw</span>&#12290;CPS-OUT
&#24212;&#35813;&#19981;&#38656;&#35201;&#28155;&#21152;&#20219;&#20309;&#19996;&#35199;&#65292;&#32780; <span class="stt">cps-of-exp</span> &#25913;&#21462;&#20004;&#20010;&#32493;&#25991;&#65306;&#19968;&#20010;&#25104;&#21151;&#32493;&#25991;&#65292;&#19968;&#20010;&#38169;&#35823;
&#32493;&#25991;&#12290;
<a name="(idx._(gentag._1075))"></a></p></blockquote><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="cpi.html" title="backward to &quot;5 传递续文的解释器&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;编程语言要素&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="types.html" title="forward to &quot;7 类型&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>