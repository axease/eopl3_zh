<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>4&nbsp;状态</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript">
(function() {
  document.write('<link rel="stylesheet" href="katex/katex.min.css" />');
})();(function() {document.write('<scr' + 'ipt type="text/javascript" src="katex/katex.min.js"></scr' + 'ipt>');})();(function(f) {
  // A "simple" onLoad function
  if (window.document.readyState == "complete") {
    f();
  } else if (window.document.addEventListener) {
    window.document.addEventListener("DOMContentLoaded", f, false);
  } else if (window.attachEvent) {
    window.attachEvent("onreadystatechange", function() {
      if (window.document.readyState == "complete") {
        f();
      }
    });
  } else {
    var oldLoad = window.onload;
    if (typeof(oldLoad) == "function") {
      window.onload = function() {
        try {
          oldLoad();
        } finally {
          f();
        }
      };
    } else {
      window.onload = f;
    }
  }
})(function() {
  // This is an ugly way to change the doctype, in case the scribble document
  // did not use (with-html5).
  if (!(document.doctype && document.doctype.publicId == '')) {
    if (console && console.log) {
      console.log("Re-wrote the document to use the HTML5 doctype.\n"
                  + "  Consider using the following declaration:\n"
                  + "      @title[#:style (with-html5 manual-doc-style)]{…}");
    }
    var wholeDoc = '<!doctype HTML>\n' + document.documentElement.outerHTML;
    document.open();
    document.clear();
    document.write(wholeDoc);
  }
  var inlineElements = document.getElementsByClassName("texMathInline");
  for (var i = 0; i < inlineElements.length; i++) {
    var e = inlineElements[i];
    katex.render(e.textContent, e, { displayMode:false, throwOnError:false });
  }
  var displayElements = document.getElementsByClassName("texMathDisplay");
  for (var i = 0; i < displayElements.length; i++) {
    var e = displayElements[i];
    katex.render(e.textContent, e, { displayMode:true, throwOnError:false });
  }
});
</script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">&#32534;&#31243;&#35821;&#35328;&#35201;&#32032;</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="fw-trans.html" class="tocviewlink" data-pltdoc="x">&#35793;&#32773;&#30340;&#35805;</a></td></tr><tr><td align="right"></td><td><a href="glo.html" class="tocviewlink" data-pltdoc="x">&#35793;&#21517;&#34920;</a></td></tr><tr><td align="right"></td><td><a href="fw.html" class="tocviewlink" data-pltdoc="x">&#24207;</a></td></tr><tr><td align="right"></td><td><a href="pf.html" class="tocviewlink" data-pltdoc="x">&#21069;&#35328;</a></td></tr><tr><td align="right"></td><td><a href="awk.html" class="tocviewlink" data-pltdoc="x">&#33268;&#35874;</a></td></tr><tr><td align="right">1&nbsp;</td><td><a href="isd.html" class="tocviewlink" data-pltdoc="x">&#24402;&#32435;&#24335;&#25968;&#25454;&#38598;</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="da.html" class="tocviewlink" data-pltdoc="x">&#25968;&#25454;&#25277;&#35937;</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="expr.html" class="tocviewlink" data-pltdoc="x">&#34920;&#36798;&#24335;</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">&#29366;&#24577;</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="cpi.html" class="tocviewlink" data-pltdoc="x">&#20256;&#36882;&#32493;&#25991;&#30340;&#35299;&#37322;&#22120;</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="cps.html" class="tocviewlink" data-pltdoc="x">&#32493;&#25991;&#20256;&#36882;&#39118;&#26684;</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="types.html" class="tocviewlink" data-pltdoc="x">&#31867;&#22411;</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="modules.html" class="tocviewlink" data-pltdoc="x">&#27169;&#22359;</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="oac.html" class="tocviewlink" data-pltdoc="x">&#23545;&#35937;&#21644;&#31867;</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="further-reading.html" class="tocviewlink" data-pltdoc="x">&#25193;&#23637;&#38405;&#35835;</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="sllgen-parsing-system.html" class="tocviewlink" data-pltdoc="x">SLLGEN&#35299;&#26512;&#31995;&#32479;</a></td></tr><tr><td align="right"></td><td><a href="bib.html" class="tocviewlink" data-pltdoc="x">&#21442;&#32771;&#20070;&#30446;</a></td></tr><tr><td align="right"></td><td><a href="indices.html" class="tocviewlink" data-pltdoc="x">&#32034;&#24341;</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">&#29366;&#24577;</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">4.1&nbsp;</td><td><a href="#%28part._s4..1%29" class="tocviewlink" data-pltdoc="x">&#35745;&#31639;&#30340;&#25928;&#26524;</a></td></tr><tr><td align="right">4.2&nbsp;</td><td><a href="#%28part._s4..2%29" class="tocviewlink" data-pltdoc="x">EXPLICIT-<wbr></wbr>REFS&#65306;&#26174;&#24335;&#24341;&#29992;&#35821;&#35328;</a></td></tr><tr><td align="right">4.3&nbsp;</td><td><a href="#%28part._s4..3%29" class="tocviewlink" data-pltdoc="x">IMPLICIT-<wbr></wbr>REFS&#65306;&#38544;&#24335;&#24341;&#29992;&#35821;&#35328;</a></td></tr><tr><td align="right">4.4&nbsp;</td><td><a href="#%28part._s4..4%29" class="tocviewlink" data-pltdoc="x">MUTABLE-<wbr></wbr>PAIRS&#65306;&#21487;&#21464;&#24207;&#23545;&#35821;&#35328;</a></td></tr><tr><td align="right">4.5&nbsp;</td><td><a href="#%28part._s4..5%29" class="tocviewlink" data-pltdoc="x">&#20256;&#21442;&#21464;&#20307;</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._s4..1%29" class="tocsubseclink" data-pltdoc="x">&#35745;&#31639;&#30340;&#25928;&#26524;</a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._s4..2%29" class="tocsubseclink" data-pltdoc="x">EXPLICIT-<wbr></wbr>REFS&#65306;&#26174;&#24335;&#24341;&#29992;&#35821;&#35328;</a></td></tr><tr><td><span class="tocsublinknumber">4.2.1<tt>&nbsp;</tt></span><a href="#%28part._s4..2..1%29" class="tocsubseclink" data-pltdoc="x">&#23384;&#20648;&#22120;&#20256;&#36882;&#35268;&#33539;</a></td></tr><tr><td><span class="tocsublinknumber">4.2.2<tt>&nbsp;</tt></span><a href="#%28part._s4..2..2%29" class="tocsubseclink" data-pltdoc="x">&#23450;&#20041;&#26174;&#24335;&#24341;&#29992;&#25805;&#20316;</a></td></tr><tr><td><span class="tocsublinknumber">4.2.3<tt>&nbsp;</tt></span><a href="#%28part._s4..2..3%29" class="tocsubseclink" data-pltdoc="x">&#23454;&#29616;</a></td></tr><tr><td><span class="tocsublinknumber">4.3<tt>&nbsp;</tt></span><a href="#%28part._s4..3%29" class="tocsubseclink" data-pltdoc="x">IMPLICIT-<wbr></wbr>REFS&#65306;&#38544;&#24335;&#24341;&#29992;&#35821;&#35328;</a></td></tr><tr><td><span class="tocsublinknumber">4.3.1<tt>&nbsp;</tt></span><a href="#%28part._s4..3..1%29" class="tocsubseclink" data-pltdoc="x">&#35268;&#33539;</a></td></tr><tr><td><span class="tocsublinknumber">4.3.2<tt>&nbsp;</tt></span><a href="#%28part._s4..3..2%29" class="tocsubseclink" data-pltdoc="x">&#23454;&#29616;</a></td></tr><tr><td><span class="tocsublinknumber">4.4<tt>&nbsp;</tt></span><a href="#%28part._s4..4%29" class="tocsubseclink" data-pltdoc="x">MUTABLE-<wbr></wbr>PAIRS&#65306;&#21487;&#21464;&#24207;&#23545;&#35821;&#35328;</a></td></tr><tr><td><span class="tocsublinknumber">4.4.1<tt>&nbsp;</tt></span><a href="#%28part._s4..4..1%29" class="tocsubseclink" data-pltdoc="x">&#23454;&#29616;</a></td></tr><tr><td><span class="tocsublinknumber">4.4.2<tt>&nbsp;</tt></span><a href="#%28part._s4..4..2%29" class="tocsubseclink" data-pltdoc="x">&#21487;&#21464;&#24207;&#23545;&#30340;&#21478;&#19968;&#31181;&#34920;&#31034;</a></td></tr><tr><td><span class="tocsublinknumber">4.5<tt>&nbsp;</tt></span><a href="#%28part._s4..5%29" class="tocsubseclink" data-pltdoc="x">&#20256;&#21442;&#21464;&#20307;</a></td></tr><tr><td><span class="tocsublinknumber">4.5.1<tt>&nbsp;</tt></span><a href="#%28part._s4..5..1%29" class="tocsubseclink" data-pltdoc="x">&#25353;&#25351;&#35843;&#29992;</a></td></tr><tr><td><span class="tocsublinknumber">4.5.2<tt>&nbsp;</tt></span><a href="#%28part._s4..5..2%29" class="tocsubseclink" data-pltdoc="x">&#25042;&#27714;&#20540;&#65306;&#25353;&#21517;&#35843;&#29992;&#21644;&#25353;&#38656;&#35843;&#29992;</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="expr.html" title="backward to &quot;3 表达式&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;编程语言要素&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="cpi.html" title="forward to &quot;5 传递续文的解释器&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>4<tt>&nbsp;</tt><a name="(part._state)"></a>&#29366;&#24577;</h3><h4>4.1<tt>&nbsp;</tt><a name="(part._s4..1)"></a>&#35745;&#31639;&#30340;&#25928;&#26524;</h4><p><a name="(idx._(gentag._581))"></a>
<a name="(idx._(gentag._582))"></a>
&#21040;&#30446;&#21069;&#20026;&#27490;&#65292;&#25105;&#20204;&#21482;&#32771;&#34385;&#20102;&#35745;&#31639;&#20135;&#29983;&#30340;<span class="emph">&#20540;</span> (<span class="emph">value</span>)&#65292;&#20294;&#26159;&#35745;&#31639;&#20063;
&#26377;<span class="emph">&#25928;&#26524;</span> (<span class="emph">effect</span>)&#65306;&#23427;&#21487;&#20197;&#35835;&#21462;&#65292;&#25171;&#21360;&#65292;&#20462;&#25913;&#20869;&#23384;&#25110;&#32773;&#25991;&#20214;&#31995;&#32479;&#30340;&#29366;&#24577;&#12290;&#22312;&#29616;&#23454;&#19990;
&#30028;&#20013;&#65292;&#25105;&#20204;<span class="emph">&#24635;&#26159;</span>&#23545;&#25928;&#26524;&#24456;&#24863;&#20852;&#36259;&#65306;&#22914;&#26524;&#19968;&#27425;&#35745;&#31639;&#19981;&#26174;&#31034;&#31572;&#26696;&#65292;&#37027;&#23545;&#25105;&#20204;&#23436;&#20840;&#27809;&#29992;&#65281;</p><p>&#20135;&#29983;&#20540;&#21644;&#20135;&#29983;&#25928;&#26524;&#26377;&#20309;&#21306;&#21035;&#65311;&#25928;&#26524;&#26159;<span class="emph">&#20840;&#23616;&#24615;</span> (<span class="emph">global</span>) &#30340;&#65292;&#25972;&#20010;&#35745;&#31639;&#37117;&#33021;&#30475;&#21040;&#12290;&#25928;
&#26524;<span class="emph">&#24863;&#26579;</span>&#25972;&#20010;&#35745;&#31639;&#65288;&#25925;&#24847;&#29992;&#21452;&#20851;&#35821;&#65289;&#12290;</p><p><a name="(idx._(gentag._583))"></a>
<a name="(idx._(gentag._584))"></a>
&#25105;&#20204;&#20027;&#35201;&#20851;&#24515;&#19968;&#31181;&#25928;&#26524;&#65306;&#32473;&#20869;&#23384;&#20013;&#30340;&#20301;&#32622;&#36171;&#20540;&#12290;&#36171;&#20540;&#19982;&#32465;&#23450;&#26377;&#20309;&#21306;&#21035;&#65311;&#25105;&#20204;&#24050;&#32463;&#30693;&#36947;&#65292;&#32465;&#23450;
&#26159;&#23616;&#37096;&#30340;&#65292;&#20294;<a name="(idx._(gentag._585))"></a>&#21464;&#37327;&#36171;&#20540;&#26377;&#21487;&#33021;&#26159;&#20840;&#23616;&#30340;&#12290;&#37027;&#26159;&#22312;&#26412;&#19981;&#30456;&#20851;&#30340;&#20960;
&#37096;&#20998;&#35745;&#31639;&#20043;&#38388;<span class="emph">&#20849;&#20139;</span> (<span class="emph">share</span>) <a name="(idx._(gentag._586))"></a>
&#20540;&#12290;&#22914;&#26524;&#20004;&#20010;&#36807;&#31243;&#30693;&#36947;&#20869;&#23384;&#20013;&#30340;&#21516;&#19968;&#20301;&#32622;&#65292;&#23427;&#20204;&#23601;&#33021;&#20849;&#20139;&#20449;&#24687;&#12290;&#22914;&#26524;&#25226;&#20449;&#24687;&#30041;&#22312;&#24050;&#30693;&#20301;&#32622;&#65292;
&#21516;&#19968;&#20010;&#36807;&#31243;&#23601;&#33021;&#22312;&#24403;&#21069;&#35843;&#29992;&#21644;&#21518;&#32493;&#35843;&#29992;&#20043;&#38388;&#20849;&#20139;&#20449;&#24687;&#12290;</p><p><a name="(idx._(gentag._587))"></a>
<a name="(idx._(gentag._588))"></a>
&#25105;&#20204;&#25226;&#20869;&#23384;&#24314;&#27169;&#20026;&#20174;<span class="emph">&#20301;&#32622;</span> (<span class="emph">location</span>) &#21040;&#20540;&#38598;&#21512;&#30340;&#30340;&#26377;&#38480;&#26144;&#23556;&#65292;&#31216;&#20540;&#38598;&#21512;
&#20026;<span class="emph">&#21487;&#23384;&#20648;&#20540;</span> (<span class="emph">storable values</span>)&#12290;&#20986;&#20110;&#21382;&#21490;&#21407;&#22240;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026;<span class="emph">&#23384;
&#20648;&#22120;</span> (<span class="emph">store</span>)&#12290;&#36890;&#24120;&#65292;&#19968;&#31181;&#35821;&#35328;&#20013;&#30340;&#21487;&#23384;&#20648;&#20540;&#19982;&#34920;&#36798;&#20540;&#30456;&#21516;&#65292;&#20294;&#19981;&#24635;&#26159;&#36825;&#26679;&#12290;&#36825;&#20010;&#36873;&#25321;&#26159;&#35821;&#35328;&#35774;&#35745;
&#30340;&#19968;&#37096;&#20998;&#12290;<a name="(idx._(gentag._589))"></a></p><p>&#20195;&#34920;&#20869;&#23384;&#20301;&#32622;&#30340;&#25968;&#25454;&#32467;&#26500;&#21483;&#20570;<span class="emph">&#24341;&#29992;</span> (<span class="emph">reference</span>)&#12290;&#20301;&#32622;&#26159;&#20869;&#23384;&#20013;&#21487;&#29992;&#26469;&#23384;&#20540;&#30340;&#22320;&#26041;&#65292;
&#24341;&#29992;&#26159;&#25351;&#21521;&#37027;&#20010;&#22320;&#26041;&#30340;&#25968;&#25454;&#32467;&#26500;&#12290;&#20301;&#32622;&#21644;&#24341;&#29992;&#30340;&#21306;&#21035;&#21487;&#20197;&#36825;&#26679;&#31867;&#27604;&#65306;&#20301;&#32622;&#23601;&#20687;&#25991;&#20214;&#65292;&#24341;&#29992;&#23601;
&#20687;&#19968;&#20010;URL&#12290;URL&#25351;&#21521;&#19968;&#20010;&#25991;&#20214;&#65292;&#25991;&#20214;&#21253;&#21547;&#19968;&#20123;&#25968;&#25454;&#12290;&#31867;&#20284;&#22320;&#65292;&#24341;&#29992;&#25351;&#20195;&#19968;&#20010;&#20301;&#32622;&#65292;&#20301;&#32622;&#21253;&#21547;
&#19968;&#20123;&#25968;&#25454;&#12290;</p><p><a name="(idx._(gentag._590))"></a>
&#24341;&#29992;&#26377;&#26102;&#20505;&#21448;&#21483;<span class="emph">&#24038;&#20540;</span> (<span class="emph">L-values</span>)&#12290;&#36825;&#21517;&#23383;&#21453;&#26144;&#20102;&#36825;&#31181;&#25968;&#25454;&#32467;&#26500;&#19982;&#36171;&#20540;&#35821;&#21477;&#24038;&#36793;&#21464;
&#37327;&#30340;&#32852;&#31995;&#12290;&#31867;&#20284;&#22320;&#65292;&#34920;&#36798;&#20540;&#65292;&#27604;&#22914;&#36171;&#20540;&#35821;&#21477;&#21491;&#36793;&#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#21483;&#20570;<span class="emph">&#21491;&#20540;</span> (<span class="emph">R-values</span>)&#12290;
<a name="(idx._(gentag._591))"></a></p><p>&#25105;&#20204;&#32771;&#34385;&#20004;&#31181;&#24102;&#26377;&#23384;&#20648;&#22120;&#30340;&#35821;&#35328;&#35774;&#35745;&#12290;&#36825;&#20123;&#35774;&#35745;&#21483;&#20570;<span class="emph">&#26174;&#24335;&#24341;
&#29992;</span> (<span class="emph">explicit reference</span>) &#21644;<span class="emph">&#38544;&#24335;&#24341;&#29992;</span> (<span class="emph">implicit reference</span>)&#12290;
<a name="(idx._(gentag._592))"></a></p><h4>4.2<tt>&nbsp;</tt><a name="(part._s4..2)"></a>EXPLICIT-REFS&#65306;&#26174;&#24335;&#24341;&#29992;&#35821;&#35328;</h4><p><a name="(idx._(gentag._593))"></a>
<a name="(idx._(gentag._594))"></a>
&#22312;&#36825;&#31181;&#35774;&#35745;&#20013;&#65292;&#25105;&#20204;&#28155;&#21152;&#24341;&#29992;&#65292;&#20316;&#20026;&#21478;&#19968;&#31181;&#34920;&#36798;&#20540;&#12290;&#37027;&#20040;&#65292;&#25105;&#20204;&#26377;&#65306;</p><blockquote class="SubFlow"><p><span class="Iidentity">\begin{align*}\mathit{ExpVal} &amp;= \mathit{Int} + \mathit{Bool} + \mathit{Proc} + \mathit{Ref(ExpVal)} \\
\mathit{DenVal} &amp;= \mathit{ExpVal}\end{align*}</span></p><p>&#36825;&#37324;&#65292;<span class="texMathInline">\mathit{Ref(ExpVal)}</span>&#34920;&#31034;&#21253;&#21547;&#34920;&#36798;&#20540;&#30340;&#20301;&#32622;&#24341;&#29992;&#38598;&#21512;&#12290;</p></blockquote><p>&#25105;&#20204;&#27839;&#29992;&#35821;&#35328;&#20013;&#30340;&#32465;&#23450;&#25968;&#25454;&#32467;&#26500;&#65292;&#20294;&#26159;&#28155;&#21152;&#19977;&#20010;&#26032;&#25805;&#20316;&#65292;&#29992;&#26469;&#21019;&#24314;&#21644;&#20351;&#29992;&#24341;&#29992;&#12290;</p><ul><li><p><span class="stt">newref</span>&#65292;&#20998;&#37197;&#26032;&#30340;&#20301;&#32622;&#65292;&#36820;&#22238;&#20854;&#24341;&#29992;&#12290;
<a name="(idx._(gentag._595))"></a></p></li><li><p><span class="stt">deref</span>&#65292;<span class="emph">&#35299;&#24341;&#29992;</span> (<span class="emph">deference</span>) &#65306;&#36820;&#22238;&#24341;&#29992;&#25351;&#21521;&#20301;&#32622;&#22788;&#30340;&#20869;&#23481;&#12290;
<a name="(idx._(gentag._596))"></a></p></li><li><p><span class="stt">setref</span>&#65292;&#25913;&#21464;&#24341;&#29992;&#25351;&#21521;&#20301;&#32622;&#22788;&#30340;&#20869;&#23481;&#12290;
<a name="(idx._(gentag._597))"></a></p></li></ul><p>&#25105;&#20204;&#25226;&#24471;&#21040;&#30340;&#35821;&#35328;&#31216;&#20316; EXPLICIT-REFS&#12290;&#35753;&#25105;&#20204;&#29992;&#36825;&#20123;&#32467;&#26500;&#20889;&#20960;&#20010;&#31243;&#24207;&#12290;</p><p>&#19979;&#38754;&#26159;&#20004;&#20010;&#36807;&#31243; <span class="stt">even</span> &#21644; <span class="stt">odd</span>&#12290;&#23427;&#20204;&#21462;&#19968;&#21442;&#25968;&#65292;&#20294;&#26159;&#24573;&#30053;&#23427;&#65292;&#24182;&#26681;&#25454;&#20301;&#32622;
<span class="stt">x</span> &#22788;&#30340;&#20869;&#23481;&#26159;&#20598;&#25968;&#36824;&#26159;&#22855;&#25968;&#36820;&#22238; 1 &#25110; 0&#12290;&#23427;&#20204;&#19981;&#26159;&#36890;&#36807;&#30452;&#25509;&#20256;&#36882;&#25968;&#25454;&#26469;&#36890;&#20449;&#65292;&#32780;&#26159;&#25913;
&#21464;&#20849;&#20139;&#21464;&#37327;&#30340;&#20869;&#23481;&#12290;<a name="(idx._(gentag._598))"></a><a name="(idx._(gentag._599))"></a></p><p>&#36825;&#20010;&#31243;&#24207;&#21028;&#26029; 13 &#26159;&#21542;&#20026;&#22855;&#25968;&#65292;&#24182;&#36820;&#22238; 1&#12290;&#36807;&#31243; <span class="stt">even</span> &#21644; <span class="stt">odd</span> &#19981;&#24341;&#29992;&#23427;&#20204;&#30340;&#23454;
&#21442;&#65292;&#32780;&#26159;&#26597;&#30475;&#32465;&#23450;&#21040; <span class="stt">x</span> &#30340;&#20301;&#32622;&#20013;&#30340;&#20869;&#23481;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let x = newref (0)</span></p></td></tr><tr><td><p><span class="stt">in letrec even(dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= if zero? (deref(x))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">setref(x, -(deref(x), 1));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(odd 888)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">odd(dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= if zero? (deref(x))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">setref(x, -(deref(x), 1));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(even 888)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin setref(x,13); (odd 888) end</span></p></td></tr></table></blockquote><p>&#36825;&#20010;&#31243;&#24207;&#20351;&#29992;&#22810;&#22768;&#26126;&#30340; <span class="stt">letrec</span>&#65288;<span class="EoplExerciseRef"></span>&#65289;&#21644; <span class="stt">begin</span> &#34920;&#36798;&#24335;
&#65288;<span class="EoplExerciseRef"></span>&#65289;&#12290;<span class="stt">begin</span> &#34920;&#36798;&#24335;&#25353;&#39034;&#24207;&#27714;&#27599;&#20010;&#23376;&#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#24182;&#36820;
&#22238;&#26368;&#21518;&#19968;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;
<a name="(idx._(gentag._600))"></a></p></blockquote><p>&#20026;&#20102;&#21516;&#25105;&#20204;&#30340;&#21333;&#21442;&#25968;&#35821;&#35328;&#20445;&#25345;&#19968;&#33268;&#65292;&#25105;&#20204;&#32473; <span class="stt">even</span> &#21644; <span class="stt">odd</span> &#20256;&#19968;&#20010;&#26080;&#29992;&#21442;&#25968;&#65307;&#22914;
&#26524;&#25105;&#20204;&#30340;&#36807;&#31243;&#25903;&#25345;&#20219;&#24847;&#25968;&#37327;&#30340;&#21442;&#25968;&#65288;<span class="EoplExerciseRef"></span>&#65289;&#65292;&#36825;&#20123;&#36807;&#31243;&#30340;&#21442;&#25968;&#23601;&#21487;&#20197;&#21435;
&#25481;&#12290;</p><p>&#24403;&#20004;&#20010;&#36807;&#31243;&#38656;&#35201;&#20998;&#20139;&#24456;&#22810;&#37327;&#26102;&#65292;&#36825;&#31181;&#36890;&#20449;&#26041;&#24335;&#24456;&#26041;&#20415;&#65307;&#21482;&#38656;&#32473;&#26576;&#20123;&#38543;&#35843;&#29992;&#32780;&#25913;&#21464;&#30340;&#37327;&#36171;&#20540;&#12290;
&#21516;&#26679;&#22320;&#65292;&#19968;&#20010;&#36807;&#31243;&#21487;&#33021;&#36890;&#36807;&#19968;&#38271;&#20018;&#35843;&#29992;&#38388;&#25509;&#35843;&#29992;&#21478;&#19968;&#36807;&#31243;&#12290;&#20108;&#32773;&#21487;&#20197;&#36890;&#36807;&#19968;&#20010;&#20849;&#20139;&#21464;&#37327;&#30452;&#25509;
&#20132;&#25442;&#25968;&#25454;&#65292;&#23621;&#38388;&#30340;&#36807;&#31243;&#19981;&#38656;&#35201;&#30693;&#36947;&#23427;&#12290;&#22240;&#27492;&#65292;&#20197;&#20849;&#20139;&#21464;&#37327;&#36890;&#20449;&#21487;&#20316;&#20026;&#19968;&#31181;&#38544;&#34255;&#20449;&#24687;&#30340;&#26041;&#24335;&#12290;</p><p><a name="(idx._(gentag._601))"></a>
<a name="(idx._(gentag._602))"></a>
&#36171;&#20540;&#30340;&#21478;&#19968;&#29992;&#36884;&#26159;&#36890;&#36807;&#31169;&#26377;&#21464;&#37327;&#21019;&#24314;&#38544;&#34255;&#29366;&#24577;&#12290;&#20363;&#22914;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><a name="(elem._g-counter)"></a><span class="stt">let g = let counter = newref(0)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in proc (dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">setref(counter, -(deref(counter), -1));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">deref(counter)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt">in let a = (g 11)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let b = (g 11)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in -(a,b)</span></p></td></tr></table></blockquote><p>&#36825;&#37324;&#65292;&#36807;&#31243; <span class="stt">g</span> &#20445;&#30041;&#20102;&#19968;&#20010;&#31169;&#26377;&#21464;&#37327;&#65292;&#29992;&#26469;&#23384;&#20648; <span class="stt">g</span> &#34987;&#35843;&#29992;&#30340;&#27425;&#25968;&#12290;&#22240;&#27492;&#65292;&#31532;&#19968;&#27425;
&#35843;&#29992; <span class="stt">g</span> &#36820;&#22238; 1&#65292;&#31532;&#20108;&#27425;&#36820;&#22238; 2&#65292;&#25972;&#20010;&#31243;&#24207;&#30340;&#20540;&#20026; -1&#12290;</p><p><a name="(idx._(gentag._603))"></a>
&#19979;&#22270;&#26159; <span class="stt">g</span> &#32465;&#23450;&#26102;&#25152;&#22312;&#30340;&#29615;&#22659;&#12290;&#21487;&#20197;&#35748;&#20026;&#65292;&#36825;&#26159;&#22312; <span class="stt">g</span> &#30340;&#19981;&#21516;&#35843;&#29992;&#20043;&#38388;&#20849;&#20139;&#20449;&#24687;&#12290;
Scheme &#36807;&#31243; <span class="stt">gensym</span> &#29992;&#36825;&#31181;&#25216;&#26415;&#21019;&#24314;&#21807;&#19968;&#31526;&#21495;&#12290;</p><blockquote class="EoplFigure*"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCentered"><p><img src="g-bound.svg" alt="g绑定时的环境" width="418.95pt" height="415.53pt"/></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._604))"></a>
<a name="(idx._(gentag._605))"></a></div></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..1)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#36825;&#20010;&#31243;&#24207;&#22914;&#26524;&#20889;&#25104;&#19979;&#38754;&#36825;&#26679;&#20250;&#24590;&#26679;&#65311;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let g = proc (dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let counter = newref(0)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">setref(counter, -(deref(counter), -1));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">deref(counter)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt">in let a = (g 11)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let b = (g 11)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in -(a,b)</span></p></td></tr></table></blockquote></blockquote><p>&#22312;EXPLICIT-REFS&#20013;&#65292;&#25105;&#20204;&#21487;&#20197;&#23384;&#20648;&#20219;&#20309;&#34920;&#36798;&#20540;&#12290;&#24341;&#29992;&#20063;&#26159;&#34920;&#36798;&#20540;&#12290;&#36825;&#24847;&#21619;&#30528;&#25105;&#20204;&#21487;&#20197;&#22312;&#19968;
&#20010;&#20301;&#32622;&#23384;&#20648;&#24341;&#29992;&#12290;&#32771;&#34385;&#19979;&#38754;&#30340;&#31243;&#24207;&#65306;<a name="(idx._(gentag._606))"></a></p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let x = newref(newref(0))</span></p></td></tr><tr><td><p><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">setref(deref(x), 11);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">deref(deref(x))</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><p>&#36825;&#27573;&#31243;&#24207;&#20998;&#37197;&#20102;&#19968;&#20010;&#26032;&#20301;&#32622;&#65292;&#20869;&#23481;&#20026; 0&#12290;&#28982;&#21518;&#65292;&#23427;&#23558; <span class="stt">x</span> &#32465;&#23450;&#21040;&#19968;&#20010;&#20301;&#32622;&#65292;&#20854;&#20869;&#23481;&#20026;&#25351;
&#21521;&#31532;&#19968;&#20010;&#20301;&#32622;&#30340;&#24341;&#29992;&#12290;&#22240;&#27492;&#65292;<span class="stt">deref(x)</span> &#30340;&#20540;&#26159;&#31532;&#19968;&#20010;&#20301;&#32622;&#30340;&#24341;&#29992;&#12290;&#37027;&#20040;&#31243;&#24207;&#27714;
<span class="stt">setref</span> &#30340;&#20540;&#26102;&#65292;&#20250;&#20462;&#25913;&#31532;&#19968;&#20010;&#20301;&#32622;&#65292;&#25972;&#20010;&#31243;&#24207;&#36820;&#22238; 11&#12290;</p><h5>4.2.1<tt>&nbsp;</tt><a name="(part._s4..2..1)"></a>&#23384;&#20648;&#22120;&#20256;&#36882;&#35268;&#33539;</h5><p><a name="(idx._(gentag._607))"></a>
&#22312;&#25105;&#20204;&#30340;&#35821;&#35328;&#20013;&#65292;&#20219;&#20309;&#34920;&#36798;&#24335;&#37117;&#21487;&#20197;&#26377;&#25928;&#26524;&#12290;&#35201;&#23450;&#20041;&#36825;&#20123;&#25928;&#26524;&#65292;&#25105;&#20204;&#38656;&#35201;&#25551;&#36848;&#27599;&#27425;&#27714;&#20540;&#20351;&#29992;
&#20160;&#20040;&#26679;&#30340;&#23384;&#20648;&#22120;&#65292;&#20197;&#21450;&#27714;&#20540;&#22914;&#20309;&#20462;&#25913;&#23384;&#20648;&#22120;&#12290;</p><p>&#22312;&#35268;&#33539;&#20013;&#65292;&#25105;&#20204;&#29992; <span class="texMathInline">\sigma</span> &#34920;&#31034;&#20219;&#19968;&#23384;&#20648;&#22120;&#65292;&#29992; <span class="texMathInline">\text{[}l=v\text{]}\sigma</span> &#34920;
&#31034;&#21478;&#19968;&#23384;&#20648;&#22120;&#65292;&#38500;&#20102;&#23558;&#20301;&#32622; <span class="texMathInline">l</span> &#26144;&#23556;&#21040; <span class="texMathInline">v</span>&#22806;&#65292;&#23427;&#19982; <span class="texMathInline">\sigma</span> &#30456;&#21516;&#12290;&#26377;&#26102;&#65292;&#28041;&#21450;
<span class="texMathInline">\sigma</span> &#30340;&#26576;&#20010;&#20855;&#20307;&#20540;&#26102;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026;&#23384;&#20648;&#22120;&#30340;<span class="emph">&#29366;&#24577;</span> (<span class="emph">state</span>)&#12290;</p><p><div class="SIntrapara">&#25105;&#20204;&#20351;&#29992;<span class="emph">&#23384;&#20648;&#22120;&#20256;&#36882;&#35268;&#33539;</span> (<span class="emph">store-passing specifications</span>)&#12290;&#22312;&#23384;&#20648;&#22120;&#20256;&#36882;&#35268;&#33539;
&#20013;&#65292;&#23384;&#20648;&#22120;&#20316;&#20026;&#26174;&#24335;&#21442;&#25968;&#20256;&#36882;&#32473; <span class="stt">value-of</span>&#65292;&#24182;&#20316;&#20026; <span class="stt">value-of</span> &#30340;&#32467;&#26524;&#36820;&#22238;&#12290;&#37027;
&#20040;&#25105;&#20204;&#21487;&#20197;&#20889;&#65306;<a name="(idx._(gentag._608))"></a>
<span class="texMathDisplay"><span class="stt">(value-of </span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">val_1</span><span class="stt">,</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span></span>
</div><div class="SIntrapara"><blockquote class="SubFlow"><p>&#23427;&#26029;&#35328;&#22312;&#29615;&#22659;&#20026; <span class="texMathInline">\rho</span>&#65292;&#23384;&#20648;&#22120;&#29366;&#24577;&#20026; <span class="texMathInline">\sigma_0</span> &#26102;&#65292;&#34920;&#36798;&#24335; <span class="texMathInline">exp_1</span> &#30340;&#36820;&#22238;&#20540;
&#20026; <span class="texMathInline">val_1</span>&#65292;&#24182;&#19988;&#21487;&#33021;&#25226;&#23384;&#20648;&#22120;&#20462;&#25913;&#20026;&#21478;&#19968;&#29366;&#24577; <span class="texMathInline">\sigma_1</span>&#12290;</p></blockquote></div></p><p><div class="SIntrapara">&#36825;&#26679;&#25105;&#20204;&#23601;&#33021;&#20889;&#20986; <span class="stt">const-exp</span> &#20043;&#31867;&#30340;&#26080;&#25928;&#26524;&#25805;&#20316;&#65306;
<span class="texMathDisplay"><span class="stt">(value-of (const-exp </span><span class="texMathInline">n</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">n</span><span class="stt">,</span><span class="texMathInline">\sigma</span><span class="stt">)</span></span>
</div><div class="SIntrapara"><blockquote class="SubFlow"><p>&#20197;&#27492;&#34920;&#26126;&#27714;&#34920;&#36798;&#24335;&#30340;&#20540;&#19981;&#20250;&#20462;&#25913;&#23384;&#20648;&#22120;&#12290;</p></blockquote></div></p><p><div class="SIntrapara"><span class="stt">diff-exp</span> &#30340;&#35268;&#33539;&#23637;&#31034;&#20102;&#22914;&#20309;&#23450;&#20041;&#26377;&#39034;&#24207;&#30340;&#34892;&#20026;&#12290;
<span class="texMathDisplay">\infer{<span class="stt">(value-of (diff-exp </span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">exp_2</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> =
       <span class="stt">(</span><span class="texMathInline">\lceil\lfloor val_1 \rfloor - \lfloor val_2 \rfloor\rceil</span><span class="stt">,</span><span class="texMathInline">\sigma_2</span><span class="stt">)</span>}
      {\begin{alignedat}{-1}
         <span class="stt">(value-of (diff-exp </span><span class="texMathInline">exp_1</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> &amp;= <span class="stt">(</span><span class="texMathInline">val_1</span><span class="stt">,</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span> \\
         <span class="stt">(value-of (diff-exp </span><span class="texMathInline">exp_2</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_1</span><span class="stt">)</span> &amp;= <span class="stt">(</span><span class="texMathInline">val_2</span><span class="stt">,</span><span class="texMathInline">\sigma_2</span><span class="stt">)</span>
       \end{alignedat}}</span>
</div><div class="SIntrapara"><blockquote class="SubFlow"><p>&#36825;&#37324;&#65292;&#25105;&#20204;&#20174;&#29366;&#24577;&#20026; <span class="texMathInline">\sigma_0</span> &#30340;&#23384;&#20648;&#22120;&#24320;&#22987;&#65292;&#39318;&#20808;&#27714; <span class="texMathInline">exp_1</span> &#30340;&#20540;&#12290;<span class="texMathInline">exp_1</span>
&#36820;&#22238;&#20540;&#20026; <span class="texMathInline">val_1</span>&#65292;&#20294;&#23427;&#21487;&#33021;&#26377;&#25928;&#26524;&#65292;&#25226;&#23384;&#20648;&#22120;&#29366;&#24577;&#20462;&#25913;&#20026; <span class="texMathInline">\sigma_1</span>&#12290;&#28982;&#21518;&#25105;&#20204;&#20174;
<span class="texMathInline">exp_1</span> &#20462;&#25913;&#36807;&#30340;&#23384;&#20648;&#22120;&#8212;&#8212;&#20063;&#23601;&#26159; <span class="texMathInline">\sigma_1</span>&#8212;&#8212;&#24320;&#22987;&#65292;&#27714; <span class="texMathInline">exp_2</span> &#30340;&#20540;&#12290;
<span class="texMathInline">exp_2</span> &#21516;&#26679;&#36820;&#22238;&#19968;&#20010;&#20540; <span class="texMathInline">val_2</span>&#65292;&#24182;&#25226;&#23384;&#20648;&#22120;&#29366;&#24577;&#20462;&#25913;&#20026; <span class="texMathInline">\sigma_2</span>&#12290;&#20043;&#21518;&#65292;&#25972;
&#20010;&#34920;&#36798;&#24335;&#36820;&#22238; <span class="texMathInline">val_1 - val2</span>&#65292;&#23545;&#23384;&#20648;&#22120;&#19981;&#20877;&#26377;&#20219;&#20309;&#25928;&#26524;&#65292;&#25152;&#20197;&#23384;&#20648;&#22120;&#29366;&#24577;&#30041;&#22312;
<span class="texMathInline">\sigma_2</span>&#12290;</p></blockquote></div></p><p>&#20877;&#26469;&#35797;&#35797;&#26465;&#20214;&#34920;&#36798;&#24335;&#12290;
<span class="texMathDisplay">\infer{\begin{alignedat}{-1}
         &amp;<span class="hspace">&nbsp;</span><span class="stt">(value-of (if-exp </span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">exp_2</span><span class="stt"> </span><span class="texMathInline">exp_3</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">) </span> \\
         &amp;\hphantom{xx}= \begin{cases}
                          <span class="stt">(value-of </span><span class="texMathInline">exp_2</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_1</span><span class="stt">)</span> &amp; &#33509; <span class="stt">(expval-&gt;bool </span><span class="texMathInline">val_1</span><span class="stt">)</span> = <span class="stt">#t</span> \\
                          <span class="stt">(value-of </span><span class="texMathInline">exp_3</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_1</span><span class="stt">)</span> &amp; &#33509; <span class="stt">(expval-&gt;bool </span><span class="texMathInline">val_1</span><span class="stt">)</span> = <span class="stt">#f</span> \hphantom{x}
                        \end{cases}
       \end{alignedat}}
      {<span class="stt">(value-of </span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">val_1</span><span class="stt">,</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span>}</span></p><p>&#19968;&#20010; <span class="stt">if-exp</span> &#20174;&#29366;&#24577; <span class="texMathInline">\sigma_0</span> &#24320;&#22987;&#65292;&#27714;&#26465;&#20214;&#34920;&#36798;&#24335; <span class="texMathInline">exp_1</span> &#30340;&#20540;&#65292;&#36820;&#22238;&#20540;
<span class="texMathInline">val_1</span>&#65292;&#23558;&#23384;&#20648;&#22120;&#29366;&#24577;&#20462;&#25913;&#20026; <span class="texMathInline">\sigma_1</span>&#12290;&#25972;&#20010;&#34920;&#36798;&#24335;&#30340;&#32467;&#26524;&#21487;&#33021;&#26159; <span class="texMathInline">exp_2</span> &#25110;
<span class="texMathInline">exp_3</span> &#30340;&#32467;&#26524;&#65292;&#20108;&#32773;&#37117;&#22312;&#24403;&#21069;&#29615;&#22659; <span class="texMathInline">\rho</span> &#21644; <span class="texMathInline">exp_1</span> &#30041;&#19979;&#30340;&#23384;&#20648;&#22120;&#29366;&#24577;
<span class="texMathInline">\sigma_1</span> &#20013;&#27714;&#20540;&#12290;</p><blockquote class="EoplExercise"><p><a name="(elem._ex4..2)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986; <span class="stt">zero?-exp</span> &#30340;&#35268;&#33539;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..3)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986; <span class="stt">call-exp</span> &#30340;&#35268;&#33539;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..4)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._609))"></a>
&#20889;&#20986; <span class="stt">begin</span> &#34920;&#36798;&#24335;&#30340;&#35268;&#33539;&#12290;
<span class="texMathDisplay">\mathit{Expression} ::= <span class="stt">begin </span><span class="texMathInline">\mathit{Expression}</span><span class="stt"> </span><span class="texMathInline">\{}<span class="stt">; </span><span class="texMathInline">\mathit{Expression}</span><span class="texMathInline">\</span>^{*}</span><span class="stt"> end</span></span></p><p><span class="stt">begin</span> &#34920;&#36798;&#24335;&#21253;&#21547;&#19968;&#20010;&#25110;&#22810;&#20010;&#20998;&#21495;&#20998;&#38548;&#30340;&#23376;&#34920;&#36798;&#24335;&#65292;&#25353;&#39034;&#24207;&#27714;&#36825;&#20123;&#23376;&#34920;&#36798;&#30340;&#20540;&#65292;&#24182;&#36820;
&#22238;&#26368;&#21518;&#19968;&#20010;&#30340;&#32467;&#26524;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..5)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._610))"></a>
&#20889;&#20986; <span class="stt">list</span>&#65288;<span class="EoplExerciseRef"></span>&#65289;&#30340;&#35268;&#33539;&#12290;</p></blockquote><h5>4.2.2<tt>&nbsp;</tt><a name="(part._s4..2..2)"></a>&#23450;&#20041;&#26174;&#24335;&#24341;&#29992;&#25805;&#20316;</h5><p><a name="(idx._(gentag._611))"></a>
&#22312; EXPLICIT-REFS &#20013;&#65292;&#25105;&#20204;&#24517;&#39035;&#23450;&#20041;&#19977;&#20010;&#25805;&#20316;&#65306;<span class="stt">newref</span>&#12289;<span class="stt">deref</span> &#21644;
<span class="stt">setref</span>&#12290;&#23427;&#20204;&#30340;&#35821;&#27861;&#20026;&#65306;</p><p><span class="Iidentity">\begin{align*}\mathit{Expression} &amp;::= <span class="stt">newref (</span><span class="Iidentity">\mathit{Expression}</span><span class="stt">)</span> \\[-3pt]
  &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">newref-exp (exp1)</span>} \\[5pt]
\mathit{Expression} &amp;::= <span class="stt">deref (</span><span class="Iidentity">\mathit{Expression}</span><span class="stt">)</span> \\[-3pt]
  &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">deref-exp (exp1)</span>} \\[5pt]
\mathit{Expression} &amp;::= <span class="stt">setref (</span><span class="Iidentity">\mathit{Expression}</span><span class="stt"> , </span><span class="Iidentity">\mathit{Expression}</span><span class="stt">)</span> \\[-3pt]
  &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">setref-exp (exp1 exp2)</span>}\end{align*}</span></p><p>&#36825;&#20123;&#25805;&#20316;&#30340;&#34892;&#20026;&#23450;&#20041;&#22914;&#19979;&#12290;
<span class="texMathDisplay">\infer{<span class="stt">(value-of (newref-exp </span><span class="texMathInline">exp</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">) =</span><span class="stt">
</span><span class="stt">((ref-val </span><span class="texMathInline">l</span><span class="stt">),[</span><span class="texMathInline">l</span><span class="stt">=</span><span class="texMathInline">val</span><span class="stt">]</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span>}
      {<span class="stt">(value-of </span><span class="texMathInline">exp</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">val</span><span class="stt">,</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span> \quad l \notin \text{dom}(\sigma_1)}</span></p><p>&#36825;&#26465;&#35268;&#21017;&#26159;&#35828;&#65306;<span class="stt">newref-exp</span> &#27714;&#20986;&#25805;&#20316;&#25968;&#30340;&#20540;&#65292;&#24471;&#21040;&#19968;&#20010;&#23384;&#20648;&#22120;&#65292;&#28982;&#21518;&#20998;&#37197;&#19968;&#20010;&#26032;&#20301;&#32622;
<span class="texMathInline">l</span>&#65292;&#23558;&#21442;&#25968;&#20540; <span class="texMathInline">val</span> &#25918;&#21040;&#36825;&#19968;&#20301;&#32622;&#65292;&#20197;&#27492;&#26469;&#25193;&#23637;&#37027;&#20010;&#23384;&#20648;&#22120;&#12290;&#28982;&#21518;&#23427;&#36820;&#22238;&#26032;&#20301;&#32622;
<span class="texMathInline">l</span> &#30340;&#24341;&#29992;&#12290;&#36825;&#24847;&#21619;&#30528; <span class="texMathInline">l</span> &#19981;&#22312; <span class="texMathInline">\sigma_1</span> &#30340;&#23450;&#20041;&#22495;&#20869;&#12290;
<a name="(idx._(gentag._612))"></a>
<span class="texMathDisplay">\infer{<span class="stt">(value-of (deref-exp </span><span class="texMathInline">exp</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">) =</span><span class="stt">
</span><span class="stt">(</span><span class="texMathInline">\sigma_1(l)</span><span class="stt">,</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span>}
      {<span class="stt">(value-of </span><span class="texMathInline">exp</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">val</span><span class="stt">,</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span>}</span></p><p>&#36825;&#26465;&#35268;&#21017;&#26159;&#35828;&#65306;<span class="stt">deref-exp</span> &#27714;&#20986;&#25805;&#20316;&#25968;&#30340;&#20540;&#65292;&#28982;&#21518;&#25226;&#23384;&#20648;&#22120;&#29366;&#24577;&#25913;&#20026; <span class="texMathInline">\sigma_1</span>&#12290;
&#21442;&#25968;&#30340;&#20540;&#24212;&#26159;&#20301;&#32622; <span class="texMathInline">l</span> &#30340;&#24341;&#29992;&#12290;&#28982;&#21518; <span class="stt">deref-exp</span> &#36820;&#22238; <span class="texMathInline">\sigma_1</span> &#20013; <span class="texMathInline">l</span> &#22788;
&#30340;&#20869;&#23481;&#65292;&#19981;&#20877;&#26356;&#25913;&#23384;&#20648;&#22120;&#12290;
<span class="texMathDisplay">\infer{<span class="stt">(value-of (setref-exp </span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">exp_2</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">) =</span><span class="stt">
</span><span class="stt">(</span><span class="texMathInline">\lceil 23 \rceil</span><span class="stt">,[</span><span class="texMathInline">l</span><span class="stt">=</span><span class="texMathInline">val</span><span class="stt">]</span><span class="texMathInline">\sigma_2</span><span class="stt">)</span>}
      {\begin{gathered}
        <span class="stt">(value-of </span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">l</span><span class="stt">,</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span> \\
        <span class="stt">(value-of </span><span class="texMathInline">exp_2</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_1</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">val</span><span class="stt">,</span><span class="texMathInline">\sigma_2</span><span class="stt">)</span>
       \end{gathered}}</span></p><p><a name="(idx._(gentag._613))"></a>
&#36825;&#26465;&#35268;&#21017;&#26159;&#35828;&#65306;<span class="stt">setref-exp</span> &#20174;&#24038;&#21040;&#21491;&#27714;&#25805;&#20316;&#25968;&#30340;&#20540;&#12290;&#31532;&#19968;&#20010;&#25805;&#20316;&#25968;&#30340;&#20540;&#24517;&#39035;&#26159;&#26576;&#20010;&#20301;
&#32622; <span class="texMathInline">l</span> &#30340;&#24341;&#29992;&#65307;&#28982;&#21518; <span class="stt">setref-exp</span> &#25226;&#31532;&#20108;&#20010;&#21442;&#25968;&#30340;&#20540; <span class="texMathInline">val</span> &#25918;&#21040;&#20301;&#32622; <span class="texMathInline">l</span> &#22788;&#65292;
&#20197;&#27492;&#26356;&#26032;&#23384;&#20648;&#22120;&#12290;<span class="stt">setref-exp</span> &#24212;&#35813;&#36820;&#22238;&#20160;&#20040;&#21602;&#65311;&#23427;&#21487;&#20197;&#36820;&#22238;&#20219;&#20309;&#20540;&#12290;&#20026;&#20102;&#24378;&#35843;&#36825;&#19968;&#36873;
&#25321;&#30340;&#38543;&#24847;&#24615;&#65292;&#25105;&#20204;&#35753;&#23427;&#36820;&#22238; 23&#12290;&#22240;&#20026;&#25105;&#20204;&#23545; <span class="stt">setref-exp</span> &#30340;&#36820;&#22238;&#20540;&#19981;&#24863;&#20852;&#36259;&#65292;&#25105;&#20204;&#35828;
&#36825;&#20010;&#34920;&#36798;&#24335;&#30340;&#25191;&#34892;<span class="emph">&#27714;&#25928;&#26524;</span> (<span class="emph">for effect</span>) &#32780;&#19981;&#27714;&#20540;&#12290;
<a name="(idx._(gentag._614))"></a>
<a name="(idx._(gentag._615))"></a>
<a name="(idx._(gentag._616))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex4..6)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;&#19978;&#38754;&#30340;&#35268;&#21017;&#65292;&#35753; <span class="stt">setref-exp</span> &#36820;&#22238;&#21491;&#36793;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..7)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913;&#19978;&#38754;&#30340;&#35268;&#21017;&#65292;&#35753; <span class="stt">setref-exp</span> &#36820;&#22238;&#20301;&#32622;&#30340;&#21407;&#20869;&#23481;&#12290;
<a name="(idx._(gentag._617))"></a></p></blockquote><h5>4.2.3<tt>&nbsp;</tt><a name="(part._s4..2..3)"></a>&#23454;&#29616;</h5><p><a name="(idx._(gentag._618))"></a>
&#36804;&#20170;&#20026;&#27490;&#65292;&#25105;&#20204;&#20351;&#29992;&#30340;&#35268;&#33539;&#35821;&#35328;&#21487;&#20197;&#36731;&#26494;&#25551;&#36848;&#26377;&#25928;&#26524;&#35745;&#31639;&#30340;&#26399;&#26395;&#34892;&#20026;&#65292;&#20294;&#26159;&#23427;&#27809;&#26377;&#20307;&#29616;&#23384;&#20648;
&#22120;&#30340;&#19968;&#20010;&#35201;&#28857;&#65306;&#24341;&#29992;&#26368;&#32456;&#25351;&#21521;&#29616;&#23454;&#19990;&#30028;&#30340;&#20869;&#23384;&#20013;&#26576;&#19968;&#30495;&#23454;&#30340;&#20301;&#32622;&#12290;&#22240;&#20026;&#25105;&#20204;&#21482;&#26377;&#19968;&#20010;&#29616;&#23454;&#19990;
&#30028;&#65292;&#25105;&#20204;&#30340;&#31243;&#24207;&#21482;&#33021;&#35760;&#24405;&#23384;&#20648;&#22120;&#30340;&#19968;&#20010;&#29366;&#24577; <span class="texMathInline">\sigma</span>&#12290;</p><p>&#22312;&#25105;&#20204;&#30340;&#23454;&#29616;&#20013;&#65292;&#25105;&#20204;&#21033;&#29992;&#36825;&#19968;&#20107;&#23454;&#65292;&#29992; Scheme &#20013;&#30340;&#23384;&#20648;&#22120;&#24314;&#27169;&#23384;&#20648;&#22120;&#12290;&#36825;&#26679;&#65292;&#25105;&#20204;&#23601;&#33021;
&#29992; Scheme &#20013;&#30340;&#25928;&#26524;&#24314;&#27169;&#25928;&#26524;&#12290;</p><p>&#25105;&#20204;&#29992;&#19968;&#20010; Scheme &#20540;&#34920;&#31034;&#23384;&#20648;&#22120;&#29366;&#24577;&#65292;&#20294;&#26159;&#25105;&#20204;&#19981;&#20687;&#35268;&#33539;&#24314;&#35758;&#30340;&#37027;&#26679;&#30452;&#25509;&#20256;&#36882;&#21644;&#36820;&#22238;&#23427;&#65292;
&#30456;&#21453;&#65292;&#25105;&#20204;&#22312;&#19968;&#20010;&#20840;&#23616;&#21464;&#37327;&#20013;&#35760;&#24405;&#29366;&#24577;&#65292;&#23454;&#29616;&#20195;&#30721;&#20013;&#30340;&#25152;&#26377;&#36807;&#31243;&#37117;&#33021;&#35775;&#38382;&#23427;&#12290;&#36825;&#24456;&#20687;&#31034;&#20363;&#31243;
&#24207; <span class="stt">even/odd</span> &#20351;&#29992;&#20849;&#20139;&#20301;&#32622;&#65292;&#32780;&#19981;&#26159;&#30452;&#25509;&#20256;&#36882;&#21442;&#25968;&#12290;&#20351;&#29992;&#21333;&#19968;&#20840;&#23616;&#21464;&#37327;&#26102;&#65292;&#25105;&#20204;&#20063;&#20960;
&#20046;&#19981;&#38656;&#35201;&#29702;&#35299; Scheme &#20013;&#30340;&#25928;&#26524;&#12290;</p><p>&#25105;&#20204;&#36824;&#26159;&#35201;&#36873;&#25321;&#22914;&#20309;&#29992; Scheme &#20540;&#24314;&#27169;&#23384;&#20648;&#22120;&#12290;&#25105;&#20204;&#36873;&#25321;&#30340;&#21487;&#33021;&#26159;&#26368;&#31616;&#21333;&#30340;&#27169;&#22411;&#65306;&#20197;&#34920;&#36798;&#20540;
&#21015;&#34920;&#20316;&#20026;&#23384;&#20648;&#22120;&#65292;&#20197;&#20195;&#34920;&#21015;&#34920;&#20301;&#32622;&#30340;&#25968;&#23383;&#34920;&#31034;&#24341;&#29992;&#12290;&#20998;&#37197;&#26032;&#24341;&#29992;&#23601;&#26159;&#32473;&#21015;&#34920;&#26411;&#23614;&#28155;&#21152;&#26032;&#20540;&#65307;
&#26356;&#26032;&#23384;&#20648;&#22120;&#21017;&#24314;&#27169;&#20026;&#25353;&#38656;&#22797;&#21046;&#21015;&#34920;&#30340;&#19968;&#22823;&#37096;&#20998;&#12290;&#20195;&#30721;&#22914;<span class="EoplFigureRef"></span> &#21644;
<span class="stt">fig-4.2</span> &#25152;&#31034;&#12290;</p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">empty-store</span></span> : <span class="texMathInline">() \to \mathit{Sto}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">empty-store</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="emph"><span style="font-weight: bold">&#29992;&#27861;</span> : Scheme &#21464;&#37327;&#65292;&#21253;&#21547;&#23384;&#20648;&#22120;&#24403;&#21069;&#30340;&#29366;&#24577;&#12290;&#21021;&#22987;&#20540;&#26080;&#24847;&#20041;&#12290;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">get-store</span></span> : <span class="texMathInline">() \to \mathit{Sto}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">get-store</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">initialize-store!</span></span> : <span class="texMathInline">() \to \mathit{Unspecified}</span></td></tr><tr><td><span class="emph"><span style="font-weight: bold">&#29992;&#27861;</span> : <span class="stt">(initialize-store!)</span> &#23558;&#23384;&#20648;&#22120;&#35774;&#20026;&#31354;&#12290;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">initialize-store!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">empty-store</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">reference?</span></span> : <span class="texMathInline">\mathit{SchemeVal} \to \mathit{Bool}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">reference?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">integer?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">newref</span></span> : <span class="texMathInline">\mathit{ExpVal} \to \mathit{Ref}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">newref</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">next-ref</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">length</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">append</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">next-ref</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">deref</span></span> : <span class="texMathInline">\mathit{Ref} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">deref</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ref</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="hspace">&nbsp;</span><span class="RktSym">ref</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p>&#25305;&#21155;&#30340;&#23384;&#20648;&#22120;&#27169;&#22411;<a name="(elem._fig-4..1)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">setref!</span></span> : <span class="texMathInline">\mathit{Ref} \times \mathit{ExpVal} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="emph"><span style="font-weight: bold">&#29992;&#27861;</span> : &#38500;&#20102;&#25226;&#20301;&#32622; <span class="stt">ref</span> &#30340;&#20540;&#35774;&#20026; <span class="stt">val</span>&#65292;<span class="stt">the-store</span> &#19982;&#21407;&#29366;&#24577;&#30456;&#21516;&#12290;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">setref!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ref</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set!</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letrec</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">setref-inner</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="emph"><span style="font-weight: bold">&#29992;&#27861;</span> : &#36820;&#22238;&#19968;&#21015;&#34920;&#65292;&#38500;&#20102;&#20301;&#32622; ref1 &#22788;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="emph">&#20540;&#20026; val&#65292;&#19982; store1 &#30456;&#21516;&#12290;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">store1</span><span class="hspace">&nbsp;</span><span class="RktSym">ref1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">null?</span><span class="hspace">&nbsp;</span><span class="RktSym">store1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">report-invalid-reference</span><span class="hspace">&nbsp;</span><span class="RktSym">ref</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">zero?</span><span class="hspace">&nbsp;</span><span class="RktSym">ref1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">store1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">store1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref-inner</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">store1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">ref1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref-inner</span><span class="hspace">&nbsp;</span><span class="RktSym">the-store</span><span class="hspace">&nbsp;</span><span class="RktSym">ref</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p>&#25305;&#21155;&#30340;&#23384;&#20648;&#22120;&#27169;&#22411;&#65292;&#32493;<a name="(elem._fig-4..2)"></a></p></blockquote></blockquote><p>&#36825;&#31181;&#34920;&#31034;&#26497;&#20854;&#20302;&#25928;&#12290;&#19968;&#33324;&#30340;&#20869;&#23384;&#25805;&#20316;&#22823;&#33268;&#22312;&#24120;&#25968;&#26102;&#38388;&#20869;&#23436;&#25104;&#65292;&#20294;&#26159;&#37319;&#29992;&#25105;&#20204;&#30340;&#34920;&#31034;&#65292;&#36825;&#20123;&#25805;
&#20316;&#25152;&#38656;&#30340;&#26102;&#38388;&#19982;&#23384;&#20648;&#22120;&#22823;&#23567;&#25104;&#27491;&#27604;&#12290;&#24403;&#28982;&#65292;&#30495;&#27491;&#23454;&#29616;&#36215;&#26469;&#19981;&#20250;&#36825;&#20040;&#20570;&#65292;&#20294;&#36825;&#36275;&#20197;&#36798;&#21040;&#25105;&#20204;&#30340;
&#30446;&#30340;&#12290;</p><p>&#25105;&#20204;&#32473;&#34920;&#36798;&#20540;&#25968;&#25454;&#31867;&#22411;&#26032;&#22686;&#19968;&#31181;&#21464;&#20307; <span class="stt">ref-val</span>&#65292;&#28982;&#21518;&#20462;&#25913; <span class="stt">value-of-program</span>&#65292;
&#22312;&#27599;&#27425;&#27714;&#20540;&#20043;&#21069;&#21021;&#22987;&#21270;&#23384;&#20648;&#22120;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of-program</span></span> : <span class="texMathInline">\mathit{Program} \to \mathit{SchemeVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pgm</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">initialize-store!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">program</span><span class="hspace">&nbsp;</span><span class="RktSym">pgm</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-program</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">init-env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#29616;&#22312;&#65292;&#25105;&#20204;&#21487;&#20197;&#20889;&#20986; <span class="stt">value-of</span> &#20013;&#19982; <span class="stt">newref</span>&#12289;<span class="stt">deref</span> &#21644; <span class="stt">setref</span> &#30456;
&#20851;&#30340;&#35821;&#21477;&#12290;&#36825;&#20123;&#35821;&#21477;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;</p></blockquote><p>&#25105;&#20204;&#21487;&#20197;&#32473;&#35813;&#31995;&#32479;&#28155;&#21152;&#19968;&#20123;<a name="(elem._trace-instrument)"></a>&#36741;&#21161;&#36807;&#31243;&#65292;&#25226;&#29615;&#22659;&#12289;&#36807;&#31243;&#21644;&#23384;
&#20648;&#22120;&#36716;&#25442;&#20026;&#26356;&#26131;&#35835;&#30340;&#24418;&#24335;&#65292;&#20063;&#21487;&#20197;&#25913;&#21892;&#31995;&#32479;&#65292;&#22312;&#20195;&#30721;&#20013;&#30340;&#20851;&#38190;&#20301;&#32622;&#25171;&#21360;&#28040;&#24687;&#12290;&#25105;&#20204;&#36824;&#20351;&#29992;&#36807;
&#31243;&#25226;&#29615;&#22659;&#12289;&#36807;&#31243;&#21644;&#23384;&#20648;&#22120;&#36716;&#25442;&#20026;&#26356;&#26131;&#35835;&#30340;&#24418;&#24335;&#12290;&#24471;&#20986;&#30340;&#26085;&#24535;&#35814;&#32454;&#25551;&#36848;&#20102;&#31995;&#32479;&#30340;&#21160;&#20316;&#12290;&#20856;&#22411;&#20363;
&#23376;&#22914;<span class="EoplFigureRef"></span> &#21644; <span class="stt">fig-4.5</span> &#25152;&#31034;&#12290;&#27492;&#22806;&#65292;&#36825;&#19968;&#36319;&#36394;&#26085;&#24535;&#36824;&#34920;&#26126;&#65292;
&#24046;&#20540;&#34920;&#36798;&#24335;&#30340;&#21442;&#25968;&#25353;&#20174;&#24038;&#21040;&#21491;&#30340;&#39034;&#24207;&#27714;&#20540;&#12290;
<a name="(idx._(gentag._619))"></a>
<a name="(idx._(gentag._620))"></a>
<a name="(idx._(gentag._621))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex4..8)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25351;&#20986;&#25105;&#20204;&#23454;&#29616;&#30340;&#23384;&#20648;&#22120;&#20013;&#65292;&#21040;&#24213;&#26159;&#21738;&#20123;&#25805;&#20316;&#33457;&#36153;&#20102;&#32447;&#24615;&#26102;&#38388;&#32780;&#38750;&#24120;&#25968;&#26102;&#38388;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..9)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#29992; Scheme &#21521;&#37327;&#34920;&#31034;&#23384;&#20648;&#22120;&#65292;&#20174;&#32780;&#23454;&#29616;&#24120;&#25968;&#26102;&#38388;&#25805;&#20316;&#12290;&#29992;&#36825;&#31181;&#34920;&#31034;&#20250;&#22833;&#21435;&#20160;&#20040;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..10)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._622))"></a>
&#23454;&#29616;<span class="EoplExerciseRef"></span> &#20013;&#23450;&#20041;&#30340; <span class="stt">begin</span> &#34920;&#36798;&#24335;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..11)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._623))"></a>
&#23454;&#29616;<span class="EoplExerciseRef"></span> &#20013;&#30340; <span class="stt">list</span>&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..12)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._624))"></a>
&#20687;&#35299;&#37322;&#22120;&#20013;&#23637;&#31034;&#30340;&#65292;&#25105;&#20204;&#23545;&#23384;&#20648;&#22120;&#30340;&#29702;&#35299;&#22522;&#20110; Scheme &#25928;&#26524;&#30340;&#21547;&#20041;&#12290;&#20855;&#20307;&#22320;&#35828;&#65292;&#25105;&#20204;&#24471;&#30693;&#36947;
&#22312; Scheme &#31243;&#24207;&#20013;&#36825;&#20123;&#25928;&#26524;<span class="emph">&#20309;&#26102;</span>&#20135;&#29983;&#12290;&#25105;&#20204;&#21487;&#20197;&#20889;&#20986;&#26356;&#36148;&#21512;&#35268;&#33539;&#30340;&#35299;&#37322;&#22120;&#65292;&#20174;&#32780;&#36991;
&#20813;&#36825;&#31181;&#20381;&#36182;&#12290;&#22312;&#36825;&#19968;&#35299;&#37322;&#22120;&#20013;&#65292;<span class="stt">value-of</span> &#21516;&#26102;&#36820;&#22238;&#20540;&#21644;&#23384;&#20648;&#22120;&#65292;&#23601;&#20687;&#35268;&#33539;&#20013;&#37027;&#26679;&#12290;&#36825;
&#19968;&#35299;&#37322;&#22120;&#30340;&#29255;&#27573;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;&#25105;&#20204;&#31216;&#20043;&#20026;<span class="emph">&#20256;&#36882;&#23384;&#20648;&#22120;&#30340;&#35299;&#37322;&#22120;</span> (<span class="emph">store-passing
interpreter</span>)&#12290;&#34917;&#20840;&#36825;&#20010;&#35299;&#37322;&#22120;&#65292;&#22788;&#29702;&#25972;&#20010; EXPLICIT-REFS &#35821;&#35328;&#12290;</p><p>&#36807;&#31243;&#21487;&#33021;&#20462;&#25913;&#23384;&#20648;&#22120;&#26102;&#65292;&#19981;&#20165;&#36820;&#22238;&#36890;&#24120;&#30340;&#20540;&#65292;&#36824;&#35201;&#36820;&#22238;&#19968;&#20010;&#26032;&#23384;&#20648;&#22120;&#12290;&#23427;&#20204;&#21253;&#21547;&#22312;&#21517;&#20026;
<span class="stt">answer</span> &#30340;&#25968;&#25454;&#31867;&#22411;&#20043;&#20013;&#12290;&#23436;&#25104;&#36825;&#20010; <span class="stt">value-of</span> &#30340;&#23450;&#20041;&#12290;
<a name="(idx._(gentag._625))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..13)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._626))"></a>
&#25193;&#23637;&#21069;&#19968;&#36947;&#32451;&#20064;&#20013;&#30340;&#35299;&#37322;&#22120;&#65292;&#25903;&#25345;&#22810;&#21442;&#25968;&#36807;&#31243;&#12290;
<a name="(idx._(gentag._627))"></a></p></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref-exp</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">ref-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">deref-exp</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">ref1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;ref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ref1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setref-exp</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">ref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;ref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">begin</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">23</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></div></p><blockquote class="caption"><p><span class="stt">value-of</span> &#30340;&#26174;&#24335;&#24341;&#29992;&#25805;&#20316;&#35821;&#21477;
<a name="(idx._(gentag._628))"></a><a name="(elem._fig-4..3)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&gt; (run "</span></p></td></tr><tr><td><p><span class="stt">let x = newref(22)</span></p></td></tr><tr><td><p><span class="stt">in let f = proc (z) let zz = newref(-(z,deref(x)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in deref(zz)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in -((f 66), (f 55))")</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let x</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 0</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let x &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((x #(struct:ref-val 0))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(i #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(v #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:num-val 10)))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 22)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let f</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let f &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((f</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(procedure</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">z</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">((x #(struct:ref-val 0))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(i #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(v #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(x #(struct:num-val 10)))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:ref-val 0))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(i #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(v #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:num-val 10)))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 22)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; proc z &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((z #(struct:num-val 66))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:ref-val 0))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(i #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(v #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:num-val 10)))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 22)))</span></p></td></tr></table><blockquote class="caption"><p>EXPLICIT-REFS&#30340;&#27714;&#20540;&#36319;&#36394;&#26085;&#24535;<a name="(elem._fig-4..4)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let zz</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 1</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let zz &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((zz #(struct:ref-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(z #(struct:num-val 66))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:ref-val 0))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(i #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(v #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:num-val 10)))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 22)) (1 #(struct:num-val 44)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; proc z &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((z #(struct:num-val 55))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:ref-val 0))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(i #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(v #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:num-val 10)))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 22)) (1 #(struct:num-val 44)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let zz</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 2</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let zz &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((zz #(struct:ref-val 2))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(z #(struct:num-val 55))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:ref-val 0))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(i #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(v #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(x #(struct:num-val 10)))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 22))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 44))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 33)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">#(struct:num-val 11)</span></p></td></tr><tr><td><p><span class="stt">&gt;</span></p></td></tr></table><blockquote class="caption"><p>EXPLICIT-REFS&#30340;&#27714;&#20540;&#36319;&#36394;&#26085;&#24535;&#65292;&#32493;<a name="(elem._fig-4..5)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-datatype</span><span class="hspace">&nbsp;</span><span class="RktSym">answer</span><span class="hspace">&nbsp;</span><span class="RktSym">answer?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">an-answer</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">exp-val?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">store</span><span class="hspace">&nbsp;</span><span class="RktSym">store?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">value-of</span></span> : <span class="texMathInline">\mathit{Exp} \times \mathit{Env} \times \mathit{Sto} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">store</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">const-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">an-answer</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">store</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">an-answer</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-store</span><span class="hspace">&nbsp;</span><span class="RktSym">store</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">store</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">answer</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">store</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">an-answer</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">new-store</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;bool</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp2</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">new-store</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp3</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">new-store</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref-exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">answer</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">store</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">an-answer</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktSym">new-store</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">ref1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expval-&gt;ref</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">an-answer</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktSym">ref1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">new-store</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p><span class="EoplExerciseRef"></span>&#65292;&#20256;&#36882;&#23384;&#20648;&#22120;&#30340;&#35299;&#37322;&#22120;<a name="(elem._fig-4..6)"></a></p></blockquote></blockquote><h4>4.3<tt>&nbsp;</tt><a name="(part._s4..3)"></a>IMPLICIT-REFS&#65306;&#38544;&#24335;&#24341;&#29992;&#35821;&#35328;</h4><p><a name="(idx._(gentag._629))"></a>
<a name="(idx._(gentag._630))"></a>
<a name="(idx._(gentag._631))"></a>
&#26174;&#24335;&#24341;&#29992;&#35774;&#35745;&#28165;&#26224;&#25551;&#36848;&#20102;&#20869;&#23384;&#30340;&#20998;&#37197;&#12289;&#35299;&#24341;&#29992;&#21644;&#21464;&#26356;&#65292;&#22240;&#20026;&#26174;&#32780;&#26131;&#35265;&#65292;&#36825;&#20123;&#25805;&#20316;&#37117;&#22312;&#31243;&#24207;&#21592;
&#30340;&#20195;&#30721;&#20043;&#20013;&#12290;</p><p>&#22823;&#22810;&#25968;&#32534;&#31243;&#35821;&#35328;&#37117;&#29992;&#20849;&#21516;&#30340;&#26041;&#24335;&#22788;&#29702;&#20998;&#37197;&#12289;&#35299;&#24341;&#29992;&#21644;&#21464;&#26356;&#65292;&#24182;&#25226;&#23427;&#20204;&#25171;&#21253;&#20026;&#35821;&#35328;&#30340;&#19968;&#37096;&#20998;&#12290;
&#36825;&#26679;&#65292;&#30001;&#20110;&#36825;&#20123;&#25805;&#20316;&#23384;&#22312;&#20110;&#35821;&#35328;&#20869;&#37096;&#65292;&#31243;&#24207;&#21592;&#19981;&#38656;&#35201;&#25285;&#24515;&#20309;&#26102;&#25191;&#34892;&#23427;&#20204;&#12290;
<a name="(idx._(gentag._632))"></a></p><p>&#22312;&#36825;&#31181;&#35774;&#35745;&#20013;&#65292;&#27599;&#20010;&#21464;&#37327;&#37117;&#34920;&#31034;&#19968;&#20010;&#24341;&#29992;&#12290;&#25351;&#20195;&#20540;&#26159;&#21253;&#21547;&#34920;&#36798;&#20540;&#30340;&#20301;&#32622;&#30340;&#24341;&#29992;&#12290;&#24341;&#29992;&#19981;&#20877;&#26159;
&#34920;&#36798;&#20540;&#65292;&#21482;&#33021;&#20316;&#20026;&#21464;&#37327;&#32465;&#23450;&#12290;<a name="(idx._(gentag._633))"></a></p><blockquote class="SubFlow"><p><span class="Iidentity">\begin{align*}\mathit{ExpVal} &amp;= \mathit{Int} + \mathit{Bool} + \mathit{Proc} \\
\mathit{DenVal} &amp;= \mathit{Ref(ExpVal)}\end{align*}</span></p><p>&#27599;&#27425;&#32465;&#23450;&#25805;&#20316;&#37117;&#20250;&#20998;&#37197;&#19968;&#20010;&#20301;&#32622;&#65306;&#22312;&#27599;&#20010;&#36807;&#31243;&#35843;&#29992;&#22788;&#65292;&#22312; <span class="stt">let</span> &#21644; <span class="stt">letrec</span> &#20013;&#12290;</p></blockquote><p>&#24403;&#21464;&#37327;&#20986;&#29616;&#22312;&#34920;&#36798;&#24335;&#20013;&#65292;&#25105;&#20204;&#39318;&#20808;&#22312;&#29615;&#22659;&#20013;&#26597;&#25214;&#26631;&#35782;&#31526;&#65292;&#25214;&#21040;&#32465;&#23450;&#30340;&#20301;&#32622;&#65292;&#28982;&#21518;&#22312;&#23384;&#20648;&#22120;&#20013;
&#25214;&#20986;&#37027;&#20010;&#20301;&#32622;&#30340;&#20540;&#12290;&#22240;&#27492;&#23545; <span class="stt">var-exp</span>&#65292;&#25105;&#20204;&#26377;&#20010;&#8220;&#20108;&#32423;&#8221;&#31995;&#32479;&#12290;</p><p>&#19968;&#20010;&#20301;&#32622;&#30340;&#20869;&#23481;&#21487;&#29992; <span class="stt">set</span> &#34920;&#36798;&#24335;&#20462;&#25913;&#65292;&#35821;&#27861;&#20026;&#65306;</p><p><span class="Iidentity">\begin{align*}\mathit{Expression} &amp;::= <span class="stt">set </span><span class="Iidentity">\mathit{Identifier}</span><span class="stt"> = </span><span class="Iidentity">\mathit{Expression}</span> \\[-3pt]
  &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">assign-exp (var exp1)</span>}\end{align*}</span></p><p>&#36825;&#37324;&#30340; <span class="texMathInline">\mathit{Identifier}</span> &#19981;&#26159;&#34920;&#36798;&#24335;&#30340;&#19968;&#37096;&#20998;&#65292;&#25152;&#20197;&#26080;&#27861;&#35299;&#24341;&#29992;&#12290;&#22312;&#36825;&#31181;&#35774;&#35745;&#20013;&#65292;
&#25105;&#20204;&#35828;&#21464;&#37327;&#26159;<span class="emph">&#21487;&#21464;&#30340;</span> (<span class="emph">mutable</span>)&#65292;&#24847;&#20026;&#21487;&#20197;&#20462;&#25913;&#12290;<a name="(idx._(gentag._634))"></a></p><p><a name="(idx._(gentag._635))"></a>
&#36825;&#31181;&#35774;&#35745;&#21483;&#20570;<span class="emph">&#25353;&#20540;&#35843;&#29992;</span> (<span class="emph">call-by-value</span>)&#65292;&#25110;<span class="emph">&#38544;&#24335;
&#24341;&#29992;</span> (<span class="emph">implicit reference</span>)&#12290;&#22823;&#22810;&#25968;&#32534;&#31243;&#35821;&#35328;&#65292;&#21253;&#25324; Scheme&#65292;&#37117;&#37319;&#32435;&#36825;&#19968;&#35774;&#35745;&#30340;&#26576;&#31181;&#21464;&#20307;&#12290;</p><p><span class="EoplFigureRef"></span> &#26159;&#36825;&#31181;&#35774;&#35745;&#30340;&#20004;&#20010;&#31034;&#20363;&#31243;&#24207;&#12290;&#22240;&#20026;&#24341;&#29992;&#19981;&#20877;&#26159;&#34920;&#36798;&#20540;&#65292;&#25105;&#20204;&#19981;&#33021;
&#20687;<a href="#%28part._s4..2%29" data-pltdoc="x">EXPLICIT-REFS&#65306;&#26174;&#24335;&#24341;&#29992;&#35821;&#35328;</a>&#20013;&#30340;&#20363;&#23376;&#37027;&#26679;&#20570;&#38142;&#24335;&#24341;&#29992;&#12290;</p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let x = 0</span></p></td></tr><tr><td><p><span class="stt">in letrec even(dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 1</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set x = -(x,1);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(odd 888)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">odd(dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set x = -(x,1);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(even 888)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin set x = 13; (odd -888) end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">let g = let count = 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in proc (dummy)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set count = -(count,-1);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">count</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt">in let a = (g 11)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let b = (g 11)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in -(a,b)</span></p></td></tr></table></blockquote></div></p><blockquote class="caption"><p>IMPLICIT-REFS&#20013;&#30340; <span class="stt">odd</span> &#21644; <span class="stt">even</span><a name="(elem._fig-4..7)"></a></p></blockquote></blockquote><h5>4.3.1<tt>&nbsp;</tt><a name="(part._s4..3..1)"></a>&#35268;&#33539;</h5><p><a name="(idx._(gentag._636))"></a>
&#25105;&#20204;&#21487;&#20197;&#36731;&#26494;&#20889;&#20986;&#35299;&#24341;&#29992;&#21644; <span class="stt">set</span> &#30340;&#35268;&#21017;&#12290;&#29616;&#22312;&#65292;&#29615;&#22659;&#24635;&#26159;&#25226;&#21464;&#37327;&#32465;&#23450;&#21040;&#20301;&#32622;&#65292;&#25152;&#20197;&#24403;
&#21464;&#37327;&#20316;&#20026;&#34920;&#36798;&#24335;&#26102;&#65292;&#25105;&#20204;&#38656;&#35201;&#23558;&#20854;&#35299;&#24341;&#29992;&#65306;
<span class="texMathDisplay"><span class="stt">(value-of (var-exp </span><span class="texMathInline">var</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">\sigma(\rho(var))</span><span class="stt">,</span><span class="texMathInline">\sigma</span><span class="stt">)</span></span></p><p>&#36171;&#20540;&#23601;&#20687;&#25105;&#20204;&#39044;&#24819;&#30340;&#37027;&#26679;&#65306;&#25105;&#20204;&#22312;&#29615;&#22659;&#20013;&#26597;&#25214;&#24335;&#23376;&#24038;&#20391;&#30340;&#26631;&#35782;&#31526;&#65292;&#33719;&#21462;&#19968;&#20010;&#20301;&#32622;&#65292;&#22312;&#29615;&#22659;&#20013;
&#27714;&#21491;&#36793;&#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#20462;&#25913;&#25351;&#23450;&#20301;&#32622;&#30340;&#20869;&#23481;&#12290;&#23601;&#20687; <span class="stt">setref</span>&#65292;<span class="stt">set</span> &#34920;&#36798;&#24335;&#30340;&#36820;&#22238;&#20540;
&#20219;&#24847;&#12290;&#25105;&#20204;&#35753;&#23427;&#36820;&#22238;&#34920;&#36798;&#20540; 27&#12290;
<span class="texMathDisplay">\infer{<span class="stt">(value-of (assign-exp </span><span class="texMathInline">var</span><span class="stt"> </span><span class="texMathInline">exp_1</span><span class="stt">) </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">) =</span><span class="stt">
</span><span class="stt">(</span><span class="texMathInline">\lceil 27 \rceil</span><span class="stt">,[</span><span class="texMathInline">\rho(var)</span><span class="stt">=</span><span class="texMathInline">val_1</span><span class="stt">]</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span>}
      {<span class="stt">(value-of </span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> = <span class="stt">(</span><span class="texMathInline">val_1</span><span class="stt">,</span><span class="texMathInline">\sigma_1</span><span class="stt">)</span>}</span></p><p><a name="(idx._(gentag._637))"></a>
&#25105;&#20204;&#36824;&#35201;&#37325;&#20889;&#36807;&#31243;&#35843;&#29992;&#21644; <span class="stt">let</span> &#35268;&#21017;&#65292;&#20307;&#29616;&#20986;&#23545;&#23384;&#20648;&#22120;&#30340;&#20462;&#25913;&#12290;&#23545;&#36807;&#31243;&#35843;&#29992;&#65292;&#35268;&#21017;&#21464;&#25104;&#65306;
<a name="(idx._(gentag._638))"></a>
<a name="(idx._(gentag._639))"></a></p><blockquote class="SubFlow"><blockquote class="EoplEquationInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(apply-procedure (procedure </span><span class="texMathInline">var</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">body</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">\rho</span><span class="stt">) </span><span class="texMathInline">val</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt"></span><span class="texMathInline">\sigma</span><span class="stt">)</span></p></td></tr><tr><td><p><span class="stt">= (value-of </span><span class="texMathInline">body</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">[</span><span class="texMathInline">var=l</span><span class="stt">]</span><span class="texMathInline">\rho</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">[</span><span class="texMathInline">l=val</span><span class="stt">]</span><span class="texMathInline">\sigma</span><span class="stt">)</span></p></td></tr></table></blockquote><p>&#20854;&#20013;&#65292;<span class="texMathInline">l</span> &#26159;&#19981;&#22312; <span class="texMathInline">\sigma</span> &#23450;&#20041;&#22495;&#20013;&#30340;&#26576;&#19968;&#20301;&#32622;&#12290;
<a name="(idx._(gentag._640))"></a></p></blockquote><p><a name="(idx._(gentag._641))"></a>
<a name="(idx._(gentag._642))"></a>
<span class="stt">(let-exp </span><span class="texMathInline">var</span><span class="stt"> </span><span class="texMathInline">exp_1</span><span class="stt"> </span><span class="texMathInline">body</span><span class="stt">)</span> &#30340;&#35268;&#21017;&#31867;&#20284;&#12290;&#25105;&#20204;&#39318;&#20808;&#27714;&#21491;&#36793; <span class="texMathInline">exp_1</span>
&#30340;&#20540;&#65292;&#28982;&#21518;&#23558;&#35813;&#20540;&#25918;&#20837;&#19968;&#20010;&#26032;&#20301;&#32622;&#65292;&#23558;&#21464;&#37327; <span class="texMathInline">var</span> &#32465;&#23450;&#21040;&#36825;&#20010;&#20301;&#32622;&#65292;&#22312;&#24471;&#21040;&#30340;&#29615;&#22659;&#20013;&#27714;
<span class="stt">let</span> &#20027;&#20307;&#30340;&#20540;&#65292;&#20316;&#20026;&#25972;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;&#12290;
<a name="(idx._(gentag._643))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex4..14)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986; <span class="stt">let</span> &#30340;&#35268;&#21017;&#12290;</p></blockquote><h5>4.3.2<tt>&nbsp;</tt><a name="(part._s4..3..2)"></a>&#23454;&#29616;</h5><p>&#29616;&#22312;&#25105;&#20204;&#30528;&#25163;&#20462;&#25913;&#35299;&#37322;&#22120;&#12290;&#22312; <span class="stt">value-of</span> &#20013;&#65292;&#25105;&#20204;&#21462;&#20986;&#27599;&#20010; <span class="stt">var-exp</span> &#30340;&#20540;&#65292;&#23601;&#20687;
&#35268;&#21017;&#25551;&#36848;&#30340;&#37027;&#26679;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p><span class="stt">assign-exp</span> &#30340;&#20195;&#30721;&#20063;&#26174;&#32780;&#26131;&#35265;&#65306;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">assign-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">begin</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">27</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote></blockquote><p>&#21019;&#24314;&#24341;&#29992;&#21602;&#65311;&#26032;&#30340;&#20301;&#32622;&#24212;&#22312;&#27599;&#19968;&#26032;&#32465;&#23450;&#22788;&#21019;&#24314;&#12290;&#36825;&#38376;&#35821;&#35328;&#20013;&#21482;&#26377;&#22235;&#20010;&#22320;&#26041;&#21019;&#24314;&#26032;&#32465;&#23450;&#65306;&#21021;&#22987;
&#29615;&#22659;&#20013;&#12289;<span class="stt">let</span> &#20013;&#12289;&#36807;&#31243;&#35843;&#29992;&#20197;&#21450; <span class="stt">letrec</span> &#20013;&#12290;</p><p>&#22312;&#21021;&#22987;&#29615;&#22659;&#20013;&#65292;&#25105;&#20204;&#30452;&#25509;&#20998;&#37197;&#26032;&#20301;&#32622;&#12290;</p><p><a name="(idx._(gentag._644))"></a>
<a name="(idx._(gentag._645))"></a>
&#23545; <span class="stt">let</span>&#65292;&#25105;&#20204;&#20462;&#25913; <span class="stt">value-of</span> &#20013;&#30456;&#24212;&#30340;&#34892;&#65292;&#20998;&#37197;&#21253;&#21547;&#20540;&#30340;&#26032;&#20301;&#32622;&#65292;&#24182;&#25226;&#21464;&#37327;&#32465;&#23450;
&#21040;&#25351;&#21521;&#35813;&#20301;&#32622;&#30340;&#24341;&#29992;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">body</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p><a name="(idx._(gentag._646))"></a>
<a name="(idx._(gentag._647))"></a>
<a name="(idx._(gentag._648))"></a>
&#23545;&#36807;&#31243;&#35843;&#29992;&#65292;&#25105;&#20204;&#21516;&#26679;&#20462;&#25913; <span class="stt">apply-procedure</span>&#65292;&#35843;&#29992; <span class="stt">newref</span>&#12290;</p><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">apply-procedure</span></span> : <span class="texMathInline">\mathit{Proc} \times \mathit{ExpVal} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._649))"></a>
<a name="(idx._(gentag._650))"></a>
<a name="(idx._(gentag._651))"></a></div></p></blockquote><p><a name="(idx._(gentag._652))"></a>
<a name="(idx._(gentag._653))"></a>
&#26368;&#21518;&#65292;&#35201;&#22788;&#29702; <span class="stt">letrec</span>&#65292;&#25105;&#20204;&#26367;&#25442; <span class="stt">apply-env</span> &#20013;&#30340; <span class="stt">extend-env-rec</span> &#20174;&#21477;&#65292;
&#20196;&#20854;&#36820;&#22238;&#19968;&#20010;&#24341;&#29992;&#65292;&#25351;&#21521;&#21253;&#21547;&#36866;&#24403;&#38381;&#21253;&#30340;&#20301;&#32622;&#12290;&#30001;&#20110;&#25105;&#20204;&#20351;&#29992;&#22810;&#22768;&#26126;&#30340;
<span class="stt">letrec</span>&#65288;<span class="EoplExerciseRef"></span>&#65289;&#65292;<span class="stt">extend-env-rec</span> &#21462;&#19968;&#20010;&#36807;&#31243;&#21517;&#21015;&#34920;&#65292;&#19968;&#20010;
&#32465;&#23450;&#21464;&#37327;&#21015;&#34920;&#65292;&#19968;&#20010;&#36807;&#31243;&#20027;&#20307;&#21015;&#34920;&#65292;&#20197;&#21450;&#24050;&#20445;&#23384;&#30340;&#29615;&#22659;&#12290;&#36807;&#31243; <span class="stt">location</span> &#21462;&#19968;&#21464;&#37327;&#65292;
&#19968;&#20010;&#21464;&#37327;&#21015;&#34920;&#12290;&#33509;&#21464;&#37327;&#23384;&#22312;&#20110;&#21015;&#34920;&#20013;&#65292;<span class="stt">location</span> &#36820;&#22238;&#21464;&#37327;&#22312;&#21015;&#34920;&#20013;&#30340;&#20301;&#32622;&#65307;&#33509;&#19981;&#23384;&#22312;&#65292;
&#36820;&#22238; <span class="stt">#f</span>&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env-rec</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">p-names</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">b-vars</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-bodies</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">n</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">location</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">search-var</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-names</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">if</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">n</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">proc-val</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">list-ref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">b-vars</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">list-ref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p-bodies</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">saved-env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">search-var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p><span class="EoplFigureRef"></span> &#29992;<a href="#%28elem._trace-instrument%29" data-pltdoc="x">&#21069;&#38754;</a>&#20171;&#32461;&#30340;&#36741;&#21161;&#32452;&#20214;&#65292;&#23637;&#31034;&#20102;
IMPLICIT-REFS &#27714;&#20540;&#30340;&#31616;&#21333;&#20363;&#23376;&#12290;
<a name="(idx._(gentag._654))"></a>
<a name="(idx._(gentag._655))"></a></p><blockquote class="EoplFigure"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&gt; (run "</span></p></td></tr><tr><td><p><span class="stt">let f = proc (x) proc (y)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set x = -(x,-1);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">-(x,y)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt">in ((f 44) 33)")</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 0</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 1</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 2</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let f</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 3</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let f &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((f 3) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 (procedure x ... ((i 0) (v 1) (x 2)))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 4</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; proc x &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((x 4) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 (procedure x ... ((i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(4 #(struct:num-val 44)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 5</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; proc y &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((y 5) (x 4) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 (procedure x ... ((i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(4 #(struct:num-val 44))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(5 #(struct:num-val 33)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">#(struct:num-val 12)</span></p></td></tr><tr><td><p><span class="stt">&gt;</span></p></td></tr></table><blockquote class="caption"><p>IMPLICIT-REFS&#30340;&#31616;&#21333;&#27714;&#20540;<a name="(elem._fig-4..8)"></a></p></blockquote></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..15)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22312;<span class="EoplFigureRef"></span> &#20013;&#65292;&#29615;&#22659;&#20013;&#30340;&#21464;&#37327;&#20026;&#20160;&#20040;&#32465;&#23450;&#21040;&#19968;&#33324;&#30340;&#25972;&#25968;&#65292;&#32780;&#19981;
&#26159;<span class="EoplFigureRef"></span> &#20013;&#37027;&#26679;&#30340;&#34920;&#36798;&#20540;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..16)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._656))"></a>
<a name="(idx._(gentag._657))"></a>
&#26082;&#28982;&#21464;&#37327;&#26159;&#21487;&#21464;&#30340;&#65292;&#25105;&#20204;&#21487;&#20197;&#38752;&#36171;&#20540;&#20135;&#29983;&#36882;&#24402;&#36807;&#31243;&#12290;&#20363;&#22914;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec times4(x) = if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else -((times4 -(x,1)), -4)</span></p></td></tr><tr><td><p><span class="stt">in (times4 3)</span></p></td></tr></table></blockquote><p>&#21487;&#20197;&#26367;&#25442;&#20026;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let times4 = 0</span></p></td></tr><tr><td><p><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set times4 = proc (x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else -((times4 -(x,1)), -4);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(times4 3);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr></table></blockquote><p>&#25163;&#21160;&#36319;&#36394;&#36825;&#20010;&#31243;&#24207;&#65292;&#39564;&#35777;&#36825;&#31181;&#32763;&#35793;&#21487;&#34892;&#12290;
<a name="(idx._(gentag._658))"></a>
<a name="(idx._(gentag._659))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..17)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._660))"></a>
&#20889;&#20986;&#35268;&#21017;&#24182;&#23454;&#29616;&#22810;&#21442;&#25968;&#36807;&#31243;&#21644;&#22768;&#26126;&#22810;&#21464;&#37327;&#30340; <span class="stt">let</span>&#12290;
<a name="(idx._(gentag._661))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..18)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._662))"></a>
&#20889;&#20986;&#35268;&#21017;&#24182;&#23454;&#29616;&#22768;&#26126;&#22810;&#36807;&#31243;&#30340; <span class="stt">letrec</span> &#34920;&#36798;&#24335;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..19)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._663))"></a>
&#20462;&#25913;&#22768;&#26126;&#22810;&#36807;&#31243;&#30340; <span class="stt">letrec</span> &#23454;&#29616;&#65292;&#35753;&#27599;&#20010;&#38381;&#21253;&#21482;&#29983;&#25104;&#19968;&#27425;&#65292;&#24182;&#19988;&#21482;&#20998;&#37197;&#19968;&#20010;&#20301;&#32622;&#12290;&#26412;
&#39064;&#31867;&#20284;<span class="EoplExerciseRef"></span>&#12290;
<a name="(idx._(gentag._664))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..20)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._665))"></a>
&#22312;&#26412;&#33410;&#30340;&#35821;&#35328;&#20013;&#65292;&#23601;&#20687;&#22312; Scheme &#20013;&#19968;&#26679;&#65292;&#25152;&#26377;&#21464;&#37327;&#37117;&#26159;&#21487;&#21464;&#30340;&#12290;&#21478;&#19968;&#31181;&#35774;&#35745;&#26159;&#21516;&#26102;&#20801;&#35768;&#21487;
&#21464;&#21644;&#19981;&#21487;&#21464;&#30340;&#21464;&#37327;&#32465;&#23450;&#65306;
<span class="Iidentity">\begin{align*}\mathit{ExpVal} &amp;= \mathit{Int} + \mathit{Bool} + \mathit{Proc} \\
\mathit{DenVal} &amp;= \mathit{Ref(ExpVal)} + \mathit{ExpVal}\end{align*}</span>
&#21482;&#26377;&#21464;&#37327;&#32465;&#23450;&#21487;&#21464;&#26102;&#65292;&#25165;&#33021;&#36171;&#20540;&#12290;&#24403;&#25351;&#20195;&#20540;&#26159;&#24341;&#29992;&#26102;&#65292;&#35299;&#24341;&#29992;&#33258;&#21160;&#36827;&#34892;&#12290;</p><p>&#20462;&#25913;&#26412;&#33410;&#30340;&#35821;&#35328;&#65292;&#35753; <span class="stt">let</span> &#20687;&#20043;&#21069;&#37027;&#26679;&#24341;&#20837;&#19981;&#21487;&#21464;&#21464;&#37327;&#65292;&#21487;&#21464;&#21464;&#37327;&#21017;&#30001;
<span class="stt">letmutable</span> &#34920;&#36798;&#24335;&#24341;&#20837;&#65292;&#35821;&#27861;&#20026;&#65306;
<span class="texMathDisplay">\mathit{Expression} ::= <span class="stt">letmutable </span><span class="texMathInline">\mathit{Identifier}</span><span class="stt"> = </span><span class="texMathInline">\mathit{Expression}</span><span class="stt"> in </span><span class="texMathInline">\mathit{Expression}</span></span>
<a name="(idx._(gentag._666))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..21)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._667))"></a>
<a name="(idx._(gentag._668))"></a>
<a name="(idx._(gentag._669))"></a>
<a name="(idx._(gentag._670))"></a>
<a name="(idx._(gentag._671))"></a>
<a name="(idx._(gentag._672))"></a>
&#20043;&#21069;&#65292;&#25105;&#20204;&#24314;&#35758;&#20004;&#20010;&#30456;&#21435;&#24456;&#36828;&#30340;&#36807;&#31243;&#36890;&#36807;&#36171;&#20540;&#20132;&#25442;&#20449;&#24687;&#65292;&#36991;&#20813;&#23621;&#38388;&#30340;&#36807;&#31243;&#30693;&#26195;&#65292;&#20174;&#32780;&#20351;&#31243;&#24207;
&#26356;&#21152;&#27169;&#22359;&#21270;&#12290;&#36825;&#26679;&#30340;&#36171;&#20540;&#24120;&#24120;&#24212;&#35813;&#26159;&#20020;&#26102;&#30340;&#65292;&#21482;&#22312;&#25191;&#34892;&#20989;&#25968;&#35843;&#29992;&#26102;&#29983;&#25928;&#12290;&#21521;&#35821;&#35328;
&#28155;&#21152;<span class="emph">&#21160;&#24577;&#36171;&#20540;</span> (<span class="emph">dynamic assignment</span>)&#65288;&#21448;&#31216;<span class="emph">&#27969;&#24335;&#32465;&#23450;</span> (<span class="emph">fluid binding</span>)&#65289;
&#32452;&#20214;&#65292;&#23436;&#25104;&#36825;&#19968;&#25805;&#20316;&#12290;&#29983;&#25104;&#24335;&#20026;&#65306;
<a name="(idx._(gentag._673))"></a></p><p><span class="Iidentity">\begin{align*}\mathit{Expression} &amp;::= <span class="stt">setdynamic </span><span class="Iidentity">\mathit{Identifier}</span><span class="stt"> = </span><span class="Iidentity">\mathit{Expression}</span><span class="stt"> during </span><span class="Iidentity">\mathit{Expression}</span> \\[-3pt]
  &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">setdynamic-exp (var exp1 body)</span>}\end{align*}</span></p><p><span class="stt">setdynamic</span> &#34920;&#36798;&#24335;&#30340;&#25928;&#26524;&#26159;&#25226;<span class="texMathInline">exp_1</span> &#30340;&#20540;&#20020;&#26102;&#36171;&#32473; <span class="texMathInline">var</span>&#65292;&#27714; <span class="texMathInline">body</span> &#30340;&#20540;&#65292;
&#37325;&#26032;&#32473; <span class="texMathInline">var</span> &#36171;&#20854;&#21407;&#20540;&#65292;&#28982;&#21518;&#36820;&#22238; <span class="texMathInline">body</span> &#30340;&#20540;&#12290;&#21464;&#37327; <span class="texMathInline">var</span> &#24517;&#38656;&#24050;&#32465;&#23450;&#12290;&#20363;&#22914;&#65292;
&#22312;&#19979;&#21015;&#34920;&#36798;&#24335;&#20013;&#65306;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let x = 11</span></p></td></tr><tr><td><p><span class="stt">in let p = proc (y) -(y,x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in -(setdynamic x = 17 during (p 22),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(p 13))</span></p></td></tr></table></blockquote><p><span class="texMathInline">x</span> &#26159;&#36807;&#31243; <span class="stt">p</span> &#20013;&#30340;&#33258;&#30001;&#21464;&#37327;&#65292;&#22312;&#35843;&#29992; <span class="stt">(p 22)</span> &#20013;&#20540;&#20026; 17&#65292;&#22312;&#35843;&#29992; <span class="stt">(p
13)</span> &#20013;&#37325;&#35774;&#20026; 11&#65292;&#25152;&#20197;&#34920;&#36798;&#24335;&#30340;&#20540;&#20026; <span class="texMathInline">5-2=3</span>&#12290;
<a name="(idx._(gentag._674))"></a>
<a name="(idx._(gentag._675))"></a>
<a name="(idx._(gentag._676))"></a>
<a name="(idx._(gentag._677))"></a>
<a name="(idx._(gentag._678))"></a>
<a name="(idx._(gentag._679))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..22)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._680))"></a>
&#36804;&#20170;&#20026;&#27490;&#65292;&#25105;&#20204;&#30340;&#35821;&#35328;&#37117;&#26159;<span class="emph">&#38754;&#21521;&#34920;&#36798;&#24335;</span> (<span class="emph">expression-oriented</span>)&#30340;&#65306;&#25105;&#20204;&#24863;&#20852;&#36259;&#30340;
&#20027;&#35201;&#26159;&#34920;&#36798;&#24335;&#36825;&#31181;&#21477;&#27861;&#31867;&#21035;&#21644;&#23427;&#20204;&#30340;&#20540;&#12290;&#25193;&#23637;&#35821;&#35328;&#65292;&#24314;&#27169;&#31616;&#21333;
&#30340;<span class="emph">&#38754;&#21521;&#35821;&#21477;</span> (<span class="emph">statement-oriented</span>) &#30340;&#35821;&#35328;&#65292;&#20854;&#35268;&#33539;&#27010;&#36848;&#22914;&#19979;&#12290;&#19968;&#23450;&#35201;<span class="emph">&#36981;&#24490;
&#35821;&#27861;</span>&#65292;&#20998;&#21035;&#20889;&#20986;&#36807;&#31243;&#26469;&#22788;&#29702;&#31243;&#24207;&#12289;&#35821;&#21477;&#21644;&#34920;&#36798;&#24335;&#12290;</p><blockquote class="Hangindent"><p><span style="font-weight: bold">&#20540;</span><span class="hspace">&nbsp;</span>&#21516; IMPLICIT-REFS&#12290;</p></blockquote><blockquote class="Hangindent"><p><span style="font-weight: bold">&#35821;&#27861;</span><span class="hspace">&nbsp;</span>&#20351;&#29992;&#19979;&#21015;&#35821;&#27861;&#65306;</p><blockquote class="SubFlow"><p><span class="Iidentity">\begin{align*}  \mathit{Program} &amp;::= \mathit{Statement} \\[-3pt]
\mathit{Statement} &amp;::= <span class="Iidentity">\mathit{Identifier}</span><span class="stt"> = </span><span class="Iidentity">\mathit{Expression}</span> \\[-3pt]
                   &amp;::= <span class="stt">print </span><span class="Iidentity">\mathit{Expression}</span> \\[-3pt]
                   &amp;::= \{\{\mathit{Statement}^{*(;)}\}\} \\[-3pt]
                   &amp;::= <span class="stt">if </span><span class="Iidentity">\mathit{Expression}</span><span class="stt"> </span><span class="Iidentity">\mathit{Statement}</span><span class="stt"> </span><span class="Iidentity">\mathit{Statement}</span> \\[-3pt]
                   &amp;::= <span class="stt">while </span><span class="Iidentity">\mathit{Expression}</span><span class="stt"> </span><span class="Iidentity">\mathit{Statement}</span> \\[-3pt]
                   &amp;::= <span class="stt">var </span><span class="Iidentity">\{\mathit{Identifier}\}^{*(;)}</span><span class="stt"> ; </span><span class="Iidentity">\mathit{Statement}</span> \\[-3pt]\end{align*}</span></p></blockquote><p>&#38750;&#32456;&#32467;&#31526; <span class="texMathInline">\mathit{Expression}</span> &#25351;&#30340;&#26159; IMPLICIT-REFS &#35821;&#35328;&#20013;&#30340;&#34920;&#36798;&#24335;&#65292;&#21487;&#33021;&#31245;&#26377;&#25193;
&#23637;&#12290;</p></blockquote><blockquote class="Hangindent"><p><span style="font-weight: bold">&#35821;&#20041;</span><span class="hspace">&nbsp;</span>&#31243;&#24207;&#26159;&#19968;&#20010;&#35821;&#21477;&#12290;&#35821;&#21477;&#19981;&#36820;&#22238;&#20540;&#65292;&#32780;&#26159;&#20462;&#25913;&#21644;&#25171;&#21360;&#23384;&#20648;&#22120;&#12290;</p><p>&#36171;&#20540;&#35821;&#21477;&#20173;&#25353;&#36890;&#24120;&#30340;&#26041;&#24335;&#25191;&#34892;&#12290;&#25171;&#21360;&#35821;&#21477;&#27714;&#20986;&#23454;&#21442;&#30340;&#20540;&#65292;&#25171;&#21360;&#32467;&#26524;&#12290;<span class="stt">if</span> &#35821;&#21477;&#20173;&#25353;&#36890;&#24120;
&#30340;&#26041;&#24335;&#25191;&#34892;&#12290;&#22359;&#35821;&#21477;&#23450;&#20041;&#35265; <span class="texMathInline">\mathit{Statement}</span> &#20013;&#30340;&#26368;&#21518;&#19968;&#20010;&#29983;&#25104;&#24335;&#12290;&#23427;&#25226;&#27599;&#20010;&#22768;&#26126;
&#21464;&#37327;&#32465;&#23450;&#21040;&#19968;&#20010;&#26410;&#21021;&#22987;&#21270;&#30340;&#24341;&#29992;&#65292;&#28982;&#21518;&#25191;&#34892;&#22359;&#20027;&#20307;&#12290;&#36825;&#20123;&#32465;&#23450;&#30340;&#20316;&#29992;&#22495;&#26159;&#22359;&#20027;&#20307;&#12290;</p><p>&#29992;&#22914;&#19979;&#26029;&#35328;&#20889;&#20986;&#35821;&#21477;&#30340;&#35268;&#33539;&#65306;
<span class="texMathDisplay"><span class="stt">(result-of </span><span class="texMathInline">stmt</span><span class="stt"> </span><span class="texMathInline">\rho</span><span class="stt"> </span><span class="texMathInline">\sigma_0</span><span class="stt">)</span> = \sigma_0</span></p></blockquote><blockquote class="Hangindent"><p><span style="font-weight: bold">&#20363;&#23376;</span><span class="hspace">&nbsp;</span>&#36825;&#37324;&#26159;&#19968;&#20123;&#20363;&#23376;&#12290;</p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(run "var x,y; {x = 3; y = 4; print +(x,y)}") % &#20363;1</span></p></td></tr><tr><td><p><span class="stt">7</span></p></td></tr><tr><td><p><span class="stt">(run "var x,y,z; {x = 3;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">% &#20363;2</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">y = 4;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">z = 0;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">while not(zero?(x))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{z = +(z,y); x = -(x,1)};</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">print z}")</span></p></td></tr><tr><td><p><span class="stt">12</span></p></td></tr><tr><td><p><span class="stt">(run "var x; {x = 3;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">% &#20363;3</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">print x;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">var x; {x = 4; print x};</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">print x}")</span></p></td></tr><tr><td><p><span class="stt">3</span></p></td></tr><tr><td><p><span class="stt">4</span></p></td></tr><tr><td><p><span class="stt">3</span></p></td></tr><tr><td><p><span class="stt">(run "var f,x; {f = proc(x,y) *(x,y);</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">% &#20363;4</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">x = 3;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">print (f 4 x)}")</span></p></td></tr><tr><td><p><span class="stt">12</span></p></td></tr></table><p>&#20363; 3 &#35299;&#37322;&#20102;&#22359;&#35821;&#21477;&#30340;&#20316;&#29992;&#22495;&#12290;</p><p>&#20363; 4 &#35299;&#37322;&#20102;&#35821;&#21477;&#21644;&#34920;&#36798;&#24335;&#30340;&#20132;&#20114;&#12290;&#36807;&#31243;&#20540;&#21019;&#24314;&#24182;&#23384;&#20648;&#20110;&#21464;&#37327; <span class="stt">f</span>&#12290;&#26368;&#21518;&#19968;&#34892;&#29992;&#23454;&#21442; 4
&#21644; <span class="stt">x</span> &#35843;&#29992;&#36825;&#20010;&#36807;&#31243;&#65307;&#22240;&#20026; <span class="stt">x</span> &#32465;&#23450;&#21040;&#19968;&#20010;&#24341;&#29992;&#65292;&#35299;&#24341;&#29992;&#24471; 3&#12290;</p></blockquote></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..23)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._681))"></a>
&#32473;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#35821;&#35328;&#28155;&#21152; <span class="stt">read</span> &#35821;&#21477;&#65292;&#24418;&#22914; <span class="stt">read </span><span class="texMathInline">var</span>&#12290;&#36825;
&#19968;&#35821;&#21477;&#20174;&#36755;&#20837;&#35835;&#21462;&#19968;&#20010;&#38750;&#36127;&#25968;&#65292;&#23384;&#20837;&#25351;&#23450;&#30340;&#21464;&#37327;&#20013;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..24)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._682))"></a>
<span class="stt">do-while</span> &#35821;&#21477;&#31867;&#20284; <span class="stt">while</span>&#65292;&#20294;&#26159;&#26465;&#20214;&#21028;&#26029;&#22312;&#20854;&#20027;&#20307;<span class="emph">&#20043;&#21518;</span>&#25191;&#34892;&#12290;
&#32473;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#35821;&#35328;&#28155;&#21152; <span class="stt">do-while</span> &#35821;&#21477;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..25)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25193;&#23637;<span class="EoplExerciseRef"></span> &#35821;&#35328;&#20013;&#30340;&#22359;&#35821;&#21477;&#65292;&#20801;&#35768;&#21021;&#22987;&#21270;&#21464;&#37327;&#12290;&#22312;&#20320;&#30340;&#35299;&#31572;&#20013;&#65292;&#21464;&#37327;&#30340;&#20316;
&#29992;&#22495;&#26159;&#21542;&#21253;&#21547;&#21516;&#19968;&#20010;&#22359;&#35821;&#21477;&#20013;&#21518;&#32493;&#22768;&#26126;&#30340;&#21464;&#37327;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..26)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._683))"></a>
<a name="(idx._(gentag._684))"></a>
&#25193;&#23637;&#21069;&#19968;&#36947;&#32451;&#20064;&#20013;&#30340;&#35299;&#31572;&#65292;&#20801;&#35768;&#21516;&#19968;&#22359;&#35821;&#21477;&#20013;&#22768;&#26126;&#30340;&#36807;&#31243;&#20114;&#36882;&#24402;&#12290;&#32771;&#34385;&#32473;&#35821;&#35328;&#22686;&#21152;&#38480;&#21046;&#65292;&#22359;
&#20013;&#30340;&#36807;&#31243;&#22768;&#26126;&#35201;&#22312;&#21464;&#37327;&#22768;&#26126;&#20043;&#21518;&#12290;
<a name="(idx._(gentag._685))"></a>
<a name="(idx._(gentag._686))"></a></p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..27)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._687))"></a>
&#25193;&#23637;&#21069;&#19968;&#36947;&#32451;&#20064;&#20013;&#30340;&#35299;&#31572;&#65292;&#22686;&#21152;<span class="emph">&#23376;&#31243;&#24207;</span> (<span class="emph">subroutine</span>)&#12290;&#25105;&#20204;&#25226;&#23376;&#31243;&#24207;&#24403;&#36807;&#31243;&#29992;&#65292;
&#20294;&#26159;&#23427;&#19981;&#36820;&#22238;&#20540;&#65292;&#19988;&#20854;&#20027;&#20307;&#20026;&#35821;&#21477;&#32780;&#38750;&#34920;&#36798;&#24335;&#12290;&#28982;&#21518;&#22686;&#21152;&#23376;&#31243;&#24207;&#35843;&#29992;&#65292;&#20316;&#20026;&#19968;&#31181;&#26032;&#35821;&#21477;&#12290;&#25193;
&#23637;&#22359;&#30340;&#35821;&#27861;&#65292;&#20801;&#35768;&#21516;&#26102;&#22768;&#26126;&#36807;&#31243;&#21644;&#23376;&#31243;&#24207;&#12290;&#36825;&#23558;&#22914;&#20309;&#24433;&#21709;&#25351;&#20195;&#20540;&#21644;&#34920;&#36798;&#20540;&#65311;&#22914;&#26524;&#22312;&#23376;&#31243;&#24207;&#35843;
&#29992;&#20013;&#20351;&#29992;&#36807;&#31243;&#20250;&#24590;&#26679;&#65311;&#21453;&#36807;&#26469;&#21602;&#65311;
<a name="(idx._(gentag._688))"></a></p></blockquote><h4>4.4<tt>&nbsp;</tt><a name="(part._s4..4)"></a>MUTABLE-PAIRS&#65306;&#21487;&#21464;&#24207;&#23545;&#35821;&#35328;</h4><p><a name="(idx._(gentag._689))"></a>
&#22312;<span class="EoplExerciseRef"></span> &#20013;&#65292;&#25105;&#20204;&#32473;&#35821;&#35328;&#28155;&#21152;&#20102;&#21015;&#34920;&#65292;&#20294;&#23427;&#20204;&#26159;&#19981;&#21487;&#21464;&#30340;&#65306;&#19981;&#20687; Scheme
&#20013;&#65292;&#26377; <span class="stt">set-car!</span> &#21644; <span class="stt">set-cdr!</span> &#22788;&#29702;&#23427;&#20204;&#12290;</p><p>&#29616;&#22312;&#65292;&#25105;&#20204;&#32473; IMPLICIT-REFS &#28155;&#21152;&#21487;&#21464;&#24207;&#23545;&#12290;&#24207;&#23545;&#26159;&#34920;&#36798;&#20540;&#65292;&#20855;&#26377;&#22914;&#19979;&#25805;&#20316;&#65306;</p><p><span class="Iidentity">\begin{align*}<span style="font-weight: bold"><span class="stt">make-pair</span></span>  &amp;: \mathit{Expval} \times \mathit{Expval} \to \mathit{MutPair} \\
<span style="font-weight: bold"><span class="stt">left</span></span> &amp;: \mathit{MutPair} \to \mathit{Expval} \\
<span style="font-weight: bold"><span class="stt">right</span></span>   &amp;: \mathit{MutPair} \to \mathit{Expval} \\
<span style="font-weight: bold"><span class="stt">setleft</span></span>  &amp;: \mathit{MutPair} \times \mathit{Expval} \to \mathit{Unspecified} \\
<span style="font-weight: bold"><span class="stt">setright</span></span>  &amp;: \mathit{MutPair} \times \mathit{Expval} \to \mathit{Unspecified}\end{align*}</span></p><p>&#24207;&#23545;&#21253;&#21547;&#20004;&#20010;&#20301;&#32622;&#65292;&#20108;&#32773;&#21487;&#20197;&#20998;&#21035;&#36171;&#20540;&#12290;&#30001;&#27492;&#24471;&#20986;&#35821;&#35328;&#20540;&#30340;<span class="emph">&#23450;
&#20041;&#22495;&#26041;&#31243;</span> (<span class="emph">domain equations</span>)&#65306;</p><p><span class="Iidentity">\begin{align*}\mathit{ExpVal} &amp;= \mathit{Int} + \mathit{Bool} + \mathit{Proc} + \mathit{MutPair} \\
\mathit{DenVal} &amp;= \mathit{Ref(ExpVal)} \\
\mathit{MutPair} &amp;= \mathit{Ref(ExpVal)} \times \mathit{Ref(ExpVal)}\end{align*}</span></p><p>&#25105;&#20204;&#25226;&#36825;&#31181;&#35821;&#35328;&#21483;&#20570; MUTABLE-PAIRS&#12290;
<a name="(idx._(gentag._690))"></a></p><h5>4.4.1<tt>&nbsp;</tt><a name="(part._s4..4..1)"></a>&#23454;&#29616;</h5><p><a name="(idx._(gentag._691))"></a>
&#25105;&#20204;&#21487;&#20197;&#30452;&#25509;&#29992;&#21069;&#20363;&#20013;&#30340; <span class="stt">reference</span> &#25968;&#25454;&#31867;&#22411;&#23454;&#29616;&#21487;&#21464;&#24207;&#23545;&#12290;
&#20195;&#30721;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;</p><p>&#23436;&#25104;&#22270;&#20013;&#30340;&#20195;&#30721;&#65292;&#32473;&#35821;&#35328;&#28155;&#21152;&#36825;&#20123;&#23601;&#24456;&#30452;&#25509;&#20102;&#12290;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#65292;&#25105;&#20204;&#32473;&#34920;
&#36798;&#20540;&#25968;&#25454;&#31867;&#22411;&#26032;&#22686;&#19968;&#31181;&#21464;&#20307; <span class="stt">mutpair-val</span>&#65292;&#32473; <span class="stt">value-of</span> &#26032;&#22686; 5 &#34892;&#20195;&#30721;&#12290;&#25105;&#20204;
&#35753; <span class="stt">setleft</span> &#36820;&#22238;&#20219;&#24847;&#20540; 82&#65292;&#35753; <span class="stt">setright</span> &#36820;&#22238; 83&#12290;
&#29992;<a href="#%28elem._trace-instrument%29" data-pltdoc="x">&#21069;&#36848;</a>&#36741;&#21161;&#32452;&#20214;&#24471;&#21040;&#30340;&#31034;&#20363;&#36319;&#36394;&#26085;&#24535;
&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#12290;</p><blockquote class="EoplFigure"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-datatype</span><span class="hspace">&nbsp;</span><span class="RktSym">mutpair</span><span class="hspace">&nbsp;</span><span class="RktSym">mutpair?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-pair</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">reference?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">right-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">reference?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">make-pair</span></span> : <span class="texMathInline">\mathit{ExpVal} \times \mathit{ExpVal} \to \mathit{MutPair}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">make-pair</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">val2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-pair</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">left</span></span> : <span class="texMathInline">\mathit{MutPair} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">left</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">mutpair</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-pair</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">right-loc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktSym">left-loc</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">right</span></span> : <span class="texMathInline">\mathit{MutPair} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">right</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">mutpair</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-pair</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">right-loc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktSym">right-loc</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">setleft</span></span> : <span class="texMathInline">\mathit{MutPair} \times \mathit{ExpVal} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">setleft</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">mutpair</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-pair</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">right-loc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="hspace">&nbsp;</span><span class="RktSym">left-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">setright</span></span> : <span class="texMathInline">\mathit{MutPair} \times \mathit{ExpVal} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">setright</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">mutpair</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-pair</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">right-loc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="hspace">&nbsp;</span><span class="RktSym">right-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="caption"><p>&#21487;&#21464;&#24207;&#23545;&#30340;&#25305;&#21155;&#23454;&#29616;<a name="(elem._fig-4..9)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newpair-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">val2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">mutpair-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">make-pair</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">left-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">p1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;mutpair</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">left</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">right-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">p1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;mutpair</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">right</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setleft-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">val2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;mutpair</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">begin</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setleft</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">82</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setright-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">val2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exp2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;mutpair</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">begin</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setright</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">p</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">num-val</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">83</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="caption"><p>&#32473;&#35299;&#37322;&#22120;&#28155;&#21152;&#21487;&#21464;&#24207;&#23545;&#27169;&#22359;<a name="(elem._fig-4..10)"></a></p></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._692))"></a></div></p></blockquote><h5>4.4.2<tt>&nbsp;</tt><a name="(part._s4..4..2)"></a>&#21487;&#21464;&#24207;&#23545;&#30340;&#21478;&#19968;&#31181;&#34920;&#31034;</h5><p>&#25226;&#21487;&#21464;&#24207;&#23545;&#34920;&#31034;&#20026;&#20004;&#20010;&#24341;&#29992;&#27809;&#26377;&#21033;&#29992;&#19982; <span class="stt">MutPair</span> &#30456;&#20851;&#30340;&#24050;&#30693;&#20449;&#24687;&#12290;&#24207;&#23545;&#20013;&#30340;&#20004;&#20010;&#20301;&#32622;
&#34429;&#28982;&#33021;&#22815;&#21508;&#33258;&#36171;&#20540;&#65292;&#20294;&#23427;&#20204;&#19981;&#26159;&#29420;&#31435;&#20998;&#37197;&#30340;&#12290;&#25105;&#20204;&#30693;&#36947;&#23427;&#20204;&#20250;&#19968;&#36215;&#20998;&#37197;&#65306;&#22914;&#26524;&#24207;&#23545;&#30340;&#24038;&#20391;&#26159;
&#19968;&#20010;&#20301;&#32622;&#65292;&#37027;&#20040;&#21491;&#20391;&#26159;&#19979;&#19968;&#20010;&#20301;&#32622;&#12290;&#25152;&#20197;&#25105;&#20204;&#36824;&#21487;&#20197;&#29992;&#24038;&#20391;&#30340;&#24341;&#29992;&#34920;&#31034;&#24207;&#23545;&#12290;
&#20195;&#30721;&#22914;<span class="EoplFigureRef"></span> &#25152;&#31034;&#65292;&#19981;&#38656;&#20877;&#20570;&#20854;&#20182;&#20462;&#25913;&#12290;</p><blockquote class="EoplFigure"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&gt; (run "let glo = pair(11,22)</span></p></td></tr><tr><td><p><span class="stt">in let f = proc (loc)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let d1 = setright(loc, left(loc))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in let d2 = setleft(glo, 99)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in -(left(loc),right(loc))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in (f glo)")</span></p></td></tr><tr><td><p><span class="stt">;; &#20026; init-env &#20998;&#37197;&#21333;&#20803;</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 0</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 1</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 2</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let glo</span></p></td></tr><tr><td><p><span class="stt">;; &#20026;&#24207;&#23545;&#20998;&#37197;&#21333;&#20803;</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 3</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 4</span></p></td></tr><tr><td><p><span class="stt">;; &#20026; glo &#20998;&#37197;&#21333;&#20803;</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 5</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let glo &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((glo 5) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 #(struct:num-val 11))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(4 #(struct:num-val 22))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(5 #(struct:mutpair-val #(struct:a-pair 3 4))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let f</span></p></td></tr><tr><td><p><span class="stt">;; &#20026; f &#20998;&#37197;&#21333;&#20803;</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 6</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let f &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((f 6) (glo 5) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 #(struct:num-val 11))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(4 #(struct:num-val 22))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(5 #(struct:mutpair-val #(struct:a-pair 3 4)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(6 (procedure loc ... ((glo 5) (i 0) (v 1) (x 2)))))</span></p></td></tr></table><blockquote class="caption"><p>MUTABLE-PAIRS&#27714;&#20540;&#30340;&#36319;&#36394;&#26085;&#24535;<a name="(elem._fig-4..11)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">;; &#20026; loc &#20998;&#37197;&#21333;&#20803;</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 7</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; proc loc &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((loc 7) (glo 5) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 #(struct:num-val 11))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(4 #(struct:num-val 22))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(5 #(struct:mutpair-val #(struct:a-pair 3 4)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(6 (procedure loc ... ((glo 5) (i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(7 #(struct:mutpair-val #(struct:a-pair 3 4))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">#(struct:num-val 88)</span></p></td></tr><tr><td><p><span class="stt">&gt;</span></p></td></tr></table><blockquote class="caption"><p>MUTABLE-PAIRS&#27714;&#20540;&#30340;&#36319;&#36394;&#26085;&#24535;&#65292;&#32493;<a name="(elem._fig-4..12)"></a></p></blockquote></blockquote><p>&#19982;&#20043;&#31867;&#20284;&#65292;&#22534;&#20013;&#30340;&#20219;&#20309;&#32858;&#21512;&#23545;&#35937;&#37117;&#21487;&#20197;&#29992;&#20854;&#31532;&#19968;&#20010;&#20301;&#32622;&#30340;&#25351;&#38024;&#34920;&#31034;&#12290;&#20294;&#26159;&#65292;&#22914;&#26524;&#19981;&#25552;&#20379;&#21306;&#22495;
&#30340;&#38271;&#24230;&#20449;&#24687;&#65292;&#25351;&#38024;&#26412;&#36523;&#26080;&#27861;&#25351;&#26126;&#19968;&#29255;&#20869;&#23384;&#21306;&#22495;&#65288;&#35265;<span class="EoplExerciseRef"></span>&#65289;&#12290;&#32570;&#20047;&#38271;&#24230;&#20449;
&#24687;&#26159;&#32463;&#20856;&#23433;&#20840;&#38382;&#39064;&#30340;&#19968;&#22823;&#26469;&#28304;&#65292;&#27604;&#22914;&#20889;&#25968;&#32452;&#36234;&#30028;&#12290;</p><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">mutpair?</span></span> : <span class="texMathInline">\mathit{SchemeVal} \to \mathit{Bool}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">mutpair?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reference?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">make-pair</span></span> : <span class="texMathInline">\mathit{ExpVal} \times \mathit{ExpVal} \to \mathit{MutPair}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">make-pair</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="hspace">&nbsp;</span><span class="RktSym">val2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">ref1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">ref2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktSym">val2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">ref1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">left</span></span> : <span class="texMathInline">\mathit{MutPair} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">right</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">right</span></span> : <span class="texMathInline">\mathit{MutPair} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">left</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">setleft</span></span> : <span class="texMathInline">\mathit{MutPair} \times \mathit{ExpVal} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">setright</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span style="font-weight: bold"><span class="stt">setright</span></span> : <span class="texMathInline">\mathit{MutPair} \times \mathit{ExpVal} \to \mathit{Unspecified}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">setright</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="caption"><p>&#21487;&#21464;&#24207;&#23545;&#30340;&#21478;&#19968;&#31181;&#34920;&#31034;
<a name="(idx._(gentag._693))"></a><a name="(elem._fig-4..13)"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._694))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex4..28)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986;&#20116;&#20010;&#21487;&#21464;&#24207;&#23545;&#25805;&#20316;&#30340;&#25512;&#29702;&#35268;&#21017;&#35268;&#33539;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..29)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._695))"></a>
&#32473;&#35821;&#35328;&#28155;&#21152;&#25968;&#32452;&#12290;&#28155;&#21152;&#26032;&#25805;&#20316;&#31526; <span class="stt">newarray</span>&#12289;<span class="stt">arrayref</span> &#21644; <span class="stt">arrayset</span>&#65292;&#29992;&#23427;
&#20204;&#26469;&#21019;&#24314;&#12289;&#35299;&#24341;&#29992;&#21644;&#26356;&#26032;&#25968;&#32452;&#12290;&#36825;&#38656;&#35201;&#65306;</p><p><span class="Iidentity">\begin{align*}\mathit{ArrVal} &amp;= \mathit{(Ref(ExpVal))} \\
\mathit{ExpVal} &amp;= \mathit{Int} + \mathit{Bool} + \mathit{Proc} + \mathit{ArrVal} \\
\mathit{DenVal} &amp;= \mathit{Ref(ExpVal)}\end{align*}</span></p><p>&#30001;&#20110;&#25968;&#32452;&#20013;&#30340;&#20301;&#32622;&#26159;&#36830;&#32493;&#30340;&#65292;&#29992;&#19978;&#36848;&#31532;&#20108;&#31181;&#34920;&#31034;&#12290;&#19979;&#38754;&#31243;&#24207;&#30340;&#32467;&#26524;&#26159;&#20160;&#20040;&#65311;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let a = newarray(2,-99)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">p = proc (x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let v = arrayref(x,1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in arrayset(x,1,-(v,-1))</span></p></td></tr><tr><td><p><span class="stt">in begin arrayset(a,1,0); (p a); (p a); arrayref(a,1) end</span></p></td></tr></table></blockquote><p>&#36825;&#37324; <span class="stt">newarray(2,-99)</span> &#35201;&#21019;&#24314;&#38271;&#24230;&#20026; 2 &#30340;&#25968;&#32452;&#65292;&#25968;&#32452;&#20013;&#30340;&#27599;&#20010;&#20301;&#32622;&#37117;&#21253;&#21547; -99&#12290;
<span class="stt">begin</span> &#34920;&#36798;&#24335;&#23450;&#20041;&#21516;<span class="EoplExerciseRef"></span>&#12290;&#20196;&#25968;&#32452;&#32034;&#24341;&#20174; 0 &#24320;&#22987;&#65292;&#25152;&#20197;&#38271;&#24230;&#20026; 2
&#30340;&#25968;&#32452;&#32034;&#24341;&#20026; 0 &#21644; 1&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..30)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._696))"></a>
&#32473;<span class="EoplExerciseRef"></span> &#30340;&#35821;&#35328;&#28155;&#21152;&#36807;&#31243; <span class="stt">arraylength</span>&#65292;&#36820;&#22238;&#25968;&#32452;&#30340;&#38271;&#24230;&#12290;&#20320;&#30340;&#36807;
&#31243;&#36816;&#34892;&#26102;&#38388;&#24212;&#20026;&#24120;&#25968;&#12290;<span class="stt">arrayref</span> &#21644; <span class="stt">arrayset</span> &#19968;&#23450;&#35201;&#26597;&#39564;&#32034;&#24341;&#65292;&#30830;&#20445;&#32034;&#24341;&#20540;&#22312;
&#25968;&#32452;&#38271;&#24230;&#20043;&#20869;&#12290;</p></blockquote><h4>4.5<tt>&nbsp;</tt><a name="(part._s4..5)"></a>&#20256;&#21442;&#21464;&#20307;</h4><p>&#24403;&#36807;&#31243;&#20027;&#20307;&#25191;&#34892;&#26102;&#65292;&#20854;&#24418;&#21442;&#32465;&#23450;&#21040;&#19968;&#20010;&#25351;&#20195;&#20540;&#12290;&#37027;&#20010;&#20540;&#20174;&#21738;&#20799;&#26469;&#65311;&#23427;&#19968;&#23450;&#26159;&#36807;&#31243;&#35843;&#29992;&#20256;&#20837;&#23454;
&#21442;&#30340;&#20540;&#12290;&#25105;&#20204;&#24050;&#35265;&#36807;&#20004;&#31181;&#20256;&#21442;&#26041;&#24335;&#65306;</p><ul><li><p>&#33258;&#28982;&#20256;&#21442;&#65292;&#25351;&#20195;&#20540;&#19982;&#23454;&#21442;&#30340;&#34920;&#36798;&#20540;&#30456;&#21516;&#65288;<span class="stt">pass-by-value</span>&#65289;&#12290;</p></li><li><p>&#25353;&#20540;&#35843;&#29992;&#65292;&#25351;&#20195;&#20540;&#26159;&#19968;&#20010;&#24341;&#29992;&#65292;&#25351;&#21521;&#19968;&#20010;&#20301;&#32622;&#65292;&#35813;&#20301;&#32622;&#21253;&#21547;&#23454;&#21442;&#30340;&#34920;&#36798;&#20540;
&#65288;<a href="#%28part._s4..3%29" data-pltdoc="x">IMPLICIT-REFS&#65306;&#38544;&#24335;&#24341;&#29992;&#35821;&#35328;</a>&#65289;&#12290;&#36825;&#26159;&#26368;&#24120;&#29992;&#30340;&#20256;&#21442;&#26041;&#24335;&#12290;
<a name="(idx._(gentag._697))"></a></p></li></ul><p>&#26412;&#33410;&#25506;&#35752;&#20854;&#20182;&#19968;&#20123;&#20256;&#21442;&#26426;&#21046;&#12290;</p><h5>4.5.1<tt>&nbsp;</tt><a name="(part._s4..5..1)"></a>&#25353;&#25351;&#35843;&#29992;</h5><p><a name="(idx._(gentag._698))"></a>
<a name="(idx._(gentag._699))"></a>
&#32771;&#34385;&#19979;&#38754;&#30340;&#34920;&#36798;&#24335;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let p = proc (x) set x = 4</span></p></td></tr><tr><td><p><span class="stt">in let a = 3</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin (p a); a end</span></p></td></tr></table></blockquote><p>&#25353;&#20540;&#35843;&#29992;&#26102;&#65292;&#32465;&#23450;&#21040; <span class="stt">x</span> &#30340;&#25351;&#20195;&#20540;&#26159;&#19968;&#20010;&#24341;&#29992;&#65292;&#23427;&#21253;&#21547;&#30340;&#21021;&#22987;&#20540;&#19982;&#32465;&#23450;&#21040; <span class="stt">a</span> &#30340;&#24341;
&#29992;&#30456;&#21516;&#65292;&#20294;&#36825;&#20123;&#24341;&#29992;&#20114;&#19981;&#30456;&#24178;&#12290;&#25152;&#20197;&#36171;&#20540;&#32473; <span class="stt">x</span> &#19981;&#20250;&#24433;&#21709;&#24341;&#29992; <span class="stt">a</span> &#30340;&#20869;&#23481;&#65292;&#25972;&#20010;&#34920;
&#36798;&#24335;&#30340;&#20540;&#26159; 3&#12290;</p></blockquote><p>&#25353;&#20540;&#35843;&#29992;&#26102;&#65292;&#24403;&#36807;&#31243;&#32473;&#26576;&#20010;&#21442;&#25968;&#36171;&#26032;&#20540;&#65292;&#35843;&#29992;&#32773;&#26080;&#27861;&#33719;&#24713;&#12290;&#24403;&#28982;&#65292;&#22914;&#26524;&#20256;&#32473;&#35843;&#29992;&#32773;&#30340;&#21442;&#25968;&#20687;
<a href="#%28part._s4..4%29" data-pltdoc="x">MUTABLE-PAIRS&#65306;&#21487;&#21464;&#24207;&#23545;&#35821;&#35328;</a>&#37027;&#26679;&#21253;&#21547;&#21487;&#21464;&#24207;&#23545;&#65292;&#37027;&#20040;&#35843;&#29992;&#32773;&#33021;&#30475;&#21040; <span class="stt">setleft</span> &#21644; <span class="stt">setright</span> &#30340;
&#25928;&#26524;&#65292;&#20294;&#30475;&#19981;&#21040; <span class="stt">set</span> &#30340;&#25928;&#26524;&#12290;</p><p>&#34429;&#28982;&#36825;&#26679;&#38548;&#31163;&#35843;&#29992;&#32773;&#21644;&#34987;&#35843;&#32773;&#24120;&#21512;&#25152;&#24895;&#65292;&#20294;&#26377;&#20123;&#26102;&#20505;&#65292;&#32473;&#36807;&#31243;&#20256;&#36882;&#19968;&#20010;&#20301;&#32622;&#65292;&#24182;&#35753;&#36807;&#31243;&#32473;&#36825;
&#20010;&#20301;&#32622;&#36171;&#20540;&#20063;&#19981;&#26080;&#22909;&#22788;&#12290;&#35201;&#36825;&#26679;&#20570;&#65292;&#21487;&#20197;&#32473;&#36807;&#31243;&#20256;&#36882;&#19968;&#20010;&#24341;&#29992;&#65292;&#35813;&#24341;&#29992;&#25351;&#21521;&#35843;&#29992;&#32773;&#21464;&#37327;&#30340;&#20301;
&#32622;&#65292;&#32780;&#19981;&#26159;&#21464;&#37327;&#30340;&#20869;&#23481;&#12290;&#36825;&#31181;&#20256;&#21442;&#26426;&#21046;&#21483;&#20570;<span class="emph">&#25353;&#25351;&#35843;&#29992;</span> (<span class="emph">call-by-reference</span>)&#12290;&#22914;&#26524;
&#25805;&#20316;&#25968;&#27491;&#26159;&#21464;&#37327;&#24341;&#29992;&#65292;&#37027;&#23601;&#20256;&#36882;&#21464;&#37327;&#20301;&#32622;&#30340;&#24341;&#29992;&#12290;&#28982;&#21518;&#65292;&#36807;&#31243;&#30340;&#24418;&#21442;&#32465;&#23450;&#21040;&#36825;&#20010;&#20301;&#32622;&#12290;&#22914;&#26524;
&#25805;&#20316;&#25968;&#26159;&#20854;&#20182;&#31867;&#22411;&#30340;&#34920;&#36798;&#24335;&#65292;&#37027;&#20040;&#24418;&#21442;&#32465;&#23450;&#21040;&#19968;&#20010;&#26032;&#20301;&#32622;&#65292;&#35813;&#20301;&#32622;&#21253;&#21547;&#25805;&#20316;&#25968;&#30340;&#20540;&#65292;&#23601;&#20687;&#25353;
&#20540;&#35843;&#29992;&#19968;&#26679;&#12290;&#22312;&#19978;&#20363;&#20013;&#20351;&#29992;&#25353;&#25351;&#35843;&#29992;&#65292;&#25226; 4 &#36171;&#32473; <span class="stt">x</span> &#31561;&#25928;&#20110;&#25226; 4 &#36171;&#32473; <span class="stt">a</span>&#65292;&#25152;&#20197;
&#25972;&#20010;&#34920;&#36798;&#24335;&#36820;&#22238; 4&#65292;&#32780;&#19981;&#26159; 3&#12290;</p><p>&#25353;&#25351;&#35843;&#29992;&#36807;&#31243;&#65292;&#19988;&#23454;&#21442;&#20026;&#21464;&#37327;&#26102;&#65292;&#20256;&#36882;&#30340;&#19981;&#26159;&#25353;&#20540;&#35843;&#29992;&#20013;&#21464;&#37327;&#25152;&#22312;&#20301;&#32622;&#30340;&#20869;&#23481;&#65292;&#32780;&#26159;&#37027;&#20010;&#21464;
&#37327;&#30340;<span class="emph">&#20301;&#32622;</span>&#12290;&#20363;&#22914;&#65292;&#32771;&#34385;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let p = proc (x) set x = 44</span></p></td></tr><tr><td><p><span class="stt">in let g = proc (y) (f y)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let z = 55</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin (g z); z end</span></p></td></tr></table></blockquote><p>&#35843;&#29992;&#36807;&#31243; <span class="stt">g</span> &#26102;&#65292;<span class="stt">y</span> &#32465;&#23450;&#21040; <span class="stt">z</span> &#30340;&#20301;&#32622;&#65292;&#32780;&#19981;&#26159;&#37027;&#20010;&#20301;&#32622;&#30340;&#20869;&#23481;&#12290;&#31867;&#20284;&#22320;&#65292;
&#35843;&#29992; <span class="stt">f</span> &#26102;&#65292;<span class="stt">x</span> &#32465;&#23450;&#21040;&#21516;&#19968;&#20010;&#20301;&#32622;&#12290;&#25152;&#20197;&#65292;<span class="stt">x</span>&#12289;<span class="stt">y</span> &#21644; <span class="stt">z</span> &#37117;&#32465;&#23450;&#21040;
&#21516;&#19968;&#20301;&#32622;&#65292;<span class="stt">set x = 44</span> &#30340;&#25928;&#26524;&#26159;&#25226;&#37027;&#20010;&#20301;&#32622;&#30340;&#20869;&#23481;&#35774;&#20026; 44&#12290;&#22240;&#27492;&#65292;&#25972;&#20010;&#34920;&#36798;&#24335;&#30340;&#20540;
&#26159; 44&#12290;&#25191;&#34892;&#36825;&#20010;&#34920;&#36798;&#24335;&#30340;&#36319;&#36394;&#26085;&#24535;&#22914;<span class="EoplFigureRef"></span> &#21644; <span class="stt">fig-4.15</span> &#25152;
&#31034;&#12290;&#22312;&#26412;&#20363;&#20013;&#65292;<span class="stt">x</span>&#12289;<span class="stt">y</span> &#21644; <span class="stt">z</span> &#26368;&#32456;&#37117;&#32465;&#23450;&#21040;&#20301;&#32622; 5&#12290;</p></blockquote><p>&#25353;&#25351;&#35843;&#29992;&#30340;&#24120;&#35265;&#29992;&#27861;&#26159;&#36820;&#22238;&#22810;&#20010;&#20540;&#12290;&#36807;&#31243;&#20197;&#36890;&#24120;&#26041;&#24335;&#36820;&#22238;&#19968;&#20010;&#20540;&#65292;&#24182;&#32473;&#25353;&#25351;&#20256;&#36882;&#30340;&#21442;&#25968;&#36171;&#20854;
&#20182;&#20540;&#12290;&#21478;&#19968;&#31181;&#20363;&#23376;&#65292;&#23545;&#25442;&#21464;&#37327;&#30340;&#20540;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let swap = proc (x) proc (y)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let temp = x</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set x = y;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set y = temp</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt">in let a = 33</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let b = 44</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">((swap a) b);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">-(a,b)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr></table></blockquote><p>&#37319;&#29992;&#25353;&#25351;&#35843;&#29992;&#65292;&#36825;&#20250;&#23545;&#25442; <span class="stt">a</span> &#21644; <span class="stt">b</span> &#30340;&#20540;&#65292;&#25152;&#20197;&#23427;&#36820;&#22238; 11&#12290;&#20294;&#22914;&#26524;&#29992;&#24050;&#26377;&#30340;&#25353;&#20540;
&#35843;&#29992;&#35299;&#37322;&#22120;&#25191;&#34892;&#36825;&#20010;&#31243;&#24207;&#65292;&#23427;&#20250;&#36820;&#22238; -11&#65292;&#22240;&#20026;&#22312;&#23545;&#25442;&#36807;&#31243;&#30340;&#20869;&#37096;&#36171;&#20540;&#23545;&#21464;&#37327; <span class="stt">a</span> &#21644;
<span class="stt">b</span> &#27627;&#26080;&#24433;&#21709;&#12290;</p></blockquote><p>&#23601;&#20687;&#22312;&#25353;&#20540;&#35843;&#29992;&#20013;&#19968;&#26679;&#65292;&#22312;&#25353;&#25351;&#35843;&#29992;&#20013;&#65292;&#21464;&#37327;&#20173;&#28982;&#25351;&#20195;&#34920;&#36798;&#20540;&#30340;&#24341;&#29992;&#65306;</p><p><span class="Iidentity">\begin{align*}\mathit{ExpVal} &amp;= \mathit{Int} + \mathit{Bool} + \mathit{Proc} \\
\mathit{DenVal} &amp;= \mathit{Ref(ExpVal)}\end{align*}</span></p><p>&#21807;&#19968;&#38656;&#35201;&#25913;&#21464;&#30340;&#26159;&#26032;&#20301;&#32622;&#30340;&#20998;&#37197;&#12290;&#25353;&#20540;&#35843;&#29992;&#20013;&#65292;&#27714;&#27599;&#20010;&#25805;&#20316;&#25968;&#30340;&#20540;&#37117;&#35201;&#20998;&#37197;&#26032;&#20301;&#32622;&#65307;&#25353;&#25351;&#35843;
&#29992;&#20013;&#65292;&#21482;&#22312;&#27714;<span class="emph">&#38750;&#21464;&#37327;</span>&#25805;&#20316;&#25968;&#30340;&#20540;&#26102;&#25165;&#20998;&#37197;&#26032;&#20301;&#32622;&#12290;</p><p>&#36825;&#24456;&#23481;&#26131;&#23454;&#29616;&#12290;&#20989;&#25968; <span class="stt">apply-procedure</span> &#24517;&#38656;&#20462;&#25913;&#65292;&#22240;&#20026;&#19981;&#26159;&#27599;&#20010;&#36807;&#31243;&#35843;&#29992;&#37117;&#35201;&#20998;&#37197;&#26032;
&#20301;&#32622;&#12290;&#37027;&#20221;&#36131;&#20219;&#24517;&#39035;&#19978;&#31227;&#33267; <span class="stt">value-of</span> &#20013;&#30340; <span class="stt">call-exp</span> &#65292;&#22240;&#20026;&#23427;&#25165;&#20855;&#26377;&#20570;&#20986;&#21028;&#26029;
&#25152;&#38656;&#30340;&#20449;&#24687;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">apply-procedure</span></span> : <span class="texMathInline">\mathit{Proc} \times \mathit{ExpVal} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">apply-procedure</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">proc1</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">proc1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">procedure</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extend-env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#28982;&#21518;&#25105;&#20204;&#20462;&#25913; <span class="stt">value-of</span> &#20013;&#30340; <span class="stt">call-exp</span>&#65292;&#24341;&#20837;&#26032;&#20989;&#25968; <span class="stt">value-of-operand</span>
&#26469;&#20570;&#24517;&#35201;&#30340;&#21028;&#26029;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">call-exp</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">rator</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rand</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">proc</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval-&gt;proc</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rator</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of-operand</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rand</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-procedure</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">proc</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">arg</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#36807;&#31243; <span class="stt">value-of-operand</span> &#26816;&#26597;&#25805;&#20316;&#25968;&#26159;&#21542;&#20026;&#21464;&#37327;&#12290;&#22914;&#26524;&#26159;&#65292;&#21017;&#36820;&#22238;&#37027;&#20010;&#21464;&#37327;&#25351;&#20195;&#30340;&#24341;
&#29992;&#65292;&#28982;&#21518;&#20256;&#32473;&#36807;&#31243; <span class="stt">apply-procedure</span>&#65307;&#21542;&#21017;&#65292;&#23427;&#27714;&#20986;&#25805;&#20316;&#25968;&#30340;&#20540;&#65292;&#22312;&#26032;&#20301;&#32622;&#25918;&#20837;&#37027;&#20010;
&#20540;&#65292;&#24182;&#36820;&#22238;&#25351;&#21521;&#35813;&#20301;&#32622;&#30340;&#24341;&#29992;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of-operand</span></span> : <span class="texMathInline">\mathit{Exp} \times \mathit{Env} \to \mathit{Ref}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-operand</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#25105;&#20204;&#20063;&#21487;&#20197;&#25353;&#29031;&#21516;&#26679;&#30340;&#26041;&#24335;&#20462;&#25913; <span class="stt">let</span>&#65292;&#20294;&#25105;&#20204;&#19981;&#36825;&#26679;&#20570;&#65292;&#22240;&#27492;&#35821;&#35328;&#20013;&#20173;&#28982;&#20445;&#30041;&#25353;&#20540;&#35843;
&#29992;&#30340;&#21151;&#33021;&#12290;</p><p>&#22810;&#20010;&#25353;&#25351;&#35843;&#29992;&#21442;&#25968;&#21487;&#20197;&#25351;&#21521;&#21516;&#19968;&#20010;&#20301;&#32622;&#65292;&#22914;&#19979;&#38754;&#30340;&#31243;&#24207;&#25152;&#31034;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let b = 3</span></p></td></tr><tr><td><p><span class="stt">in let p = proc (x) proc(y)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">set x = 4;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">y</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in ((p b) b)</span></p></td></tr></table></blockquote><p>&#23427;&#30340;&#20540;&#20026; 4&#65292;&#22240;&#20026; <span class="stt">x</span> &#21644; <span class="stt">y</span> &#25351;&#21521;&#21516;&#19968;&#20010;&#20301;&#32622;&#65292;&#21363; <span class="stt">b</span> &#30340;&#32465;&#23450;&#12290;&#36825;&#31181;&#29616;&#35937;&#21483;
&#20570;<a name="(idx._(gentag._700))"></a><span class="emph">&#21464;&#37327;&#21035;&#21517;</span> (<span class="emph">variable aliasing</span>)&#12290;&#36825;&#37324;&#30340; <span class="stt">x</span> &#21644;
<a name="(idx._(gentag._701))"></a>
<span class="stt">y</span> &#26159;&#21516;&#19968;&#20010;&#20301;&#32622;&#30340;&#21035;&#21517;&#65288;&#21517;&#23383;&#65289;&#12290;&#36890;&#24120;&#65292;&#25105;&#20204;&#22312;&#32473;&#19968;&#20010;&#21464;&#37327;&#36171;&#20540;&#26102;&#24182;&#19981;&#24819;&#25913;&#21464;&#21478;&#19968;&#20010;
&#21464;&#37327;&#30340;&#20540;&#65292;&#25152;&#20197;&#21035;&#21517;&#20250;&#23548;&#33268;&#31243;&#24207;&#38590;&#20197;&#29702;&#35299;&#12290;</p></blockquote><blockquote class="EoplFigure"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&gt; (run "</span></p></td></tr><tr><td><p><span class="stt">let f = proc (x) set x = 44</span></p></td></tr><tr><td><p><span class="stt">in let g = proc (y) (f y)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let z = 55</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(g z);</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">z</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end")</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 0</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 1</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 2</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let f</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 3</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let f &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((f 3) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 (procedure x ... ((i 0) (v 1) (x 2)))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let g</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 4</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let g &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((g 4) (f 3) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt">(3 (procedure x ... ((i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt">(4 (procedure y ... ((f 3) (i 0) (v 1) (x 2)))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let z</span></p></td></tr><tr><td><p><span class="stt">newref: &#20998;&#37197;&#20301;&#32622; 5</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; let z &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((z 5) (g 4) (f 3) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 (procedure x ... ((i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(4 (procedure y ... ((f 3) (i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(5 #(struct:num-val 55)))</span></p></td></tr></table><blockquote class="caption"><p>CALL-BY-REFERENCE &#30340;&#31616;&#21333;&#27714;&#20540;<a name="(elem._fig-4..14)"></a></p></blockquote></blockquote><blockquote class="EoplFigure"><p><div class="SIntrapara">[!ht]</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; proc y &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((y 5) (f 3) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 (procedure x ... ((i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(4 (procedure y ... ((f 3) (i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(5 #(struct:num-val 55)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">&#36827;&#20837; proc x &#20027;&#20307;&#65292;&#29615;&#22659; =</span></p></td></tr><tr><td><p><span class="stt">((x 5) (i 0) (v 1) (x 2))</span></p></td></tr><tr><td><p><span class="stt">&#23384;&#20648;&#22120; =</span></p></td></tr><tr><td><p><span class="stt">((0 #(struct:num-val 1))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 #(struct:num-val 5))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(2 #(struct:num-val 10))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(3 (procedure x ... ((i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(4 (procedure y ... ((f 3) (i 0) (v 1) (x 2))))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(5 #(struct:num-val 55)))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">#(struct:num-val 44)</span></p></td></tr><tr><td><p><span class="stt">&gt;</span></p></td></tr></table></div></p><blockquote class="caption"><p>CALL-BY-REFERENCE &#30340;&#31616;&#21333;&#27714;&#20540;&#65292;&#32493;<a name="(elem._fig-4..15)"></a></p></blockquote></blockquote><p><a name="(idx._(gentag._702))"></a>
<a name="(idx._(gentag._703))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex4..31)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986; CALL-BY-REFERENCE &#30340;&#25512;&#29702;&#35268;&#21017;&#35268;&#33539;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..32)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25193;&#23637;&#35821;&#35328; CALL-BY-REFERENCE&#65292;&#25903;&#25345;&#22810;&#21442;&#25968;&#36807;&#31243;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..33)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#25193;&#23637;&#35821;&#35328; CALL-BY-REFERENCE&#65292;&#20063;&#20196;&#20854;&#25903;&#25345;&#25353;&#20540;&#35843;&#29992;&#30340;&#36807;&#31243;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..34)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;&#35821;&#35328;&#28155;&#21152;&#25353;&#25351;&#35843;&#29992;&#30340; <span class="stt">let</span>&#65292;&#21517;&#20026; <span class="stt">letref</span>&#12290;&#20889;&#20986;&#35268;&#33539;&#24182;&#23454;&#29616;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..35)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#22312;&#25353;&#20540;&#35843;&#29992;&#26694;&#26550;&#19979;&#65292;&#25105;&#20204;&#20173;&#33021;&#20139;&#21463;&#25353;&#25351;&#35843;&#29992;&#30340;&#20415;&#21033;&#12290;&#25193;&#23637;&#35821;&#35328; IMPLICIT-REF&#65292;&#28155;&#21152;&#26032;&#34920;&#36798;
&#24335;&#65306;</p><p><span class="Iidentity">\begin{align*}\mathit{Expression} &amp;::= <span class="stt">ref </span><span class="Iidentity">\mathit{Identifier}</span> \\[-3pt]
  &amp;\mathrel{\phantom{::=}} \fbox{<span class="stt">ref-exp (var)</span>}\end{align*}</span></p><p>&#36825;&#19982;&#35821;&#35328; EXPLICIT-REF &#19981;&#21516;&#12290;&#22240;&#20026;&#24341;&#29992;&#21482;&#33021;&#20174;&#21464;&#37327;&#33719;&#24471;&#12290;&#36825;&#23601;&#20351;&#25105;&#20204;&#33021;&#29992;&#25353;&#20540;&#35843;&#29992;&#35821;&#35328;&#20889;
&#20986;&#31867;&#20284; <span class="stt">swap</span> &#30340;&#31243;&#24207;&#12290;&#19979;&#38754;&#34920;&#36798;&#24335;&#30340;&#20540;&#26159;&#20160;&#20040;&#65311;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let a = 3</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">b = 4</span></p></td></tr><tr><td><p><span class="stt">in let swap = proc (x) proc (y)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let temp = deref(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">setref(x,deref(y));</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">setref(y,temp)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in begin ((swap ref a) ref b); -(a,b) end</span></p></td></tr></table></blockquote><p>&#27492;&#22788;&#20351;&#29992;&#25903;&#25345;&#22810;&#22768;&#26126;&#30340; <span class="stt">let</span>&#65288;<span class="EoplExerciseRef"></span>&#65289;&#12290;&#36825;&#31181;&#35821;&#35328;&#30340;&#34920;&#36798;&#20540;&#21644;&#25351;&#20195;&#20540;
&#26159;&#20160;&#20040;&#65311;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..36)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._704))"></a>
&#22823;&#22810;&#25968;&#35821;&#35328;&#25903;&#25345;&#25968;&#32452;&#65292;&#22312;&#25353;&#25351;&#35843;&#29992;&#20013;&#65292;&#25968;&#32452;&#24341;&#29992;&#36890;&#24120;&#20197;&#31867;&#20284;&#21464;&#37327;&#24341;&#29992;&#30340;&#26041;&#24335;&#22788;&#29702;&#12290;&#22914;&#26524;&#25805;&#20316;
&#25968;&#26159;&#25968;&#32452;&#24341;&#29992;&#65292;&#37027;&#23601;&#19981;&#32473;&#34987;&#35843;&#36807;&#31243;&#20256;&#36882;&#23427;&#30340;&#20869;&#23481;&#65292;&#32780;&#26159;&#20256;&#36882;&#24341;&#29992;&#25351;&#21521;&#30340;&#20301;&#32622;&#12290;&#27604;&#22914;&#65292;&#38656;&#35201;&#35843;
&#29992;&#23545;&#25442;&#36807;&#31243;&#30340;&#24120;&#35265;&#24773;&#24418;&#26159;&#20132;&#25442;&#25968;&#32452;&#20803;&#32032;&#65292;&#20256;&#36882;&#25968;&#32452;&#24341;&#29992;&#23601;&#33021;&#29992;&#19978;&#23545;&#25442;&#36807;&#31243;&#12290;&#32473;&#25353;&#25351;&#35843;&#29992;&#35821;&#35328;
&#28155;&#21152;<span class="EoplExerciseRef"></span> &#20013;&#30340;&#25968;&#32452;&#25805;&#20316;&#31526;&#65292;&#25193;&#23637; <span class="stt">value-of-operand</span>&#65292;&#22788;&#29702;&#36825;&#31181;&#24773;
&#20917;&#65292;&#20351;&#19979;&#20363;&#20013;&#30340;&#36807;&#31243;&#35843;&#29992;&#33021;&#22815;&#22914;&#24895;&#25191;&#34892;&#65306;</p><blockquote class="SCentered"><p><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">swap</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">arrayref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">a</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">arrayref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">a</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">j</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></p></blockquote><p>&#35201;&#26159;&#19979;&#38754;&#36825;&#26679;&#21602;&#65311;</p><blockquote class="SCentered"><p><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">swap</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">arrayref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">a</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">arrayref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">a</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">arrayref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">a</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">j</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></p></blockquote></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..37)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span><a name="(idx._(gentag._705))"></a>
<span class="emph">&#25353;&#20540;&#21644;&#32467;&#26524;&#35843;&#29992;</span> (<span class="emph">call-by-value-result</span>) &#26159;&#25353;&#25351;&#35843;&#29992;&#30340;&#19968;&#31181;&#21464;&#20307;&#12290;&#22312;&#25353;&#20540;&#21644;&#32467;&#26524;
&#35843;&#29992;&#20013;&#65292;&#23454;&#21442;&#24517;&#38656;&#26159;&#21464;&#37327;&#12290;&#20256;&#36882;&#21442;&#25968;&#26102;&#65292;&#24418;&#21442;&#32465;&#23450;&#21040;&#26032;&#30340;&#24341;&#29992;&#65292;&#21021;&#20540;&#20026;&#23454;&#21442;&#30340;&#20540;&#65292;&#23601;&#20687;&#25353;&#20540;
&#35843;&#29992;&#19968;&#26679;&#12290;&#28982;&#21518;&#36807;&#31243;&#20027;&#20307;&#29031;&#24120;&#25191;&#34892;&#12290;&#20294;&#36807;&#31243;&#20027;&#20307;&#36820;&#22238;&#26102;&#65292;&#26032;&#24341;&#29992;&#22788;&#30340;&#20540;&#22797;&#21046;&#21040;&#23454;&#21442;&#25351;&#20195;&#30340;&#24341;
&#29992;&#20013;&#12290;&#22240;&#20026;&#36825;&#26679;&#21487;&#20197;&#25913;&#36827;&#20869;&#23384;&#20998;&#37197;&#65292;&#25152;&#20197;&#21487;&#33021;&#27604;&#25353;&#25351;&#35843;&#29992;&#26356;&#39640;&#25928;&#12290;&#23454;&#29616;&#25353;&#20540;&#21644;&#32467;&#26524;&#35843;&#29992;&#65292;&#20889;
&#20986;&#19968;&#20010;&#36807;&#31243;&#65292;&#20351;&#20043;&#22312;&#25353;&#25351;&#35843;&#29992;&#19982;&#25353;&#20540;&#21644;&#32467;&#26524;&#35843;&#29992;&#20013;&#20135;&#29983;&#19981;&#21516;&#30340;&#31572;&#26696;&#12290;
<a name="(idx._(gentag._706))"></a></p></blockquote><h5>4.5.2<tt>&nbsp;</tt><a name="(part._s4..5..2)"></a>&#25042;&#27714;&#20540;&#65306;&#25353;&#21517;&#35843;&#29992;&#21644;&#25353;&#38656;&#35843;&#29992;</h5><p><a name="(idx._(gentag._707))"></a>
<a name="(idx._(gentag._708))"></a>
<a name="(idx._(gentag._709))"></a>
&#36804;&#20170;&#20026;&#27490;&#65292;&#25105;&#20204;&#35752;&#35770;&#30340;&#25152;&#26377;&#21442;&#25968;&#20256;&#36882;&#26426;&#21046;&#37117;&#26159;<span class="emph">&#21363;&#26102;</span> (<span class="emph">eager</span>)&#30340;&#65306;&#23427;&#20204;&#24635;&#26159;&#25214;&#20986;&#27599;&#20010;
&#25805;&#20316;&#25968;&#30340;&#20540;&#12290;&#29616;&#22312;&#25105;&#20204;&#26469;&#30475;&#21478;&#19968;&#31181;&#25130;&#28982;&#19981;&#21516;&#30340;&#20256;&#21442;&#26426;&#21046;&#65292;&#21517;&#21483;<span class="emph">&#25042;&#27714;&#20540;</span> (<span class="emph">lazy
evaluation</span>)&#12290;&#22312;&#25042;&#27714;&#20540;&#20013;&#65292;&#25805;&#20316;&#25968;&#30340;&#20540;&#30452;&#21040;&#36807;&#31243;&#20027;&#20307;&#38656;&#35201;&#26102;&#25165;&#20250;&#27714;&#21462;&#12290;&#22914;&#26524;&#36807;&#31243;
&#20027;&#20307;&#20174;&#26410;&#24341;&#29992;&#30456;&#20851;&#21442;&#25968;&#65292;&#23601;&#19981;&#38656;&#27714;&#25805;&#20316;&#25968;&#30340;&#20540;&#12290;</p><p>&#36825;&#21487;&#33021;&#20351;&#31243;&#24207;&#20813;&#20110;&#27704;&#19981;&#32456;&#27490;&#12290;&#20363;&#22914;&#65292;&#32771;&#34385;&#65306;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">letrec infinite-loop (x) = infinite-loop(-(x,-1))</span></p></td></tr><tr><td><p><span class="stt">in let f = proc (z) 11</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in (f (infinite-loop 0))</span></p></td></tr></table></blockquote><p>&#36825;&#37324;&#30340; <span class="stt">infinite-loop</span> &#26159;&#19968;&#20010;&#36807;&#31243;&#65292;&#35843;&#29992;&#26102;&#27704;&#19981;&#32456;&#27490;&#12290;<span class="stt">f</span> &#26159;&#19968;&#20010;&#36807;&#31243;&#65292;&#35843;&#29992;&#26102;
&#19981;&#24341;&#29992;&#23427;&#30340;&#21442;&#25968;&#65292;&#24635;&#36820;&#22238; 11&#12290;&#25105;&#20204;&#32771;&#34385;&#36807;&#30340;&#20219;&#20309;&#19968;&#31181;&#20256;&#21442;&#26426;&#21046;&#37117;&#26080;&#27861;&#20351;&#36825;&#20010;&#31243;&#24207;&#32456;&#27490;&#12290;&#20294;
&#22312;&#25042;&#27714;&#20540;&#20013;&#65292;&#36825;&#20010;&#31243;&#24207;&#23558;&#36820;&#22238; 11&#65292;&#22240;&#20026;&#25805;&#20316;&#25968; <span class="stt">(infinite-loop 0)</span> &#27809;&#26377;&#27714;&#20540;&#12290;</p></blockquote><p>&#29616;&#22312;&#65292;&#25105;&#20204;&#20351;&#29992;&#25042;&#27714;&#20540;&#20462;&#25913;&#25105;&#20204;&#30340;&#35821;&#35328;&#12290;&#22312;&#25042;&#27714;&#20540;&#20013;&#65292;&#22914;&#26080;&#24517;&#35201;&#65292;&#25105;&#20204;&#19981;&#27714;&#25805;&#20316;&#25968;&#34920;&#36798;&#24335;&#30340;
&#20540;&#12290;&#22240;&#27492;&#65292;&#25105;&#20204;&#23558;&#36807;&#31243;&#30340;&#32465;&#23450;&#21464;&#37327;&#19982;&#26410;&#27714;&#20540;&#30340;&#25805;&#20316;&#25968;&#20851;&#32852;&#36215;&#26469;&#12290;&#24403;&#36807;&#31243;&#20027;&#20307;&#38656;&#35201;&#32465;&#23450;&#21464;&#37327;&#30340;
&#20540;&#26102;&#65292;&#25105;&#20204;&#20808;&#27714;&#23545;&#24212;&#25805;&#20316;&#25968;&#30340;&#20540;&#12290;&#26377;&#26102;&#65292;&#25105;&#20204;&#25226;&#19981;&#27714;&#25805;&#20316;&#25968;&#30340;&#20540;&#32780;&#20256;&#32473;&#36807;&#31243;
&#21483;&#20570;<span class="emph">&#20923;&#32467;</span> (<span class="emph">frozen</span>)&#65292;&#25226;&#36807;&#31243;&#27714;&#25805;&#20316;&#25968;&#30340;&#20540;&#21483;&#20570;<span class="emph">&#35299;&#20923;</span> (<span class="emph">thawed</span>)&#12290;
<a name="(idx._(gentag._710))"></a>
<a name="(idx._(gentag._711))"></a></p><p><a name="(idx._(gentag._712))"></a>
&#24403;&#28982;&#65292;&#25105;&#20204;&#36824;&#35201;&#21152;&#20837;&#36807;&#31243;&#27714;&#20540;&#26102;&#30340;&#29615;&#22659;&#12290;&#35201;&#36825;&#26679;&#65292;&#25105;&#20204;&#24341;&#20837;&#19968;&#31181;&#26032;&#30340;&#25968;&#25454;&#31867;&#22411;&#65292;
<span class="emph">&#20540;&#31665;</span> (<span class="emph">thunk</span>)&#12290;&#20540;&#31665;&#21253;&#21547;&#19968;&#20010;&#34920;&#36798;&#24335;&#12289;&#19968;&#20010;&#29615;&#22659;&#12290;</p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-datatype</span><span class="hspace">&nbsp;</span><span class="RktSym">thunk</span><span class="hspace">&nbsp;</span><span class="RktSym">thunk?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-thunk</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">expression?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">environment?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#24403;&#36807;&#31243;&#38656;&#35201;&#20351;&#29992;&#32465;&#23450;&#21464;&#37327;&#30340;&#20540;&#26102;&#65292;&#20250;&#27714;&#30456;&#24212;&#20540;&#31665;&#30340;&#20540;&#12290;</p></blockquote><p>&#25105;&#20204;&#38754;&#23545;&#30340;&#24773;&#20917;&#31245;&#31245;&#22797;&#26434;&#19968;&#20123;&#65292;&#22240;&#20026;&#25105;&#20204;&#38656;&#35201;&#21516;&#26102;&#23481;&#32435;&#25042;&#27714;&#20540;&#12289;&#35745;&#31639;&#25928;&#26524;&#21644;&#21363;&#26102;&#27714;&#20540;
&#65288;<span class="stt">let</span> &#38656;&#35201;&#65289;&#12290;&#22240;&#27492;&#65292;&#25105;&#20204;&#25226;&#25351;&#20195;&#20540;&#23450;&#20026;&#20869;&#23384;&#20301;&#32622;&#30340;&#24341;&#29992;&#65292;&#20301;&#32622;&#21253;&#21547;&#34920;&#36798;&#20540;&#25110;&#32773;&#20540;&#31665;&#12290;</p><p><span class="Iidentity">\begin{align*}\mathit{DenVal} &amp;= \mathit{Ref(ExpVal + Thunk)} \\
\mathit{ExpVal} &amp;= \mathit{Int} + \mathit{Bool} + \mathit{Proc}\end{align*}</span></p><p>&#25105;&#20204;&#30340;&#20301;&#32622;&#20998;&#37197;&#31574;&#30053;&#19982;&#25353;&#25351;&#35843;&#29992;&#31867;&#20284;&#65306;&#22914;&#26524;&#25805;&#20316;&#25968;&#26159;&#21464;&#37327;&#65292;&#37027;&#20040;&#25105;&#20204;&#20256;&#36882;&#25351;&#20195;&#30340;&#24341;&#29992;&#65307;&#21542;&#21017;&#65292;
&#25105;&#20204;&#32473;&#26410;&#27714;&#20540;&#30340;&#21442;&#25968;&#22312;&#26032;&#20301;&#32622;&#25918;&#19968;&#20010;&#20540;&#31665;&#65292;&#20256;&#36882;&#35813;&#20301;&#32622;&#30340;&#24341;&#29992;&#12290;</p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of-operand</span></span> : <span class="texMathInline">\mathit{Exp} \times \mathit{Env} \to \mathit{Ref}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-operand</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">expression</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="hspace">&nbsp;</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">newref</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-thunk</span><span class="hspace">&nbsp;</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktSym">env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote><p>&#27714; <span class="stt">var-exp</span> &#30340;&#20540;&#26102;&#65292;&#25105;&#20204;&#39318;&#20808;&#25214;&#21040;&#21464;&#37327;&#32465;&#23450;&#30340;&#20301;&#32622;&#12290;&#22914;&#26524;&#35813;&#20301;&#32622;&#26159;&#19968;&#20010;&#34920;&#36798;&#20540;&#65292;&#37027;&#20040;
&#36820;&#22238;&#36825;&#20010;&#20540;&#65292;&#20316;&#20026; <span class="stt">var-exp</span> &#30340;&#20540;&#12290;&#22914;&#26524;&#23427;&#21253;&#21547;&#19968;&#20010;&#20540;&#31665;&#65292;&#37027;&#20040;&#25105;&#20204;&#27714;&#21462;&#24182;&#36820;&#22238;&#20540;&#31665;&#30340;
&#20540;&#12290;&#36825;&#21483;&#20570;<span class="emph">&#25353;&#21517;&#35843;&#29992;</span> (<span class="emph">call by name</span>)&#12290;
<a name="(idx._(gentag._713))"></a>
<a name="(idx._(gentag._714))"></a></p><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">ref1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">w</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ref1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">if</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval?</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of-thunk</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#36807;&#31243; <span class="stt">value-of-thunk</span> &#23450;&#20041;&#22914;&#19979;&#65306;</p><blockquote class="EoplCodeInset"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span style="font-weight: bold"><span class="stt">value-of-thunk</span></span> : <span class="texMathInline">\mathit{Thunk} \to \mathit{ExpVal}</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">value-of-thunk</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">th</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktSym">thunk</span><span class="hspace">&nbsp;</span><span class="RktSym">th</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a-thunk</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">value-of</span><span class="hspace">&nbsp;</span><span class="RktSym">exp1</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-env</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._715))"></a></div></p></blockquote><p>&#25110;&#32773;&#65292;&#19968;&#26086;&#21457;&#29616;&#20540;&#31665;&#30340;&#20540;&#65292;&#25105;&#20204;&#21487;&#20197;&#25226;&#34920;&#36798;&#20540;&#25918;&#21040;&#21516;&#19968;&#20010;&#20301;&#32622;&#65292;&#36825;&#26679;&#23601;&#19981;&#38656;&#35201;&#20877;&#27425;&#27714;&#20540;&#31665;&#30340;
&#20540;&#12290;&#36825;&#31181;&#26041;&#24335;&#21483;&#20570;<span class="emph">&#25353;&#38656;&#35843;&#29992;</span> (<span class="emph">call by need</span>)&#12290;
<a name="(idx._(gentag._716))"></a>
<a name="(idx._(gentag._717))"></a></p><blockquote class="SubFlow"><blockquote class="EoplCodeInset"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">var-exp</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">ref1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">apply-env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">env</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">var</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">w</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">deref</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ref1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">if</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">expval?</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">w</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">w</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">let</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">val1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">value-of-thunk</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">w</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">begin</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">setref!</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ref1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">val1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote><p>&#36825;&#37324;&#29992;&#21040;&#20102;&#21517;&#20026;<span class="emph">&#21161;&#35760;&#27861;</span> (<span class="emph">memoization</span>) &#30340;&#36890;&#29992;&#31574;&#30053;&#12290;
<a name="(idx._(gentag._718))"></a>
<a name="(idx._(gentag._719))"></a></p></blockquote><p>&#21508;&#31181;&#24418;&#24335;&#30340;&#25042;&#27714;&#20540;&#24341;&#20154;&#20043;&#22788;&#22312;&#20110;&#65292;&#21363;&#20351;&#27809;&#26377;&#25928;&#26524;&#65292;&#36890;&#36807;&#23427;&#20063;&#33021;&#20197;&#30456;&#24403;&#31616;&#21333;&#30340;&#26041;&#24335;&#24605;&#32771;&#31243;&#24207;&#12290;
&#25226;&#36807;&#31243;&#35843;&#29992;&#26367;&#25442;&#20026;&#36807;&#31243;&#30340;&#20027;&#20307;&#65292;&#25226;&#36807;&#31243;&#20027;&#20307;&#20869;&#23545;&#27599;&#20010;&#24418;&#21442;&#30340;&#24341;&#29992;&#26367;&#25442;&#20026;&#23545;&#24212;&#30340;&#25805;&#20316;&#25968;&#65292;&#23601;&#33021;
&#24314;&#27169;&#36807;&#31243;&#35843;&#29992;&#12290;&#36825;&#31181;&#27714;&#20540;&#31574;&#30053;&#26159; lambda &#28436;&#31639;&#30340;&#22522;&#30784;&#65292;&#22312; lambda &#28436;&#31639;&#20013;&#65292;&#23427;&#21483;&#20570;
<span class="emph"><span class="texMathInline">\beta</span>-&#25512;&#23548;</span> (<span class="emph"><span class="texMathInline">\beta</span>-reduction</span>)&#12290;
<a name="(idx._(gentag._720))"></a>
<a name="(idx._(gentag._721))"></a></p><p>&#19981;&#24184;&#30340;&#26159;&#65292;&#25353;&#21517;&#35843;&#29992;&#21644;&#25353;&#38656;&#35843;&#29992;&#20351;&#27714;&#20540;&#39034;&#24207;&#38590;&#20197;&#30830;&#23450;&#65292;&#32780;&#36825;&#23545;&#29702;&#35299;&#26377;&#25928;&#26524;&#30340;&#31243;&#24207;&#33267;&#20851;&#37325;&#35201;&#12290;
&#20294;&#27809;&#26377;&#25928;&#26524;&#26102;&#65292;&#36825;&#19981;&#25104;&#38382;&#39064;&#12290;&#25152;&#20197;&#25042;&#27714;&#20540;&#30427;&#34892;&#20110;&#20989;&#25968;&#24335;&#32534;&#31243;&#35821;&#35328;&#65288;&#27809;&#26377;&#35745;&#31639;&#25928;&#26524;&#30340;&#37027;&#20123;&#65289;&#65292;
&#22312;&#21035;&#22788;&#21364;&#26483;&#26080;&#36394;&#24433;&#12290;
<a name="(idx._(gentag._722))"></a>
<a name="(idx._(gentag._723))"></a>
<a name="(idx._(gentag._724))"></a>
<a name="(idx._(gentag._725))"></a></p><blockquote class="EoplExercise"><p><a name="(elem._ex4..38)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#19979;&#38754;&#30340;&#20363;&#23376;&#23637;&#31034;&#20102;<span class="EoplExerciseRef"></span> &#22312;&#25353;&#38656;&#35843;&#29992;&#20013;&#30340;&#21464;&#20307;&#12290;<span class="EoplExerciseRef"></span>
&#20013;&#30340;&#21407;&#22987;&#31243;&#24207;&#22312;&#25353;&#38656;&#35843;&#29992;&#20013;&#21487;&#34892;&#21527;&#65311;&#22914;&#26524;&#19979;&#38754;&#30340;&#31243;&#24207;&#22312;&#25353;&#20540;&#35843;&#29992;&#20013;&#36816;&#34892;&#21602;&#65311;&#20026;&#20160;&#20040;&#65311;</p><blockquote class="EoplCodeInset"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">let makerec = proc (f)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">let d = proc (x) (f (x x))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (f (d d))</span></p></td></tr><tr><td><p><span class="stt">in let maketimes4 = proc (f)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">proc (x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">if zero?(x)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">then 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">else -((f -(x,1)), -4)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">in let times4 = (makerec maketimes4)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in (times4 3)</span></p></td></tr></table></blockquote></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..39)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#27809;&#26377;&#35745;&#31639;&#25928;&#26524;&#30340;&#35805;&#65292;&#25353;&#21517;&#35843;&#29992;&#21644;&#25353;&#38656;&#35843;&#29992;&#24635;&#26159;&#32473;&#20986;&#21516;&#26679;&#30340;&#31572;&#26696;&#12290;&#35774;&#35745;&#19968;&#20010;&#20363;&#23376;&#65292;&#35753;&#25353;&#21517;&#35843;&#29992;
&#21644;&#25353;&#38656;&#35843;&#29992;&#32473;&#20986;&#19981;&#21516;&#30340;&#31572;&#26696;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..40)"></a><span class="texMathInline">\textnormal{[}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20462;&#25913; <span class="stt">value-of-operand</span>&#65292;&#36991;&#20813;&#20026;&#24120;&#37327;&#21644;&#36807;&#31243;&#29983;&#25104;&#20540;&#31665;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..41)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#20889;&#20986;&#25353;&#21517;&#35843;&#29992;&#21644;&#25353;&#38656;&#35843;&#29992;&#30340;&#25512;&#29702;&#35268;&#21017;&#35268;&#33539;&#12290;</p></blockquote><blockquote class="EoplExercise"><p><a name="(elem._ex4..42)"></a><span class="texMathInline">\textnormal{[}{\star}{\star}\textnormal{]}</span><span class="hspace">&nbsp;</span>&#32473;&#25353;&#38656;&#35843;&#29992;&#35299;&#37322;&#22120;&#28155;&#21152;&#25042;&#27714;&#20540;&#30340; <span class="stt">let</span>&#12290;</p></blockquote><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="expr.html" title="backward to &quot;3 表达式&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;编程语言要素&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="cpi.html" title="forward to &quot;5 传递续文的解释器&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>